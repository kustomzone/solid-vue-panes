{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./src/mixins/ParleMixin.js","webpack:///./node_modules/core-js/modules/es.array.last-index-of.js","webpack:///./src/components/parle/ParleList.vue?6551","webpack:///src/components/parle/ParleList.vue","webpack:///./src/components/parle/ParleList.vue?ff1d","webpack:///./src/components/parle/ParleList.vue","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/core-js/internals/array-last-index-of.js"],"names":["$","$filter","filter","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","target","proto","forced","callbackfn","this","arguments","length","undefined","created","fc","SolidFileClient","auth","methods","prepareToday","now","Date","$store","commit","filename","getFullYear","getMonth","slice","getDate","join","fileUrl","state","parle","root","console","log","create","itemExists","postFile","then","content","catch","err","error","bascule","p","path","substr","lastIndexOf","websocket","socket","makeToast","getMessages","uri","messages","send","fetchDocument","chatDoc","subjects","findSubjects","onlyUnique","triples","forEach","s","getString","dct","getLiteral","sioc","maker","getNodeRef","foaf","parts","getAllNodeRefs","schema","hasPart","parent","isPartOf","t","id","asRef","toLocaleTimeString","push","reverse","value","index","self","indexOf","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","max","model","callback","$$v","date","expression","on","sort","_v","_l","m","key","_s","split","$event","_e","webId","new_sub","file","staticRenderFns","name","props","msg","String","mixins","ParleMixin","data","part","createWebSocket","addSubscription","formatDate","d","$bvToast","toast","title","variant","solid","watch","url","fileName","computed","f","get","set","component","$indexOf","arrayMethodIsStrict","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","ACCESSORS","1","searchElement","apply","toIndexedObject","toInteger","toLength","min","Math","nativeLastIndexOf","FORCED","module","exports","O"],"mappings":"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","file":"js/chunk-32bff29d.c4ae23d7.js","sourcesContent":["'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","\nimport auth from 'solid-auth-client';\nimport { fetchDocument } from 'tripledoc';\nimport { sioc, dct, foaf, schema } from 'rdf-namespaces'\n\nexport default {\n  created(){\n    this.fc = new SolidFileClient(auth)\n  },\n  methods: {\n\n    async prepareToday(){\n    //  let root = this.$store.state.chat.root\n      let now = new Date()\n      this.$store.commit('parle/setDataDate', now)\n      let filename = [now.getFullYear(), (\"0\" + (now.getMonth() + 1)).slice(-2), (\"0\" + now.getDate()).slice(-2)].join(\"-\")+\".ttl\"\n      let fileUrl = this.$store.state.parle.root+filename\n      console.log(fileUrl)\n      await  this.create(fileUrl)\n      this.$store.commit('parle/setFileUrl', fileUrl)\n\n    },\n    async create(fileUrl){\n      if( !await this.fc.itemExists( fileUrl )) {\n        await this.fc.postFile(fileUrl, \"\", \"text/turtle\")\n        .then((content) => {\n          console.log(\"File Created\",content)\n        })\n        .catch(err => console.error(`Error: ${err}`))\n      }else{\n        console.log(\"File exist\",fileUrl)\n      }\n    },\n    bascule(p){\n      console.log(\"BASCULE\",p)\n      this.$store.commit('parle/setFileUrl', p)\n      this.path = p.substr(0, p.lastIndexOf(\"/\") + 1)\n      console.log(this.path)\n      if (this.$store.state.websocket.socket != undefined){\n        console.log(\"subscribe\")\n      //  this.$store.state.websocket.socket.send('sub '+p);\n      }\n      console.log(\"mt\")\n      this.makeToast('We have switched to',p,'info')\n          console.log(\"mt 2\")\n      this.getMessages(p)\n          console.log(\"getmess\")\n    },\n    async getMessages(uri){\n      console.log(\"URI\",uri)\n      let messages = []\n      if( !await this.fc.itemExists( uri )) {\n        await this.fc.postFile(uri, \"\", \"text/turtle\")\n        .then((content) => {\n          console.log(\"File Created\",content)\n        })\n        .catch(err => console.error(`Error: ${err}`))\n      }else{\n        console.log(\"File exist\",uri)\n      }\n      if (this.$store.state.websocket.socket != undefined){\n        this.$store.state.websocket.socket.send('sub '+uri);\n      }\n      const chatDoc = await fetchDocument(uri);\n      //  console.log(chatDoc)\n      /*  let triples = chatDoc.getTriples()\n      console.log(triples)\n      //  this.messages = {}\n      triples.forEach((t, i) => {\n      !Object.prototype.hasOwnProperty.call(this.messages, t.subject.id) ? this.messages[t.subject.id] = {} : \"\";\n      this.messages[t.subject.id][t.predicate.id] = t.object.id\n\n    });\n    console.log(this.messages)*/\n    let  subjects = chatDoc.findSubjects();\n    subjects = subjects.filter( this.onlyUnique )\n    //    console.log(subjects)\n    let triples = []\n    subjects.forEach((s) => {\n      //  console.log(s)\n      //  let t = s.getTriples()\n      let created = s.getString(dct.created)\n      let content = s.getLiteral(sioc.content)\n      let maker = s.getNodeRef(foaf.maker)\n      let parts = s.getAllNodeRefs(schema.hasPart)\n      let parent = s.getNodeRef(schema.isPartOf)\n      let t={id:s.asRef(),\n        created: new Date(created).toLocaleTimeString(),\n        content: content,\n        maker: maker,\n        parts: parts,\n        parent: parent\n      }\n      //  console.log(t)\n      triples.push(t)\n\n    });\n    //  console.log(triples)\n    messages = triples.reverse()\n    console.log(\"Messages\",messages)\n    this.$store.commit('parle/setMessages',messages)\n  },\n  onlyUnique(value, index, self) {\n    return self.indexOf(value) === index;\n  }\n}\n}\n","var $ = require('../internals/export');\nvar lastIndexOf = require('../internals/array-last-index-of');\n\n// `Array.prototype.lastIndexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.lastindexof\n$({ target: 'Array', proto: true, forced: lastIndexOf !== [].lastIndexOf }, {\n  lastIndexOf: lastIndexOf\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"solid-chat-list\"},[_c('b-input-group',{staticClass:\"mb-2\"},[_c('b-form-datepicker',{attrs:{\"id\":\"example-datepicker\",\"min\":\"2020-08-01\",\"max\":_vm.max},model:{value:(_vm.date),callback:function ($$v) {_vm.date=$$v},expression:\"date\"}}),_c('b-input-group-append',[_c('b-button',{on:{\"click\":_vm.sort}},[_vm._v(\"Sort\")])],1)],1),_c('b-list-group',_vm._l((_vm.messages),function(m){return _c('b-list-group-item',{key:m.id,staticClass:\"flex-column align-items-start\"},[_c('div',{staticClass:\"d-flex w-100 justify-content-between\"},[_c('div',{staticClass:\"mb-1\"},[(m.maker != null)?_c('a',{attrs:{\"href\":m.maker,\"target\":\"_blank\"}},[_c('b-icon',{attrs:{\"icon\":\"person-fill\"}}),_vm._v(_vm._s(m.maker.split('/').slice(2,3)[0])+\" \")],1):_c('b-icon',{attrs:{\"icon\":\"person-fill\"}})],1),_c('small',{staticClass:\"text-muted\"},[_vm._v(\" \"+_vm._s(m.created)+\" \")])]),_c('p',{staticClass:\"mb-1\"},[_vm._v(\" \"+_vm._s(m.content)+\" \")]),_c('div',{staticClass:\"text-muted\"},[(m.parent)?_c('div',[_vm._v(\" This \"),_c('a',{attrs:{\"href\":m.id.split('#')[0],\"target\":\"_blank\"}},[_vm._v(_vm._s(m.id.split(\"/\").slice(-2,-1)[0]))]),_vm._v(\" channel as been created from \"),_c('b-button',{staticClass:\"m-1 btn-sm\",attrs:{\"pill\":true,\"variant\":\"outline-info\"},on:{\"click\":function($event){return _vm.bascule(m.parent)}}},[_vm._v(\" \"+_vm._s(m.parent.split(\"/\").slice(-2,-1)[0])+\" \")])],1):_vm._e(),(_vm.webId!=null)?_c('b-button',{staticClass:\"btn-sm\",attrs:{\"pill\":true,\"variant\":\"outline-info\"},on:{\"click\":function($event){return _vm.new_sub(m.id)}}},[_vm._v(\"Reply\")]):_c('span',[_vm._v(\"Login to reply\")]),_vm._l((m.parts),function(p){return _c('b-button',{key:p,staticClass:\"m-1 btn-sm\",attrs:{\"pill\":true,\"variant\":\"info\"},on:{\"click\":function($event){return _vm.bascule(p)}}},[_vm._v(\" \"+_vm._s(p.split(\"/\").slice(-2,-1)[0])+\" \")])})],2)])}),1),_c('div',[(_vm.messages.length > 5)?_c('b-input-group',{staticClass:\"mb-2\"},[_c('b-form-datepicker',{attrs:{\"id\":\"example-datepicker2\",\"min\":\"2020-08-01\",\"max\":_vm.max},model:{value:(_vm.date),callback:function ($$v) {_vm.date=$$v},expression:\"date\"}}),_c('b-input-group-append',[_c('b-button',{on:{\"click\":_vm.sort}},[_vm._v(\"Sort\")])],1)],1):_vm._e()],1),_c('br'),_c('br'),_c('div',{staticClass:\"m-3\"},[_c('a',{attrs:{\"href\":'https://scenaristeur.github.io/spoggy-simple/?source='+_vm.file,\"target\":\"_blank\"}},[_vm._v(\"Visualization\")])]),_c('br'),_c('br'),_c('br')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"solid-chat-list\">\n\n    <b-input-group class=\"mb-2\">\n      <b-form-datepicker id=\"example-datepicker\" v-model=\"date\" min=\"2020-08-01\" :max=\"max\"></b-form-datepicker>\n      <b-input-group-append>\n        <b-button @click=\"sort\">Sort</b-button>\n      </b-input-group-append>\n    </b-input-group>\n\n    <b-list-group>\n      <b-list-group-item   v-for=\"m in messages\" :key=\"m.id\" class=\"flex-column align-items-start\">\n        <div class=\"d-flex w-100 justify-content-between\">\n          <div class=\"mb-1\">\n            <a v-bind:href=\"m.maker\" v-if=\"m.maker != null\" target=\"_blank\">\n              <b-icon icon=\"person-fill\"></b-icon>{{ m.maker.split('/').slice(2,3)[0] }}\n            </a>\n\n            <b-icon v-else  icon=\"person-fill\"></b-icon>\n\n          </div>\n          <small class=\"text-muted\">\n            {{ m.created }}\n          </small>\n        </div>\n\n        <p class=\"mb-1\">\n          {{ m.content}}\n        </p>\n\n        <div class=\"text-muted\">\n          <div v-if=\"m.parent\">\n            This <a v-bind:href=\"m.id.split('#')[0]\" target=\"_blank\">{{ m.id.split(\"/\").slice(-2,-1)[0] }}</a> channel as been created from\n            <b-button :pill=true variant=\"outline-info\" class=\"m-1 btn-sm\" @click=\"bascule(m.parent)\">\n              {{ m.parent.split(\"/\").slice(-2,-1)[0] }}\n            </b-button>\n          </div>\n\n          <b-button  :pill=true v-if=\"webId!=null\" variant=\"outline-info\" class=\"btn-sm\" @click=\"new_sub(m.id)\" >Reply</b-button>\n          <span v-else>Login to reply</span>\n          <b-button :pill=true  v-for=\"p in m.parts\" :key=\"p\" variant=\"info\" class=\"m-1 btn-sm\" @click=\"bascule(p)\">\n            {{ p.split(\"/\").slice(-2,-1)[0] }}\n          </b-button>\n        </div>\n      </b-list-group-item>\n\n    </b-list-group>\n\n    <div>\n      <b-input-group v-if=\"messages.length > 5\" class=\"mb-2\">\n        <b-form-datepicker id=\"example-datepicker2\" v-model=\"date\" min=\"2020-08-01\" :max=\"max\"></b-form-datepicker>\n        <b-input-group-append>\n          <b-button @click=\"sort\">Sort</b-button>\n        </b-input-group-append>\n      </b-input-group>\n    </div>\n    <br>\n    <br>\n\n\n    <!--<b-button @click=\"makeToast()\" class=\"mb-2\">Default</b-button>\n    <b-button variant=\"primary\" @click=\"makeToast('primary')\" class=\"mb-2\">Primary</b-button>\n    <b-button variant=\"secondary\" @click=\"makeToast('secondary')\" class=\"mb-2\">Secondary</b-button>\n    <b-button variant=\"danger\" @click=\"makeToast('danger')\" class=\"mb-2\">Danger</b-button>\n    <b-button variant=\"warning\" @click=\"makeToast('warning')\" class=\"mb-2\">Warning</b-button>\n    <b-button variant=\"success\" @click=\"makeToast('success')\" class=\"mb-2\">Success</b-button>\n    <b-button variant=\"info\" @click=\"makeToast('info')\" class=\"mb-2\">Info</b-button>-->\n\n\n    <div class=\"m-3\"><a v-bind:href=\"'https://scenaristeur.github.io/spoggy-simple/?source='+file\" target=\"_blank\">Visualization</a></div>\n    <br>\n    <br>\n    <br>\n  </div>\n</template>\n\n<script>\nimport ParleMixin from '@/mixins/ParleMixin' // Manage folders & files\nimport { fetchDocument, createDocument } from 'tripledoc';\n//import auth from 'solid-auth-client';\nimport {/* sioc,*/ dct, foaf, schema } from 'rdf-namespaces'\n\nexport default {\n  name: 'ParleList',\n  props: {\n    msg: String\n  },\n  mixins: [ParleMixin ],\n  data: function () {\n    return {\n      date: \"\",\n      part:\"\"\n    }\n  },\n  async   created(){\n    let d = new Date()\n    this.date = this.formatDate(d)\n    this.max = this.date\n    this.path = this.$store.state.parle.root\n    console.log(\"ROOT FROM STORE\", this.$store.state.parle.root)\n    await this.createWebSocket()\n    this.url = this.$store.state.parle.url\n\n    if (this.url != undefined && this.url.length > 0){\n      let fileName = this.url.substring(this.url.lastIndexOf('/') + 1);\n      console.log(fileName)\n      this.bascule(this.path+fileName)\n        this.$store.commit('parle/setFileUrl', this.path+fileName)\n    }\n\n\n  },\n  async  mounted(){\n\n\n    let socket = this.$store.state.websocket.socket\n    console.log(\"SOCKET FROM STORE\", socket)\n    socket.onmessage = function(msg) {\n      if (msg.data && msg.data.slice(0, 3) === 'pub') {\n        // resource updated, refetch resource\n        console.log(\"updated\",msg.data)\n        //  this.history.push({type: \"update\", url: msg.data})\n        //  this.$store.dispatch('chat/requestUpdate',msg.data.substring(4))\n        this.getMessages(msg.data.substring(4))\n      }\n    }.bind(this)\n  },\n  methods: {\n    createWebSocket(){\n      let root = this.$store.state.parle.root\n      let withoutProtocol = root.split('//')[1]\n      let sock = withoutProtocol.split('/')[0]+\"/\"\n      let socket = new WebSocket('wss://'+sock, ['solid.0.1.0']);\n      this.$store.commit('websocket/setSocket', socket)\n    },\n    addSubscription(fileUrl){\n      this.$store.state.websocket.socket.send('sub '+fileUrl);\n    },\n\n    sort(){\n      this.messages.reverse()\n    },\n    formatDate(d) {\n      return [d.getFullYear(), (\"0\" + (d.getMonth() + 1)).slice(-2), (\"0\" + d.getDate()).slice(-2)].join(\"-\")\n    },\n    async new_sub(parent){\n      // must be cleaned !\n      console.log(parent)\n      var sub_channel = prompt(\"Create a sub-channel from \"+parent);\n      if (sub_channel != null && sub_channel.length > 0 ){\n        //create Path\n        console.log(sub_channel)\n        sub_channel = sub_channel.split(' ').join('_');\n        let parent_path = parent.substr(0, parent.lastIndexOf(\"/\") + 1)\n        let parent_messageId = parent.split(\"#\").pop()\n        console.log(\"Parent\",parent_path,parent_messageId)\n        //  this.$store.commit('parle/setRoot', path+sub_channel)\n        let child_path = parent_path+sub_channel+\"/\"\n        let child_filename = this.date+\".ttl\"\n        let child_url = child_path+child_filename\n        console.log(\"Child\",child_path, child_filename)\n        this.$store.commit('parle/setFileUrl', child_url)\n\n        // create Doc\n\n        if( !await this.fc.itemExists( child_url )) {\n          await this.fc.postFile(child_url, \"\", \"text/turtle\")\n          .then((content) => {\n            console.log(\"File Created\",content)\n          })\n          .catch(err => console.error(`Error: ${err}`))\n        }else{\n          console.log(\"File exist\",child_url)\n        }\n\n\n        let newDoc = {}\n        try{\n          newDoc = await fetchDocument(child_url);\n        } catch(e){\n          newDoc = await createDocument(child_url);\n        }\n\n        //  console.log(newDoc)\n        newDoc.addSubject\n        let subj =   newDoc.addSubject({identifier: \"this\" })\n        //  subj.addLiteral(sioc.content, this.message)\n        subj.addLiteral(dct.created, this.date)\n        subj.addNodeRef(schema.isPartOf, parent)\n        subj.addNodeRef(foaf.maker, this.$store.state.solid.webId)\n        await newDoc.save();\n        //  console.log(path, messageId)\n\n        //\n        let referDoc = {}\n        try{\n          referDoc = await fetchDocument(parent);\n        } catch(e){\n          referDoc = await createDocument(parent);\n        }\n        let p_id = referDoc.getSubject(parent)\n        p_id.addRef(schema.hasPart, child_url)\n        await referDoc.save();\n\n        this.bascule(child_url)\n\n\n        if (this.$store.state.websocket.socket != undefined){\n          this.$store.state.websocket.socket.send('sub '+child_url);\n        }\n\n        //\n      }else{\n        alert (\"You must provide a name to create a sub Channel\")\n      }\n    },\n    makeToast(title, content, variant = null) {\n      this.$bvToast.toast(content , {\n        title: title,\n        variant: variant,\n        solid: true\n      })\n    }\n  },\n  watch:{\n    url(u){\n      console.log(\"url changed\",u)\n      let fileName = u.substring(u.lastIndexOf('/') + 1);\n      console.log(fileName)\n        this.$store.commit('parle/setFileUrl', this.path+fileName)\n      this.bascule(this.path+fileName)\n    }\n  },\n  computed: {\n    file(){\n      let f = this.path+this.date+\".ttl\"\n      this.$store.commit('parle/setFileUrl', f)\n      if (this.$store.state.websocket.socket != undefined  && this.$store.state.websocket.socket.readyState == 1){\n        this.$store.state.websocket.socket.send('sub '+f);\n      }\n\n      this.getMessages(f)\n      return f\n    },\n    webId(){\n      return this.$store.state.solid.webId\n    },\n    messages(){\n      return this.$store.state.parle.messages\n    },\n    url: {\n      get: function() { return this.$store.state.parle.url},\n      set: function() {}\n    },\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleList.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleList.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParleList.vue?vue&type=template&id=3bac3967&\"\nimport script from \"./ParleList.vue?vue&type=script&lang=js&\"\nexport * from \"./ParleList.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar min = Math.min;\nvar nativeLastIndexOf = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!nativeLastIndexOf && 1 / [1].lastIndexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('lastIndexOf');\n// For preventing possible almost infinite loop in non-standard implementations, test the forward version of the method\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\nvar FORCED = NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH;\n\n// `Array.prototype.lastIndexOf` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.lastindexof\nmodule.exports = FORCED ? function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n  // convert -0 to +0\n  if (NEGATIVE_ZERO) return nativeLastIndexOf.apply(this, arguments) || 0;\n  var O = toIndexedObject(this);\n  var length = toLength(O.length);\n  var index = length - 1;\n  if (arguments.length > 1) index = min(index, toInteger(arguments[1]));\n  if (index < 0) index = length + index;\n  for (;index >= 0; index--) if (index in O && O[index] === searchElement) return index || 0;\n  return -1;\n} : nativeLastIndexOf;\n"],"sourceRoot":""}