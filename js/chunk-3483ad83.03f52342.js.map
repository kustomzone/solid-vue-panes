{"version":3,"sources":["webpack:///./src/components/parle/ParleSend.vue?1f0d","webpack:///./node_modules/core-js/modules/es.array.last-index-of.js","webpack:///./node_modules/core-js/internals/array-last-index-of.js","webpack:///./src/components/parle/ParleSend.vue?a84b","webpack:///src/components/parle/ParleSend.vue","webpack:///./src/components/parle/ParleSend.vue?8637","webpack:///./src/components/parle/ParleSend.vue?438e"],"names":["$","lastIndexOf","target","proto","forced","toIndexedObject","toInteger","toLength","arrayMethodIsStrict","arrayMethodUsesToLength","min","Math","nativeLastIndexOf","NEGATIVE_ZERO","STRICT_METHOD","USES_TO_LENGTH","ACCESSORS","1","FORCED","module","exports","searchElement","apply","this","arguments","O","length","index","render","_vm","_h","$createElement","_c","_self","staticClass","webId","on","$event","type","indexOf","_k","keyCode","key","send","model","value","callback","$$v","message","expression","attrs","_v","staticRenderFns","name","components","data","created","fileUrl","$store","state","parle","root","url","undefined","console","log","fileName","methods","watch","commit","path","bascule","computed","solid","get","set","component"],"mappings":"kHAAA,yBAA0f,EAAG,G,qBCA7f,IAAIA,EAAI,EAAQ,QACZC,EAAc,EAAQ,QAI1BD,EAAE,CAAEE,OAAQ,QAASC,OAAO,EAAMC,OAAQH,IAAgB,GAAGA,aAAe,CAC1EA,YAAaA,K,kCCLf,IAAII,EAAkB,EAAQ,QAC1BC,EAAY,EAAQ,QACpBC,EAAW,EAAQ,QACnBC,EAAsB,EAAQ,QAC9BC,EAA0B,EAAQ,QAElCC,EAAMC,KAAKD,IACXE,EAAoB,GAAGX,YACvBY,IAAkBD,GAAqB,EAAI,CAAC,GAAGX,YAAY,GAAI,GAAK,EACpEa,EAAgBN,EAAoB,eAEpCO,EAAiBN,EAAwB,UAAW,CAAEO,WAAW,EAAMC,EAAG,IAC1EC,EAASL,IAAkBC,IAAkBC,EAIjDI,EAAOC,QAAUF,EAAS,SAAqBG,GAE7C,GAAIR,EAAe,OAAOD,EAAkBU,MAAMC,KAAMC,YAAc,EACtE,IAAIC,EAAIpB,EAAgBkB,MACpBG,EAASnB,EAASkB,EAAEC,QACpBC,EAAQD,EAAS,EAGrB,IAFIF,UAAUE,OAAS,IAAGC,EAAQjB,EAAIiB,EAAOrB,EAAUkB,UAAU,MAC7DG,EAAQ,IAAGA,EAAQD,EAASC,GAC1BA,GAAS,EAAGA,IAAS,GAAIA,KAASF,GAAKA,EAAEE,KAAWN,EAAe,OAAOM,GAAS,EACzF,OAAQ,GACNf,G,yCC3BJ,IAAIgB,EAAS,WAAa,IAAIC,EAAIN,KAASO,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAAe,MAAbL,EAAIM,MAAeH,EAAG,gBAAgB,CAACE,YAAY,cAAc,CAACF,EAAG,eAAe,CAACI,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAIA,EAAOC,KAAKC,QAAQ,QAAQV,EAAIW,GAAGH,EAAOI,QAAQ,QAAQ,GAAGJ,EAAOK,IAAI,SAAkB,KAAcb,EAAIc,KAAKN,KAAUO,MAAM,CAACC,MAAOhB,EAAW,QAAEiB,SAAS,SAAUC,GAAMlB,EAAImB,QAAQD,GAAKE,WAAW,aAAajB,EAAG,uBAAuB,CAACA,EAAG,WAAW,CAACkB,MAAM,CAAC,QAAU,WAAWd,GAAG,CAAC,MAAQP,EAAIc,OAAO,CAACd,EAAIsB,GAAG,WAAW,IAAI,GAAGnB,EAAG,mBAAmB,CAACE,YAAY,gBAAgB,IAC/nBkB,EAAkB,G,oECsBtB,GACEC,KAAM,YACNC,WAAF,CACI,iBAAoB,WAAxB,yDAGEC,KAAM,WACJ,MAAO,CACLP,QAAS,KAGbQ,QAXF,WAgBI,GAJAjC,KAAKkC,QAAUlC,KAAKmC,OAAOC,MAAMC,MAAMH,QACvClC,KAAKsC,KAAOtC,KAAKmC,OAAOC,MAAMC,MAAMC,KACpCtC,KAAKuC,IAAMvC,KAAKmC,OAAOC,MAAMC,MAAME,SAEnBC,GAAZxC,KAAKuC,KAAoBvC,KAAKuC,IAAIpC,OAAS,EAAnD,CACM,IAAN,kDACMsC,QAAQC,IAAIC,GACZ3C,KAAKyB,QAAU,yBAArB,4BACMzB,KAAKoB,SAKTwB,QAAS,CACP,KADJ,WACA,2KAGA,6BAEA,yBACA,6BANA,wBAOA,uBACA,WACA,oBACA,kBAKA,qEAEA,KAjBA,mBAoBA,0BApBA,QAoBA,EApBA,6EAsBA,0BAtBA,QAsBA,EAtBA,sBA0BA,+BACA,uCACA,+BACA,6BA7BA,UA8BA,SA9BA,QAgCA,aAhCA,wBAkCA,2CAlCA,8DA0CEC,MAAF,CACIN,IADJ,SACA,GACME,QAAQC,IAAI,cAAlB,GACM,IAAN,oCACMD,QAAQC,IAAIC,GACZ3C,KAAKmC,OAAOW,OAAO,mBAAoB9C,KAAK+C,KAAlD,GACM/C,KAAKgD,QAAQhD,KAAK+C,KAAxB,KAGEE,SAAF,CACIrC,MADJ,WAEM,OAAOZ,KAAKmC,OAAOC,MAAMc,MAAMtC,OAEjC2B,IAAK,CACHY,IAAK,WAAX,oCACMC,IAAK,gBC1GuV,I,wBCQ9VC,EAAY,eACd,EACAhD,EACAwB,GACA,EACA,KACA,WACA,MAIa,aAAAwB,E","file":"js/chunk-3483ad83.03f52342.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleSend.vue?vue&type=style&index=0&id=388c4ff9&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleSend.vue?vue&type=style&index=0&id=388c4ff9&scoped=true&lang=css&\"","var $ = require('../internals/export');\nvar lastIndexOf = require('../internals/array-last-index-of');\n\n// `Array.prototype.lastIndexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.lastindexof\n$({ target: 'Array', proto: true, forced: lastIndexOf !== [].lastIndexOf }, {\n  lastIndexOf: lastIndexOf\n});\n","'use strict';\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toInteger = require('../internals/to-integer');\nvar toLength = require('../internals/to-length');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar min = Math.min;\nvar nativeLastIndexOf = [].lastIndexOf;\nvar NEGATIVE_ZERO = !!nativeLastIndexOf && 1 / [1].lastIndexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('lastIndexOf');\n// For preventing possible almost infinite loop in non-standard implementations, test the forward version of the method\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\nvar FORCED = NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH;\n\n// `Array.prototype.lastIndexOf` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.lastindexof\nmodule.exports = FORCED ? function lastIndexOf(searchElement /* , fromIndex = @[*-1] */) {\n  // convert -0 to +0\n  if (NEGATIVE_ZERO) return nativeLastIndexOf.apply(this, arguments) || 0;\n  var O = toIndexedObject(this);\n  var length = toLength(O.length);\n  var index = length - 1;\n  if (arguments.length > 1) index = min(index, toInteger(arguments[1]));\n  if (index < 0) index = length + index;\n  for (;index >= 0; index--) if (index in O && O[index] === searchElement) return index || 0;\n  return -1;\n} : nativeLastIndexOf;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"solid-chat-send\"},[(_vm.webId != null)?_c('b-input-group',{staticClass:\"mt-3 input\"},[_c('b-form-input',{on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.send($event)}},model:{value:(_vm.message),callback:function ($$v) {_vm.message=$$v},expression:\"message\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.send}},[_vm._v(\"Send\")])],1)],1):_c('SolidLoginButton',{staticClass:\"mt-3 input\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"solid-chat-send\">\r\n    <!--<h1>Room name</h1> -->\r\n\r\n\r\n    <b-input-group class=\"mt-3 input\" v-if=\"webId != null\" >\r\n      <b-form-input v-model=\"message\" v-on:keyup.enter=\"send\"></b-form-input>\r\n      <b-input-group-append>\r\n        <!--  <b-button variant=\"outline-success\">Button</b-button>-->\r\n        <b-button variant=\"warning\" @click=\"send\" >Send</b-button>\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n    <SolidLoginButton class=\"mt-3 input\" v-else />\r\n\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchDocument, createDocument } from 'tripledoc';\r\nimport {/*namedNode,*/ sioc, dct, foaf } from 'rdf-namespaces'\r\n\r\nexport default {\r\n  name: 'ParleSend',\r\n  components:{\r\n    'SolidLoginButton': () => import('@/components/solid/SolidLoginButton')\r\n  },\r\n\r\n  data: function () {\r\n    return {\r\n      message: \"\",\r\n    }\r\n  },\r\n  created(){\r\n    this.fileUrl = this.$store.state.parle.fileUrl\r\n    this.root = this.$store.state.parle.root\r\n    this.url = this.$store.state.parle.url\r\n\r\n    if (this.url != undefined && this.url.length > 0){\r\n      let fileName = this.url.substring(this.url.lastIndexOf('/') + 1);\r\n      console.log(fileName)\r\n      this.message = \"New chat started from \"+this.url+\" at \"+this.root+fileName\r\n      this.send()\r\n      //    this.$store.commit('parle/setFileUrl', this.path+fileName)\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    async send(){\r\n      // please refer to https://github.com/scenaristeur/shighl/blob/9b4b61d06d8a20f55de3f2aa580cbc5fb840d584/src/Shighl-chat.js#L214\r\n      // and https://github.com/LDflex/LDflex/issues/53\r\n      let webId= this.$store.state.solid.webId\r\n\r\n      console.log(this.fileUrl)\r\n      if (this.message.length > 0 && webId != null)    {\r\n        console.log(this.message)\r\n        var dateObj = new Date();\r\n        var messageId = \"Msg\"+dateObj.getTime()\r\n        var date = dateObj.toISOString()\r\n        //  let msgUrl = this.fileUrl+messageId\r\n        /*  console.log(msgUrl)\r\n        await solid.data[msgUrl].dct$created.add(date)\r\n        await solid.data[msgUrl].sioc$content.add(this.message)*/\r\n        console.log(\"WEBID\",this.$store.state.solid.webId, this.$store.state.count)\r\n\r\n        let chatDoc = {}\r\n\r\n        try{\r\n          chatDoc = await fetchDocument(this.fileUrl);\r\n        } catch(e){\r\n          chatDoc = await createDocument(this.fileUrl);\r\n        }\r\n\r\n        //        console.log(chatDoc)\r\n        let subj =   chatDoc.addSubject({identifier:messageId})\r\n        subj.addLiteral(sioc.content, this.message)\r\n        subj.addLiteral(dct.created, date)\r\n        subj.addNodeRef(foaf.maker, webId)\r\n        await chatDoc.save();\r\n\r\n        this.message=\"\"\r\n      }else{\r\n        alert ( \"You must login before posting ;-)\")\r\n      }\r\n      //  await solid.data[msgUrl].foaf$maker.add(namedNode('https://www.test.com')) // namedNode(`${webid}`)\r\n      //  await solid.data.from(this.url)[messageId]['http://www.w3.org/2005/01/wf/flow#message'].add(this.url)\r\n      //this.message = \"\"\r\n      //  await solid.data.from(this.url)[this.subject]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(this.url))\r\n    }\r\n  },\r\n  watch:{\r\n    url(u){\r\n      console.log(\"url changed\",u)\r\n      let fileName = u.substring(u.lastIndexOf('/') + 1);\r\n      console.log(fileName)\r\n      this.$store.commit('parle/setFileUrl', this.path+fileName)\r\n      this.bascule(this.path+fileName)\r\n    }\r\n  },\r\n  computed:{\r\n    webId(){\r\n      return this.$store.state.solid.webId\r\n    },\r\n    url: {\r\n      get: function() { return this.$store.state.parle.url},\r\n      set: function() {}\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.input {\r\n  position: fixed;\r\n  bottom:0;\r\n  z-index: 999;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleSend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ParleSend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ParleSend.vue?vue&type=template&id=388c4ff9&scoped=true&\"\nimport script from \"./ParleSend.vue?vue&type=script&lang=js&\"\nexport * from \"./ParleSend.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ParleSend.vue?vue&type=style&index=0&id=388c4ff9&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"388c4ff9\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}