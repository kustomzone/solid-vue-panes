(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["tension-edit"],{1404:function(t,e,a){"use strict";a("a15b"),a("fb6a"),a("b0c0"),a("96cf");var i=a("1da1"),n=a("4d8d"),r=a("6dc1");e["a"]={created:function(){this.webId=this.$store.state.solid.webId,console.log("ActivityMixin WEBID CREATED",this.webId),this.config(this.webId);var t=new Date;this.date=this.formatDate(t),console.log(this.as),console.log(this.date)},methods:{sendActivity:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,i,o,s,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t.activity),a=new Date,i="Activity_"+a.getTime(),o=a.toISOString(),s=t.formatDate(a),console.log(t.activity.actor.name,t.activity.type,t.activity.summary,s),c=t.pubPod+s+".ttl",l={},e.prev=8,e.next=11,Object(n["b"])(c);case 11:l=e.sent,e.next=19;break;case 14:return e.prev=14,e.t0=e["catch"](8),e.next=18,Object(n["a"])(c);case 18:l=e.sent;case 19:return console.log("webId",t.webId),t.activity.summary.length<1&&(t.activity.summary=[t.activity.actor.name,t.activity.type,"a",t.activity.object.type,"with name",t.activity.object.name].join(" ")),u=l.addSubject({identifier:i}),u.addLiteral(r["e"].label,t.activity.object.name),u.addLiteral(r["a"].created,o),u.addRef(r["b"].maker,t.webId),u.addRef("https://www.w3.org/ns/activitystreams#actor",t.webId),u.addRef(r["d"].type,"https://www.w3.org/ns/activitystreams#"+t.activity.type),u.addLiteral("https://www.w3.org/ns/activitystreams#summary",t.activity.summary),u.addRef("https://www.w3.org/ns/activitystreams#object",t.activity.object.url),e.next=31,l.save();case 31:case"end":return e.stop()}}),e,null,[[8,14]])})))()},send:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,i,o,s,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t.activity),console.log(t.activity.actor.name,t.activity.type,t.activity.summary,t.date),a=t.pubPod+t.date+".ttl",i=new Date,o="Activity_"+i.getTime(),s=i.toISOString(),c={},e.prev=7,e.next=10,Object(n["b"])(a);case 10:c=e.sent,e.next=18;break;case 13:return e.prev=13,e.t0=e["catch"](7),e.next=17,Object(n["a"])(a);case 17:c=e.sent;case 18:return console.log("webId",t.webId),l=[t.activity.actor.name,t.activity.type,"a",t.activity.object.type,"with name",t.activity.object.name].join(" "),console.log("Musr create outbox object first, then activity !",c,o,s),u=c.addSubject({identifier:o}),u.addLiteral(r["e"].label,l),u.addLiteral(r["a"].created,s),u.addRef(r["b"].maker,t.webId),u.addRef("https://www.w3.org/ns/activitystreams#actor",t.webId),u.addRef(r["d"].type,"https://www.w3.org/ns/activitystreams#"+t.activity.type),u.addLiteral("https://www.w3.org/ns/activitystreams#summary",t.activity.summary),u.addRef("https://www.w3.org/ns/activitystreams#object",t.activity.object.url),e.next=31,c.save();case 31:case"end":return e.stop()}}),e,null,[[7,13]])})))()},formatDate:function(t){return[t.getFullYear(),("0"+(t.getMonth()+1)).slice(-2),("0"+t.getDate()).slice(-2)].join("-")},postActivity:function(){},config:function(t){this.config={},this.config.webId=t,console.log("ActivityMixin config",this.config)}},webId:{webId:function(t){this.config(t)}},computed:{webId:{get:function(){return this.$store.state.solid.webId},set:function(){}},activities:{get:function(){return this.$store.state.agora.activities},set:function(){}}},data:function(){return{as:{core:["Object","Link","Activity","IntransitiveActivity","Collection","OrderedCollection","CollectionPage","OrderedCollectionPage"],activity:["Accept","Add","Announce","Arrive","Block","Create","Delete","Dislike","Flag","Follow","Ignore","Invite","Join","Leave","Like","Listen","Move","Offer","Question","Reject","Read","Remove","TentativeReject","TentativeAccept","Travel","Undo","Update","View"],actor:["Application","Group","Organization","Person","Service"],object:["Article","Audio","Document","Event","Image","Note","Page","Place","Profile","Relationship","Tombstone","Video","Mention"]},pubPod:"https://agora.solid.community/public/popock/inbox/"}}}},"18cc":function(t,e,a){"use strict";a("96cf");var i=a("1da1"),n=a("86bb"),r=(a("4160"),a("ac1f"),a("5319"),a("1276"),a("498a"),a("159b"),a("1404")),o=a("4d8d"),s=a("6dc1"),c=a("00e8"),l=a.n(c),u={mixins:[n["a"],r["a"]],data:function(){return{}},created:function(){this.fc=new SolidFileClient(l.a),console.log(this.fc)},methods:{createFile:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var i,n,r,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.label=t.label.trim(),t.ttl_name=t.label.replace(/\s/g,"_"),e.activity={actor:{name:e.$store.state.solid.webId},type:"Create",summary:"",object:{name:t.label,url:"",type:"Tension"}},a.prev=3,i={},void 0!=t.url){a.next=13;break}return t.url=t.path+t.ttl_name+".ttl",a.next=9,Object(o["a"])(t.url);case 9:i=a.sent,e.activity.type="Create",a.next=17;break;case 13:return a.next=15,Object(o["b"])(t.url);case 15:i=a.sent,e.activity.type="Update";case 17:return n=i.addSubject({identifier:"this"}),r=new Date,c=r.toISOString(),void 0!=t.created?(t.modified=c,n.addLiteral(s["a"].modified,c),n.removeAll(s["e"].label),n.removeAll(s["c"].inbox),n.removeAll("https://holacratie.solid.community/public/holacratie#whatis",t.wi),n.removeAll("https://holacratie.solid.community/public/holacratie#whatshouldbe",t.wsb),n.removeAll(s["d"].type),n.removeAll("http://www.w3.org/ns/org#memberOf"),n.removeAll("http://www.w3.org/ns/org#purpose")):(t.created=c,n.addLiteral(s["a"].created,c)),console.log(t),n.addLiteral(s["e"].label,t.label),n.addRef(s["c"].inbox,"./"+t.ttl_name+"/inbox/"),n.addLiteral("https://holacratie.solid.community/public/holacratie#whatis",t.wi),n.addLiteral("https://holacratie.solid.community/public/holacratie#whatshouldbe",t.wsb),n.addRef(s["b"].maker,e.$store.state.solid.webId),t.types.forEach((function(t){n.addRef(s["d"].type,t)})),void 0!=t.roles&&(t.roles.split(",").forEach((function(t){n.addLiteral("http://www.w3.org/ns/org#memberOf",t.trim())})),console.log("TODO: must look at existing groups & existing frineds groups & activity published groups")),void 0!=t.domains&&(t.domains.split(",").forEach((function(t){n.addLiteral("http://www.w3.org/ns/org#purpose",t.trim())})),console.log("TODO: must look at https://www.wikidata.org/w/api.php?action=wbsearchentities&language=fr&format=json&search=Ecology")),a.next=32,i.save();case 32:e.makeToast("Created "+t.label,"ok","success"),a.next=39;break;case 35:a.prev=35,a.t0=a["catch"](3),e.makeToast("Error creating "+t.label,a.t0,"danger"),console.log(a.t0);case 39:"public"==t.privacy&&(console.log("ACTIVITY !!"),e.activity.object.url=t.url,e.sendActivity(),e.makeToast("TODO : must Activity publish",t.label,"success"));case 40:case"end":return a.stop()}}),a,null,[[3,35]])})))()},getFolder:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("get folder",t),a.next=3,e.fc.readFolder(t);case 3:return i=a.sent,a.abrupt("return",i);case 5:case"end":return a.stop()}}),a)})))()}}};e["a"]={mixins:[n["a"],u],data:function(){return{tension:{privacy:"public"}}},methods:{createTension:function(){this.tension.displayType="Tension",this.tension.types=["http://purl.org/vocab/lifecycle/schema#Task","http://www.w3.org/ns/ldp#Resource"],this.tension.path=this.path,console.log(this.tension,this.path),this.createFile(this.tension),this.tension={privacy:"public"}},getTensions:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("GET TENSIONS",t.path),e.next=3,t.getFolder(t.path);case 3:return a=e.sent,console.log(a),e.abrupt("return",a.files);case 6:case"end":return e.stop()}}),e)})))()},getTensionDetail:function(t){return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["b"])(t.url);case 2:return a=e.sent,i=a.getSubject(t.url+"#this"),n=t,n.created=i.getLiteral(s["a"].created),n.label=i.getLiteral(s["e"].label),n.inbox=i.getRef(s["c"].inbox),n.wi=i.getLiteral("https://holacratie.solid.community/public/holacratie#whatis"),n.wsb=i.getLiteral("https://holacratie.solid.community/public/holacratie#whatshouldbe"),n.maker=i.getRef(s["b"].maker),n.types=i.getAllRefs(s["d"].type),n.roles=i.getAllLiterals("http://www.w3.org/ns/org#memberOf"),n.domains=i.getAllLiterals("http://www.w3.org/ns/org#purpose"),e.abrupt("return",n);case 15:case"end":return e.stop()}}),e)})))()}}}},5319:function(t,e,a){"use strict";var i=a("d784"),n=a("825a"),r=a("7b0b"),o=a("50c4"),s=a("a691"),c=a("1d80"),l=a("8aa5"),u=a("14c3"),d=Math.max,b=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g,v=function(t){return void 0===t?t:String(t)};i("replace",2,(function(t,e,a,i){var f=i.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,w=i.REPLACE_KEEPS_$0,g=f?"$":"$0";return[function(a,i){var n=c(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,n,i):e.call(String(n),a,i)},function(t,i){if(!f&&w||"string"===typeof i&&-1===i.indexOf(g)){var r=a(e,t,this,i);if(r.done)return r.value}var c=n(t),p=String(this),h="function"===typeof i;h||(i=String(i));var m=c.global;if(m){var x=c.unicode;c.lastIndex=0}var k=[];while(1){var j=u(c,p);if(null===j)break;if(k.push(j),!m)break;var R=String(j[0]);""===R&&(c.lastIndex=l(p,o(c.lastIndex),x))}for(var A="",I=0,O=0;O<k.length;O++){j=k[O];for(var T=String(j[0]),$=d(b(s(j.index),p.length),0),S=[],_=1;_<j.length;_++)S.push(v(j[_]));var E=j.groups;if(h){var L=[T].concat(S,$,p);void 0!==E&&L.push(E);var C=String(i.apply(void 0,L))}else C=y(T,p,$,S,E,i);$>=I&&(A+=p.slice(I,$)+C,I=$+T.length)}return A+p.slice(I)}];function y(t,a,i,n,o,s){var c=i+t.length,l=n.length,u=m;return void 0!==o&&(o=r(o),u=h),e.call(s,u,(function(e,r){var s;switch(r.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,i);case"'":return a.slice(c);case"<":s=o[r.slice(1,-1)];break;default:var u=+r;if(0===u)return e;if(u>l){var d=p(u/10);return 0===d?e:d<=l?void 0===n[d-1]?r.charAt(1):n[d-1]+r.charAt(1):e}s=n[u-1]}return void 0===s?"":s}))}}))},5701:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tension-view"},[a("p",[t._v("A tension is a difference between what is and what should be")]),a("b-container",[a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"input-none"}},[t._v("Name:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-input",{attrs:{placeholder:"Name"},model:{value:t.tension.label,callback:function(e){t.$set(t.tension,"label",e)},expression:"tension.label"}})],1)],1),a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"input-none"}},[t._v("What is:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-textarea",{attrs:{id:"wi",placeholder:"What is",rows:"3","max-rows":"6"},model:{value:t.tension.wi,callback:function(e){t.$set(t.tension,"wi",e)},expression:"tension.wi"}})],1)],1),a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"input-none"}},[t._v("What should be:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-textarea",{attrs:{id:"wsb",placeholder:"What should be",rows:"3","max-rows":"6"},model:{value:t.tension.wsb,callback:function(e){t.$set(t.tension,"wsb",e)},expression:"tension.wsb"}})],1)],1),a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"input-none"}},[t._v("In which role do you feel this tension:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-input",{attrs:{placeholder:"Role (citizen, user of some service...)"},model:{value:t.tension.roles,callback:function(e){t.$set(t.tension,"roles",e)},expression:"tension.roles"}})],1)],1),a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"input-none"}},[t._v("Which domains does this tension apply:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-input",{attrs:{placeholder:"society, economy, ecology, decentralization..."},model:{value:t.tension.domains,callback:function(e){t.$set(t.tension,"domains",e)},expression:"tension.domains"}})],1)],1),a("b-row",{staticClass:"my-1"},[a("b-col",{attrs:{sm:"3"}},[a("label",{attrs:{for:"radio-privacy"}},[t._v("Privacy:")])]),a("b-col",{attrs:{sm:"9"}},[a("b-form-group",[a("b-form-radio-group",{attrs:{id:"radio-privacy",name:"radio-privacy"},model:{value:t.tension.privacy,callback:function(e){t.$set(t.tension,"privacy",e)},expression:"tension.privacy"}},[a("b-form-radio",{attrs:{value:"public"}},[t._v("Public")]),a("b-form-radio",{attrs:{value:"private"}},[t._v("Private")])],1)],1)],1)],1),a("b-row",{staticClass:"my-1"},[a("b-button",{on:{click:t.create}},[t._v("Save")])],1)],1),t._v(" path : "+t._s(this.path)+" [ change path button] ")],1)},n=[],r=(a("a15b"),a("96cf"),a("1da1")),o=a("18cc"),s={name:"TensionEdit",mixins:[o["a"]],data:function(){return{path:""}},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.storage=t.$store.state.solid.storage,console.log("route",t.$route),void 0==t.$route.params.url){e.next=9;break}return a={url:t.$route.params.url},e.next=6,t.getTensionDetail(a);case 6:i=e.sent,console.log(i),t.fillForm(i);case 9:case"end":return e.stop()}}),e)})))()},methods:{create:function(){this.path=this.storage+this.tension.privacy+"/gouvernance/tensions/",this.createTension()},fillForm:function(t){t.privacy="public",this.tension=t,this.tension.roles=this.tension.roles.join(", "),this.tension.domains=this.tension.domains.join(", ")}},watch:{$route:function(t){console.log("route to",t),void 0!=this.$route.params.tension&&this.fillForm(this.$route.params.tension)}},computed:{config:{get:function(){return this.$store.state.gouvernance.config},set:function(){}}}},c=s,l=a("2877"),u=Object(l["a"])(c,i,n,!1,null,null,null);e["default"]=u.exports},"86bb":function(t,e,a){"use strict";e["a"]={methods:{makeToast:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.$bvToast.toast(e,{title:t,variant:a,solid:!0})}}}}}]);
//# sourceMappingURL=tension-edit.116f5e8f.js.map