{"version":3,"sources":["webpack:///./node_modules/@rdfjs/data-model/lib/named-node.js","webpack:///./node_modules/@rdfjs/data-model/lib/data-factory.js","webpack:///./node_modules/@rdfjs/data-model/lib/blank-node.js","webpack:///./node_modules/@rdfjs/data-model/lib/literal.js","webpack:///./node_modules/cross-fetch/dist/browser-ponyfill.js","webpack:///./node_modules/@inrupt/solid-client/dist/index.es.js","webpack:///./node_modules/@rdfjs/data-model/index.js","webpack:///./node_modules/@rdfjs/data-model/lib/variable.js","webpack:///./node_modules/@rdfjs/dataset/index.js","webpack:///./node_modules/@rdfjs/data-model/lib/default-graph.js","webpack:///./node_modules/@rdfjs/data-model/lib/quad.js","webpack:///./node_modules/@rdfjs/dataset/DatasetCore.js","webpack:///./node_modules/@rdfjs/dataset/isMatch.js"],"names":["NamedNode","iri","this","value","prototype","equals","other","termType","module","exports","BlankNode","DefaultGraph","Literal","Quad","Variable","DataFactory","namedNode","blankNode","literal","languageOrDatatype","indexOf","defaultGraph","defaultGraphInstance","variable","triple","subject","predicate","object","quad","graph","id","nextId","language","datatype","stringDatatype","langStringDatatype","__self__","root","F","fetch","DOMException","self","support","searchParams","iterable","Symbol","blob","Blob","e","formData","arrayBuffer","isDataView","obj","DataView","isPrototypeOf","viewClasses","isArrayBufferView","ArrayBuffer","isView","Object","toString","call","normalizeName","name","String","test","TypeError","toLowerCase","normalizeValue","iteratorFor","items","iterator","next","shift","done","undefined","Headers","headers","map","forEach","append","Array","isArray","header","getOwnPropertyNames","consumed","body","bodyUsed","Promise","reject","fileReaderReady","reader","resolve","onload","result","onerror","error","readBlobAsArrayBuffer","FileReader","promise","readAsArrayBuffer","readBlobAsText","readAsText","readArrayBufferAsText","buf","view","Uint8Array","chars","length","i","fromCharCode","join","bufferClone","slice","byteLength","set","buffer","Body","_initBody","_bodyInit","_bodyText","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","get","type","rejected","Error","then","text","decode","json","JSON","parse","oldValue","has","hasOwnProperty","callback","thisArg","keys","push","values","entries","methods","normalizeMethod","method","upcased","toUpperCase","Request","input","options","url","credentials","mode","signal","referrer","form","trim","split","bytes","replace","decodeURIComponent","parseHeaders","rawHeaders","preProcessedHeaders","line","parts","key","Response","bodyInit","status","ok","statusText","clone","response","redirectStatuses","redirect","RangeError","location","err","message","stack","create","constructor","init","request","aborted","xhr","XMLHttpRequest","abortXhr","abort","getAllResponseHeaders","responseURL","responseText","ontimeout","onabort","open","withCredentials","responseType","setRequestHeader","addEventListener","onreadystatechange","readyState","removeEventListener","send","polyfill","default","__awaiter","_arguments","P","generator","adopt","fulfilled","step","apply","internal_toIriString","hasResourceInfo","dataset","potentialResourceInfo","internal_resourceInfo","hasChangelog","potentialChangeLog","internal_changeLog","additions","deletions","hasAcl","potentialAcl","internal_acl","hasAccessibleAcl","aclUrl","resource","acl","Authorization","accessTo","agent","agentGroup","agentClass","origin","rdf","foaf","Agent","output","add","filter","triplesToTurtle","quads","format","writer","triples","addQuads","writePromise","end","rawTurtle","turtleToTriples","raw","resourceIri","parser","baseIRI","parsingPromise","parsedTriples","_prefixes","isNamedNode","isLocalNode","internal_name","getLocalNode","localNode","assign","asNamedNode","URL","isEqual","node1","node2","namedNode1","resolveIriForLocalNode","namedNode2","resolveIriForLocalNodes","resolveLocalIri","thingIri","hash","href","getSolidDataset","internal_defaultFetchOptions","config","Accept","data","resourceInfo","internal_parseResourceInfo","resourceWithResourceInfo","getSolidDatasetWithAcl","solidDataset","internal_fetchAcl","saveSolidDatasetAt","requestInit","isUpdate","deleteStatement","getNamedNodesForLocalNodes","insertStatement","from","Link","sourceIri","isRawData","storedDataset","storedDatasetWithResolvedIris","resolveLocalIrisInSolidDataset","getNamedNodeFromLocalNode","getSourceUrl","unresolvedQuads","unresolvedQuad","resolvedQuad","delete","getThing","thingUrl","scope","thingDataset","match","thing","internal_localSubject","internal_url","getThingAll","subjectNodes","quadSubject","some","subjectNode","things","setThing","newDataset","removeThing","includes","deletion","newSolidDataset","withChangeLog","cloneLitStructs","thingSubject","toNode","addition","freshDataset","internal_isAclDataset","internal_accessTo","createThing","_a","generateName","localSubject","asUrl","baseUrl","isThingLocal","asIri","cloneThing","cloned","filterThing","filtered","Date","now","Math","random","substring","getUrl","property","namedNodeMatcher","getNamedNodeMatcher","matchingQuad","findOne","getIri","getUrlAll","iriMatcher","matchingQuads","findAll","getIriAll","matcher","matched","predicateNode","removeAll","updatedThing","removeUrl","iriNode","removeIri","setUrl","newThing","setIri","internal_fetchResourceAcl","aclSolidDataset","internal_fetchFallbackAcl","resourceUrl","resourcePath","pathname","containerPath","getContainerPath","containerIri","containerInfo","internal_fetchResourceInfo","containerAcl","resourcePathWithoutTrailingSlash","lastIndexOf","hasResourceAcl","resourceAcl","getResourceAcl","hasFallbackAcl","fallbackAcl","getFallbackAcl","createAcl","targetResource","emptyResourceAcl","createAclFromFallbackAcl","fallbackAclRules","internal_getAclRules","defaultAclRules","internal_getDefaultAclRulesForResource","resourceAclRules","rule","initialisedResourceAcl","reduce","aclDataset","isAclRule","internal_getResourceAclRulesForResource","aclRules","appliesToResource","aclRule","isDefaultForResource","internal_getAccess","ruleAccessModes","writeAccess","internal_accessModeIriStrings","write","read","control","internal_combineAccessModes","modes","accumulator","current","internal_removeEmptyAclRules","aclRulesToRemove","isEmptyAclRule","updatedAclDataset","isAclQuad","internal_getAccessByIri","targetType","targetIriAccess","ruleTargetIri","access","targetIri","saveAclFor","savedDataset","savedAclDataset","internal_initialiseAclRule","newRule","addIri","internal_duplicateAclRule","sourceRule","targetRule","copyIris","inputRule","outputRule","iriTarget","all","_b","_c","contentTypeParts","isSolidDataset","contentType","linkHeader","parsedLinks","aclLinks","uri","wacAllowHeader","permissions","parseWacAllowHeader","parsePermissionStatement","permissionStatement","writePermission","getStatementFor","relevantEntries","rawEntry","relevantStatement","charAt","user","public","defaultGetFileOptions","deleteFile","addUrl","getAgentAccessAll","getAgentResourceAccessAll","getAgentDefaultAccessAll","allRules","resourceRules","agentResourceRules","getAgentAclRules","getAccessByAgent","isAgentAclRule","getPublicAccess","getPublicResourceAccess","getPublicDefaultAccess","publicResourceRules","getClassAclRulesForClass","publicAccessModes","setPublicDefaultAccess","filteredAcl","filteredRule","remainingRule","removePublicFromRule","updatedAcl","cleanedAcl","ruleType","emptyRule","ruleWithoutPublic","ruleForOtherTargets","appliesToClass","DatasetCore","isMatch","Set","size","localQuad","matches"],"mappings":"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","file":"js/chunk-48cb2279.53117c8a.js","sourcesContent":["function NamedNode (iri) {\n  this.value = iri\n}\n\nNamedNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nNamedNode.prototype.termType = 'NamedNode'\n\nmodule.exports = NamedNode\n","var BlankNode = require('./blank-node')\nvar DefaultGraph = require('./default-graph')\nvar Literal = require('./literal')\nvar NamedNode = require('./named-node')\nvar Quad = require('./quad')\nvar Variable = require('./variable')\n\nfunction DataFactory () {}\n\nDataFactory.namedNode = function (value) {\n  return new NamedNode(value)\n}\n\nDataFactory.blankNode = function (value) {\n  return new BlankNode(value)\n}\n\nDataFactory.literal = function (value, languageOrDatatype) {\n  if (typeof languageOrDatatype === 'string') {\n    if (languageOrDatatype.indexOf(':') === -1) {\n      return new Literal(value, languageOrDatatype)\n    }\n\n    return new Literal(value, null, DataFactory.namedNode(languageOrDatatype))\n  }\n\n  return new Literal(value, null, languageOrDatatype)\n}\n\nDataFactory.defaultGraph = function () {\n  return DataFactory.defaultGraphInstance\n}\n\nDataFactory.variable = function (value) {\n  return new Variable(value)\n}\n\nDataFactory.triple = function (subject, predicate, object) {\n  return DataFactory.quad(subject, predicate, object)\n}\n\nDataFactory.quad = function (subject, predicate, object, graph) {\n  return new Quad(subject, predicate, object, graph || DataFactory.defaultGraphInstance)\n}\n\nDataFactory.defaultGraphInstance = new DefaultGraph()\n\nmodule.exports = DataFactory\n","function BlankNode (id) {\n  this.value = id || ('b' + (++BlankNode.nextId))\n}\n\nBlankNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nBlankNode.prototype.termType = 'BlankNode'\n\nBlankNode.nextId = 0\n\nmodule.exports = BlankNode\n","var NamedNode = require('./named-node')\n\nfunction Literal (value, language, datatype) {\n  this.value = value\n  this.datatype = Literal.stringDatatype\n  this.language = ''\n\n  if (language) {\n    this.language = language\n    this.datatype = Literal.langStringDatatype\n  } else if (datatype) {\n    this.datatype = datatype\n  }\n}\n\nLiteral.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value &&\n    other.language === this.language && other.datatype.equals(this.datatype)\n}\n\nLiteral.prototype.termType = 'Literal'\nLiteral.langStringDatatype = new NamedNode('http://www.w3.org/1999/02/22-rdf-syntax-ns#langString')\nLiteral.stringDatatype = new NamedNode('http://www.w3.org/2001/XMLSchema#string')\n\nmodule.exports = Literal\n","var __self__ = (function (root) {\nfunction F() {\nthis.fetch = false;\nthis.DOMException = root.DOMException\n}\nF.prototype = root;\nreturn new F();\n})(typeof self !== 'undefined' ? self : this);\n(function(self) {\n\nvar irrelevant = (function (exports) {\n  var support = {\n    searchParams: 'URLSearchParams' in self,\n    iterable: 'Symbol' in self && 'iterator' in Symbol,\n    blob:\n      'FileReader' in self &&\n      'Blob' in self &&\n      (function() {\n        try {\n          new Blob();\n          return true\n        } catch (e) {\n          return false\n        }\n      })(),\n    formData: 'FormData' in self,\n    arrayBuffer: 'ArrayBuffer' in self\n  };\n\n  function isDataView(obj) {\n    return obj && DataView.prototype.isPrototypeOf(obj)\n  }\n\n  if (support.arrayBuffer) {\n    var viewClasses = [\n      '[object Int8Array]',\n      '[object Uint8Array]',\n      '[object Uint8ClampedArray]',\n      '[object Int16Array]',\n      '[object Uint16Array]',\n      '[object Int32Array]',\n      '[object Uint32Array]',\n      '[object Float32Array]',\n      '[object Float64Array]'\n    ];\n\n    var isArrayBufferView =\n      ArrayBuffer.isView ||\n      function(obj) {\n        return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n      };\n  }\n\n  function normalizeName(name) {\n    if (typeof name !== 'string') {\n      name = String(name);\n    }\n    if (/[^a-z0-9\\-#$%&'*+.^_`|~]/i.test(name)) {\n      throw new TypeError('Invalid character in header field name')\n    }\n    return name.toLowerCase()\n  }\n\n  function normalizeValue(value) {\n    if (typeof value !== 'string') {\n      value = String(value);\n    }\n    return value\n  }\n\n  // Build a destructive iterator for the value list\n  function iteratorFor(items) {\n    var iterator = {\n      next: function() {\n        var value = items.shift();\n        return {done: value === undefined, value: value}\n      }\n    };\n\n    if (support.iterable) {\n      iterator[Symbol.iterator] = function() {\n        return iterator\n      };\n    }\n\n    return iterator\n  }\n\n  function Headers(headers) {\n    this.map = {};\n\n    if (headers instanceof Headers) {\n      headers.forEach(function(value, name) {\n        this.append(name, value);\n      }, this);\n    } else if (Array.isArray(headers)) {\n      headers.forEach(function(header) {\n        this.append(header[0], header[1]);\n      }, this);\n    } else if (headers) {\n      Object.getOwnPropertyNames(headers).forEach(function(name) {\n        this.append(name, headers[name]);\n      }, this);\n    }\n  }\n\n  Headers.prototype.append = function(name, value) {\n    name = normalizeName(name);\n    value = normalizeValue(value);\n    var oldValue = this.map[name];\n    this.map[name] = oldValue ? oldValue + ', ' + value : value;\n  };\n\n  Headers.prototype['delete'] = function(name) {\n    delete this.map[normalizeName(name)];\n  };\n\n  Headers.prototype.get = function(name) {\n    name = normalizeName(name);\n    return this.has(name) ? this.map[name] : null\n  };\n\n  Headers.prototype.has = function(name) {\n    return this.map.hasOwnProperty(normalizeName(name))\n  };\n\n  Headers.prototype.set = function(name, value) {\n    this.map[normalizeName(name)] = normalizeValue(value);\n  };\n\n  Headers.prototype.forEach = function(callback, thisArg) {\n    for (var name in this.map) {\n      if (this.map.hasOwnProperty(name)) {\n        callback.call(thisArg, this.map[name], name, this);\n      }\n    }\n  };\n\n  Headers.prototype.keys = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push(name);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.values = function() {\n    var items = [];\n    this.forEach(function(value) {\n      items.push(value);\n    });\n    return iteratorFor(items)\n  };\n\n  Headers.prototype.entries = function() {\n    var items = [];\n    this.forEach(function(value, name) {\n      items.push([name, value]);\n    });\n    return iteratorFor(items)\n  };\n\n  if (support.iterable) {\n    Headers.prototype[Symbol.iterator] = Headers.prototype.entries;\n  }\n\n  function consumed(body) {\n    if (body.bodyUsed) {\n      return Promise.reject(new TypeError('Already read'))\n    }\n    body.bodyUsed = true;\n  }\n\n  function fileReaderReady(reader) {\n    return new Promise(function(resolve, reject) {\n      reader.onload = function() {\n        resolve(reader.result);\n      };\n      reader.onerror = function() {\n        reject(reader.error);\n      };\n    })\n  }\n\n  function readBlobAsArrayBuffer(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsArrayBuffer(blob);\n    return promise\n  }\n\n  function readBlobAsText(blob) {\n    var reader = new FileReader();\n    var promise = fileReaderReady(reader);\n    reader.readAsText(blob);\n    return promise\n  }\n\n  function readArrayBufferAsText(buf) {\n    var view = new Uint8Array(buf);\n    var chars = new Array(view.length);\n\n    for (var i = 0; i < view.length; i++) {\n      chars[i] = String.fromCharCode(view[i]);\n    }\n    return chars.join('')\n  }\n\n  function bufferClone(buf) {\n    if (buf.slice) {\n      return buf.slice(0)\n    } else {\n      var view = new Uint8Array(buf.byteLength);\n      view.set(new Uint8Array(buf));\n      return view.buffer\n    }\n  }\n\n  function Body() {\n    this.bodyUsed = false;\n\n    this._initBody = function(body) {\n      this._bodyInit = body;\n      if (!body) {\n        this._bodyText = '';\n      } else if (typeof body === 'string') {\n        this._bodyText = body;\n      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n        this._bodyBlob = body;\n      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n        this._bodyFormData = body;\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this._bodyText = body.toString();\n      } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n        this._bodyArrayBuffer = bufferClone(body.buffer);\n        // IE 10-11 can't handle a DataView body.\n        this._bodyInit = new Blob([this._bodyArrayBuffer]);\n      } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n        this._bodyArrayBuffer = bufferClone(body);\n      } else {\n        this._bodyText = body = Object.prototype.toString.call(body);\n      }\n\n      if (!this.headers.get('content-type')) {\n        if (typeof body === 'string') {\n          this.headers.set('content-type', 'text/plain;charset=UTF-8');\n        } else if (this._bodyBlob && this._bodyBlob.type) {\n          this.headers.set('content-type', this._bodyBlob.type);\n        } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n          this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n        }\n      }\n    };\n\n    if (support.blob) {\n      this.blob = function() {\n        var rejected = consumed(this);\n        if (rejected) {\n          return rejected\n        }\n\n        if (this._bodyBlob) {\n          return Promise.resolve(this._bodyBlob)\n        } else if (this._bodyArrayBuffer) {\n          return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n        } else if (this._bodyFormData) {\n          throw new Error('could not read FormData body as blob')\n        } else {\n          return Promise.resolve(new Blob([this._bodyText]))\n        }\n      };\n\n      this.arrayBuffer = function() {\n        if (this._bodyArrayBuffer) {\n          return consumed(this) || Promise.resolve(this._bodyArrayBuffer)\n        } else {\n          return this.blob().then(readBlobAsArrayBuffer)\n        }\n      };\n    }\n\n    this.text = function() {\n      var rejected = consumed(this);\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return readBlobAsText(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as text')\n      } else {\n        return Promise.resolve(this._bodyText)\n      }\n    };\n\n    if (support.formData) {\n      this.formData = function() {\n        return this.text().then(decode)\n      };\n    }\n\n    this.json = function() {\n      return this.text().then(JSON.parse)\n    };\n\n    return this\n  }\n\n  // HTTP methods whose capitalization should be normalized\n  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT'];\n\n  function normalizeMethod(method) {\n    var upcased = method.toUpperCase();\n    return methods.indexOf(upcased) > -1 ? upcased : method\n  }\n\n  function Request(input, options) {\n    options = options || {};\n    var body = options.body;\n\n    if (input instanceof Request) {\n      if (input.bodyUsed) {\n        throw new TypeError('Already read')\n      }\n      this.url = input.url;\n      this.credentials = input.credentials;\n      if (!options.headers) {\n        this.headers = new Headers(input.headers);\n      }\n      this.method = input.method;\n      this.mode = input.mode;\n      this.signal = input.signal;\n      if (!body && input._bodyInit != null) {\n        body = input._bodyInit;\n        input.bodyUsed = true;\n      }\n    } else {\n      this.url = String(input);\n    }\n\n    this.credentials = options.credentials || this.credentials || 'same-origin';\n    if (options.headers || !this.headers) {\n      this.headers = new Headers(options.headers);\n    }\n    this.method = normalizeMethod(options.method || this.method || 'GET');\n    this.mode = options.mode || this.mode || null;\n    this.signal = options.signal || this.signal;\n    this.referrer = null;\n\n    if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n      throw new TypeError('Body not allowed for GET or HEAD requests')\n    }\n    this._initBody(body);\n  }\n\n  Request.prototype.clone = function() {\n    return new Request(this, {body: this._bodyInit})\n  };\n\n  function decode(body) {\n    var form = new FormData();\n    body\n      .trim()\n      .split('&')\n      .forEach(function(bytes) {\n        if (bytes) {\n          var split = bytes.split('=');\n          var name = split.shift().replace(/\\+/g, ' ');\n          var value = split.join('=').replace(/\\+/g, ' ');\n          form.append(decodeURIComponent(name), decodeURIComponent(value));\n        }\n      });\n    return form\n  }\n\n  function parseHeaders(rawHeaders) {\n    var headers = new Headers();\n    // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n    // https://tools.ietf.org/html/rfc7230#section-3.2\n    var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ');\n    preProcessedHeaders.split(/\\r?\\n/).forEach(function(line) {\n      var parts = line.split(':');\n      var key = parts.shift().trim();\n      if (key) {\n        var value = parts.join(':').trim();\n        headers.append(key, value);\n      }\n    });\n    return headers\n  }\n\n  Body.call(Request.prototype);\n\n  function Response(bodyInit, options) {\n    if (!options) {\n      options = {};\n    }\n\n    this.type = 'default';\n    this.status = options.status === undefined ? 200 : options.status;\n    this.ok = this.status >= 200 && this.status < 300;\n    this.statusText = 'statusText' in options ? options.statusText : 'OK';\n    this.headers = new Headers(options.headers);\n    this.url = options.url || '';\n    this._initBody(bodyInit);\n  }\n\n  Body.call(Response.prototype);\n\n  Response.prototype.clone = function() {\n    return new Response(this._bodyInit, {\n      status: this.status,\n      statusText: this.statusText,\n      headers: new Headers(this.headers),\n      url: this.url\n    })\n  };\n\n  Response.error = function() {\n    var response = new Response(null, {status: 0, statusText: ''});\n    response.type = 'error';\n    return response\n  };\n\n  var redirectStatuses = [301, 302, 303, 307, 308];\n\n  Response.redirect = function(url, status) {\n    if (redirectStatuses.indexOf(status) === -1) {\n      throw new RangeError('Invalid status code')\n    }\n\n    return new Response(null, {status: status, headers: {location: url}})\n  };\n\n  exports.DOMException = self.DOMException;\n  try {\n    new exports.DOMException();\n  } catch (err) {\n    exports.DOMException = function(message, name) {\n      this.message = message;\n      this.name = name;\n      var error = Error(message);\n      this.stack = error.stack;\n    };\n    exports.DOMException.prototype = Object.create(Error.prototype);\n    exports.DOMException.prototype.constructor = exports.DOMException;\n  }\n\n  function fetch(input, init) {\n    return new Promise(function(resolve, reject) {\n      var request = new Request(input, init);\n\n      if (request.signal && request.signal.aborted) {\n        return reject(new exports.DOMException('Aborted', 'AbortError'))\n      }\n\n      var xhr = new XMLHttpRequest();\n\n      function abortXhr() {\n        xhr.abort();\n      }\n\n      xhr.onload = function() {\n        var options = {\n          status: xhr.status,\n          statusText: xhr.statusText,\n          headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n        };\n        options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL');\n        var body = 'response' in xhr ? xhr.response : xhr.responseText;\n        resolve(new Response(body, options));\n      };\n\n      xhr.onerror = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function() {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.onabort = function() {\n        reject(new exports.DOMException('Aborted', 'AbortError'));\n      };\n\n      xhr.open(request.method, request.url, true);\n\n      if (request.credentials === 'include') {\n        xhr.withCredentials = true;\n      } else if (request.credentials === 'omit') {\n        xhr.withCredentials = false;\n      }\n\n      if ('responseType' in xhr && support.blob) {\n        xhr.responseType = 'blob';\n      }\n\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n\n      if (request.signal) {\n        request.signal.addEventListener('abort', abortXhr);\n\n        xhr.onreadystatechange = function() {\n          // DONE (success or failure)\n          if (xhr.readyState === 4) {\n            request.signal.removeEventListener('abort', abortXhr);\n          }\n        };\n      }\n\n      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit);\n    })\n  }\n\n  fetch.polyfill = true;\n\n  if (!self.fetch) {\n    self.fetch = fetch;\n    self.Headers = Headers;\n    self.Request = Request;\n    self.Response = Response;\n  }\n\n  exports.Headers = Headers;\n  exports.Request = Request;\n  exports.Response = Response;\n  exports.fetch = fetch;\n\n  return exports;\n\n}({}));\n})(__self__);\ndelete __self__.fetch.polyfill\nexports = __self__.fetch // To enable: import fetch from 'cross-fetch'\nexports.default = __self__.fetch // For TypeScript consumers without esModuleInterop.\nexports.fetch = __self__.fetch // To enable: import {fetch} from 'cross-fetch'\nexports.Headers = __self__.Headers\nexports.Request = __self__.Request\nexports.Response = __self__.Response\nmodule.exports = exports\n","import LinkHeader from 'http-link-header';\nimport { quad, literal, namedNode, blankNode, dataset } from '@rdfjs/dataset';\nimport { Writer, Parser } from 'n3';\nimport { Headers } from 'cross-fetch';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/** @internal */\r\nfunction internal_toIriString(iri) {\r\n    return typeof iri === \"string\" ? iri : iri.value;\r\n}\r\n/**\r\n * Verify whether a given SolidDataset includes metadata about where it was retrieved from.\r\n *\r\n * @param dataset A [[SolidDataset]] that may have metadata attached about the Resource it was retrieved from.\r\n * @returns True if `dataset` includes metadata about the Resource it was retrieved from, false if not.\r\n */\r\nfunction hasResourceInfo(dataset) {\r\n    const potentialResourceInfo = dataset;\r\n    return typeof potentialResourceInfo.internal_resourceInfo === \"object\";\r\n}\r\n/** @internal */\r\nfunction hasChangelog(dataset) {\r\n    const potentialChangeLog = dataset;\r\n    return (typeof potentialChangeLog.internal_changeLog === \"object\" &&\r\n        Array.isArray(potentialChangeLog.internal_changeLog.additions) &&\r\n        Array.isArray(potentialChangeLog.internal_changeLog.deletions));\r\n}\r\n/**\r\n * Verify whether a given SolidDataset was fetched together with its Access Control List.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param dataset A [[SolidDataset]] that may have its ACLs attached.\r\n * @returns True if `dataset` was fetched together with its ACLs.\r\n */\r\nfunction hasAcl(dataset) {\r\n    const potentialAcl = dataset;\r\n    return typeof potentialAcl.internal_acl === \"object\";\r\n}\r\n/**\r\n * Given a [[SolidDataset]], verify whether its Access Control List is accessible to the current user.\r\n *\r\n * This should generally only be true for SolidDatasets fetched by\r\n * [[getSolidDatasetWithAcl]].\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param dataset A [[SolidDataset]].\r\n * @returns Whether the given `dataset` has a an ACL that is accessible to the current user.\r\n */\r\nfunction hasAccessibleAcl(dataset) {\r\n    return typeof dataset.internal_resourceInfo.aclUrl === \"string\";\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * @ignore Internal fallback for when no fetcher is provided; not to be used downstream.\r\n */\r\nconst fetch = (resource, init) => {\r\n    // Implementation note: it's up to the client application to resolve these module names to the\r\n    // respective npm packages. At least one commonly used tool (Webpack) is only able to do that if\r\n    // the module names are literal strings.\r\n    // Additionally, Webpack throws a warning in a way that halts compilation for at least Next.js\r\n    // when using native Javascript dynamic imports (`import()`), whereas `require()` just logs a\r\n    // warning. Since the use of package names instead of file names requires a bundles anyway, this\r\n    // should not have any practical consequences. For more background, see:\r\n    // https://github.com/webpack/webpack/issues/7713\r\n    let fetch;\r\n    try {\r\n        fetch = require(\"solid-auth-client\").fetch;\r\n    }\r\n    catch (e) {\r\n        fetch = require(\"cross-fetch\");\r\n    }\r\n    return fetch(resource, init);\r\n};\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n// TODO: These should be replaced by auto-generated constants,\r\n//       if we can ensure that unused constants will be excluded from bundles.\r\n/** @internal */\r\nconst acl = {\r\n    Authorization: \"http://www.w3.org/ns/auth/acl#Authorization\",\r\n    accessTo: \"http://www.w3.org/ns/auth/acl#accessTo\",\r\n    agent: \"http://www.w3.org/ns/auth/acl#agent\",\r\n    agentGroup: \"http://www.w3.org/ns/auth/acl#agentGroup\",\r\n    agentClass: \"http://www.w3.org/ns/auth/acl#agentClass\",\r\n    default: \"http://www.w3.org/ns/auth/acl#default\",\r\n    mode: \"http://www.w3.org/ns/auth/acl#mode\",\r\n    origin: \"http://www.w3.org/ns/auth/acl#origin\",\r\n};\r\n/** @internal */\r\nconst rdf = {\r\n    type: \"http://www.w3.org/1999/02/22-rdf-syntax-ns#type\",\r\n};\r\n/** @internal */\r\nconst foaf = {\r\n    Agent: \"http://xmlns.com/foaf/0.1/Agent\",\r\n};\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * @internal\r\n */\r\nconst DataFactory = { quad, literal, namedNode, blankNode };\r\n/**\r\n * Clone a Dataset.\r\n *\r\n * Note that the Quads are not cloned, i.e. if you modify the Quads in the output Dataset, the Quads\r\n * in the input Dataset will also be changed.\r\n *\r\n * @internal\r\n * @param input Dataset to clone.\r\n * @returns A new Dataset with the same Quads as `input`.\r\n */\r\nfunction clone(input) {\r\n    const output = dataset();\r\n    for (const quad of input) {\r\n        output.add(quad);\r\n    }\r\n    return output;\r\n}\r\n/**\r\n * @internal\r\n * @param input Dataset to clone.\r\n * @param callback Function that takes a Quad, and returns a boolean indicating whether that Quad should be included in the cloned Dataset.\r\n * @returns A new Dataset with the same Quads as `input`, excluding the ones for which `callback` returned `false`.\r\n */\r\nfunction filter(input, callback) {\r\n    const output = dataset();\r\n    for (const quad of input) {\r\n        if (callback(quad)) {\r\n            output.add(quad);\r\n        }\r\n    }\r\n    return output;\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * @param quads Triples that should be serialised to Turtle\r\n * @internal Utility method for internal use; not part of the public API.\r\n */\r\nfunction triplesToTurtle(quads) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const format = \"text/turtle\";\r\n        const writer = new Writer({ format: format });\r\n        // Remove any potentially lingering references to Named Graphs in Quads;\r\n        // they'll be determined by the URL the Turtle will be sent to:\r\n        const triples = quads.map((quad) => DataFactory.quad(quad.subject, quad.predicate, quad.object, undefined));\r\n        writer.addQuads(triples);\r\n        const writePromise = new Promise((resolve, reject) => {\r\n            writer.end((error, result) => {\r\n                /* istanbul ignore if [n3.js doesn't actually pass an error nor a result, apparently: https://github.com/rdfjs/N3.js/blob/62682e48c02d8965b4d728cb5f2cbec6b5d1b1b8/src/N3Writer.js#L290] */\r\n                if (error) {\r\n                    return reject(error);\r\n                }\r\n                resolve(result);\r\n            });\r\n        });\r\n        const rawTurtle = yield writePromise;\r\n        return rawTurtle;\r\n    });\r\n}\r\n/**\r\n * @param raw Turtle that should be parsed into Triples\r\n * @internal Utility method for internal use; not part of the public API.\r\n */\r\nfunction turtleToTriples(raw, resourceIri) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const format = \"text/turtle\";\r\n        const parser = new Parser({ format: format, baseIRI: resourceIri });\r\n        const parsingPromise = new Promise((resolve, reject) => {\r\n            const parsedTriples = [];\r\n            parser.parse(raw, (error, triple, _prefixes) => {\r\n                if (error) {\r\n                    return reject(error);\r\n                }\r\n                if (triple) {\r\n                    parsedTriples.push(triple);\r\n                }\r\n                else {\r\n                    resolve(parsedTriples);\r\n                }\r\n            });\r\n        });\r\n        return parsingPromise;\r\n    });\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * IRIs of the XML Schema data types we support\r\n * @internal\r\n */\r\nconst xmlSchemaTypes = {\r\n    boolean: \"http://www.w3.org/2001/XMLSchema#boolean\",\r\n    dateTime: \"http://www.w3.org/2001/XMLSchema#dateTime\",\r\n    decimal: \"http://www.w3.org/2001/XMLSchema#decimal\",\r\n    integer: \"http://www.w3.org/2001/XMLSchema#integer\",\r\n    string: \"http://www.w3.org/2001/XMLSchema#string\",\r\n    langString: \"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString\",\r\n};\r\n/**\r\n * @internal\r\n * @param value Value to serialise.\r\n * @returns String representation of `value`.\r\n */\r\nfunction serializeBoolean(value) {\r\n    return value ? \"1\" : \"0\";\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to deserialise.\r\n * @returns Deserialized boolean, or null if the given value is not a valid serialised boolean.\r\n */\r\nfunction deserializeBoolean(value) {\r\n    if (value === \"1\") {\r\n        return true;\r\n    }\r\n    else if (value === \"0\") {\r\n        return false;\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to serialise.\r\n * @returns String representation of `value`.\r\n */\r\nfunction serializeDatetime(value) {\r\n    // To align with rdflib, we ignore miliseconds:\r\n    // https://github.com/linkeddata/rdflib.js/blob/d84af88f367b8b5f617c753d8241c5a2035458e8/src/literal.js#L74\r\n    const roundedDate = new Date(Date.UTC(value.getUTCFullYear(), value.getUTCMonth(), value.getUTCDate(), value.getUTCHours(), value.getUTCMinutes(), value.getUTCSeconds(), 0));\r\n    // Truncate the `.000Z` at the end (i.e. the miliseconds), to plain `Z`:\r\n    const rdflibStyleString = roundedDate.toISOString().replace(/\\.000Z$/, \"Z\");\r\n    return rdflibStyleString;\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to deserialise.\r\n * @returns Deserialized datetime, or null if the given value is not a valid serialised datetime.\r\n */\r\nfunction deserializeDatetime(literalString) {\r\n    if (literalString === null ||\r\n        literalString.length <= 17 ||\r\n        literalString.indexOf(\"Z\") === -1) {\r\n        return null;\r\n    }\r\n    // See https://github.com/linkeddata/rdflib.js/blob/d84af88f367b8b5f617c753d8241c5a2035458e8/src/literal.js#L87\r\n    const utcFullYear = parseInt(literalString.substring(0, 4), 10);\r\n    const utcMonth = parseInt(literalString.substring(5, 7), 10) - 1;\r\n    const utcDate = parseInt(literalString.substring(8, 10), 10);\r\n    const utcHours = parseInt(literalString.substring(11, 13), 10);\r\n    const utcMinutes = parseInt(literalString.substring(14, 16), 10);\r\n    const utcSeconds = parseInt(literalString.substring(17, literalString.indexOf(\"Z\")), 10);\r\n    const date = new Date(0);\r\n    date.setUTCFullYear(utcFullYear);\r\n    date.setUTCMonth(utcMonth);\r\n    date.setUTCDate(utcDate);\r\n    date.setUTCHours(utcHours);\r\n    date.setUTCMinutes(utcMinutes);\r\n    date.setUTCSeconds(utcSeconds);\r\n    return date;\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to serialise.\r\n * @returns String representation of `value`.\r\n */\r\nfunction serializeDecimal(value) {\r\n    return value.toString();\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to deserialise.\r\n * @returns Deserialized decimal, or null if the given value is not a valid serialised decimal.\r\n */\r\nfunction deserializeDecimal(literalString) {\r\n    const deserialized = Number.parseFloat(literalString);\r\n    if (Number.isNaN(deserialized)) {\r\n        return null;\r\n    }\r\n    return deserialized;\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to serialise.\r\n * @returns String representation of `value`.\r\n */\r\nfunction serializeInteger(value) {\r\n    return value.toString();\r\n}\r\n/**\r\n * @internal\r\n * @param value Value to deserialise.\r\n * @returns Deserialized integer, or null if the given value is not a valid serialised integer.\r\n */\r\nfunction deserializeInteger(literalString) {\r\n    const deserialized = Number.parseInt(literalString, 10);\r\n    if (Number.isNaN(deserialized)) {\r\n        return null;\r\n    }\r\n    return deserialized;\r\n}\r\n/**\r\n * @internal\r\n * @param locale Locale to transform into a consistent format.\r\n */\r\nfunction normalizeLocale(locale) {\r\n    return locale.toLowerCase();\r\n}\r\n/**\r\n * @internal Library users shouldn't need to be exposed to raw NamedNodes.\r\n * @param value The value that might or might not be a Named Node.\r\n * @returns Whether `value` is a Named Node.\r\n */\r\nfunction isNamedNode(value) {\r\n    return (typeof value === \"object\" &&\r\n        typeof value.termType === \"string\" &&\r\n        value.termType === \"NamedNode\");\r\n}\r\n/**\r\n * @internal Library users shouldn't need to be exposed to raw Literals.\r\n * @param value The value that might or might not be a Literal.\r\n * @returns Whether `value` is a Literal.\r\n */\r\nfunction isLiteral(value) {\r\n    return (typeof value === \"object\" &&\r\n        typeof value.termType === \"string\" &&\r\n        value.termType === \"Literal\");\r\n}\r\n/**\r\n * @internal Library users shouldn't need to be exposed to LocalNodes.\r\n * @param value The value that might or might not be a Node with no known IRI yet.\r\n * @returns Whether `value` is a Node with no known IRI yet.\r\n */\r\nfunction isLocalNode(value) {\r\n    return (typeof value === \"object\" &&\r\n        typeof value.termType === \"string\" &&\r\n        value.termType === \"BlankNode\" &&\r\n        typeof value.internal_name === \"string\");\r\n}\r\n/**\r\n * Construct a new LocalNode.\r\n *\r\n * @internal Library users shouldn't need to be exposed to LocalNodes.\r\n * @param name Name to identify this node by.\r\n * @returns A LocalNode whose name will be resolved when it is persisted to a Pod.\r\n */\r\nfunction getLocalNode(name) {\r\n    const localNode = Object.assign(DataFactory.blankNode(), {\r\n        internal_name: name,\r\n    });\r\n    return localNode;\r\n}\r\n/**\r\n * Ensure that a given value is a Named Node.\r\n *\r\n * If the given parameter is a Named Node already, it will be returned as-is. If it is a string, it\r\n * will check whether it is a valid IRI. If not, it will throw an error; otherwise a Named Node\r\n * representing the given IRI will be returned.\r\n *\r\n * @internal Library users shouldn't need to be exposed to raw NamedNodes.\r\n * @param iri The IRI that should be converted into a Named Node, if it isn't one yet.\r\n */\r\nfunction asNamedNode(iri) {\r\n    if (isNamedNode(iri)) {\r\n        return iri;\r\n    }\r\n    // If the runtime environment supports URL, instantiate one.\r\n    // If the given IRI is not a valid URL, it will throw an error.\r\n    // See: https://developer.mozilla.org/en-US/docs/Web/API/URL\r\n    /* istanbul ignore else [URL is available in our testing environment, so we cannot test the alternative] */\r\n    if (typeof URL !== \"undefined\") {\r\n        new URL(iri);\r\n    }\r\n    return DataFactory.namedNode(iri);\r\n}\r\n/**\r\n * Check whether two current- or potential NamedNodes are/will be equal.\r\n *\r\n * @internal Utility method; library users should not need to interact with LocalNodes directly.\r\n */\r\nfunction isEqual(node1, node2, options = {}) {\r\n    if (isNamedNode(node1) && isNamedNode(node2)) {\r\n        return node1.equals(node2);\r\n    }\r\n    if (isLocalNode(node1) && isLocalNode(node2)) {\r\n        return node1.internal_name === node2.internal_name;\r\n    }\r\n    if (typeof options.resourceIri === \"undefined\") {\r\n        // If we don't know what IRI to resolve the LocalNode to,\r\n        // we cannot conclude that it is equal to the NamedNode's full IRI:\r\n        return false;\r\n    }\r\n    const namedNode1 = isNamedNode(node1)\r\n        ? node1\r\n        : resolveIriForLocalNode(node1, options.resourceIri);\r\n    const namedNode2 = isNamedNode(node2)\r\n        ? node2\r\n        : resolveIriForLocalNode(node2, options.resourceIri);\r\n    return namedNode1.equals(namedNode2);\r\n}\r\n/**\r\n * @internal Utility method; library users should not need to interact with LocalNodes directly.\r\n * @param quad The Quad to resolve LocalNodes in.\r\n * @param resourceIri The IRI of the Resource to resolve the LocalNodes against.\r\n */\r\nfunction resolveIriForLocalNodes(quad, resourceIri) {\r\n    const subject = isLocalNode(quad.subject)\r\n        ? resolveIriForLocalNode(quad.subject, resourceIri)\r\n        : quad.subject;\r\n    const object = isLocalNode(quad.object)\r\n        ? resolveIriForLocalNode(quad.object, resourceIri)\r\n        : quad.object;\r\n    return Object.assign(Object.assign({}, quad), { subject: subject, object: object });\r\n}\r\n/**\r\n * @internal Utility method; library users should not need to interact with LocalNodes directly.\r\n * @param localNode The LocalNode to resolve to a NamedNode.\r\n * @param resourceIri The Resource in which the Node will be saved.\r\n */\r\nfunction resolveIriForLocalNode(localNode, resourceIri) {\r\n    return DataFactory.namedNode(resolveLocalIri(localNode.internal_name, resourceIri));\r\n}\r\n/**\r\n * @internal API for internal use only.\r\n * @param name The name identifying a Thing.\r\n * @param resourceIri The Resource in which the Thing can be found.\r\n */\r\nfunction resolveLocalIri(name, resourceIri) {\r\n    /* istanbul ignore if [The URL interface is available in the testing environment, so we cannot test this] */\r\n    if (typeof URL === \"undefined\") {\r\n        throw new Error(\"The URL interface is not available, so an IRI cannot be determined.\");\r\n    }\r\n    const thingIri = new URL(resourceIri);\r\n    thingIri.hash = name;\r\n    return thingIri.href;\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Initialise a new [[SolidDataset]] in memory.\r\n *\r\n * @returns An empty [[SolidDataset]].\r\n */\r\nfunction createSolidDataset() {\r\n    return dataset();\r\n}\r\n/**\r\n * Fetch a SolidDataset from the given URL. Currently requires the SolidDataset to be available as [Turtle](https://www.w3.org/TR/turtle/).\r\n *\r\n * @param url URL to fetch a [[SolidDataset]] from.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n * @returns Promise resolving to a [[SolidDataset]] containing the data at the given Resource, or rejecting if fetching it failed.\r\n */\r\nfunction getSolidDataset(url, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        url = internal_toIriString(url);\r\n        const config = Object.assign(Object.assign({}, internal_defaultFetchOptions), options);\r\n        const response = yield config.fetch(url, {\r\n            headers: {\r\n                Accept: \"text/turtle\",\r\n            },\r\n        });\r\n        if (!response.ok) {\r\n            throw new Error(`Fetching the Resource failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const data = yield response.text();\r\n        const triples = yield turtleToTriples(data, url);\r\n        const resource = dataset();\r\n        triples.forEach((triple) => resource.add(triple));\r\n        const resourceInfo = internal_parseResourceInfo(response);\r\n        const resourceWithResourceInfo = Object.assign(resource, {\r\n            internal_resourceInfo: resourceInfo,\r\n        });\r\n        return resourceWithResourceInfo;\r\n    });\r\n}\r\n/**\r\n * Experimental: fetch a SolidDataset and its associated Access Control List.\r\n *\r\n * This is an experimental function that fetches both a Resource, the linked ACL Resource (if\r\n * available), and the ACL that applies to it if the linked ACL Resource is not available. This can\r\n * result in many HTTP requests being executed, in lieu of the Solid spec mandating servers to\r\n * provide this info in a single request. Therefore, and because this function is still\r\n * experimental, prefer [[getSolidDataset]] instead.\r\n *\r\n * If the Resource does not advertise the ACL Resource (because the authenticated user does not have\r\n * access to it), the `acl` property in the returned value will be null. `acl.resourceAcl` will be\r\n * undefined if the Resource's linked ACL Resource could not be fetched (because it does not exist),\r\n * and `acl.fallbackAcl` will be null if the applicable Container's ACL is not accessible to the\r\n * authenticated user.\r\n *\r\n * @param url URL of the SolidDataset to fetch.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n * @returns A SolidDataset and the ACLs that apply to it, if available to the authenticated user.\r\n */\r\nfunction getSolidDatasetWithAcl(url, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const solidDataset = yield getSolidDataset(url, options);\r\n        const acl = yield internal_fetchAcl(solidDataset, options);\r\n        return Object.assign(solidDataset, { internal_acl: acl });\r\n    });\r\n}\r\n/**\r\n * Given a SolidDataset, store it in a Solid Pod (overwriting the existing data at the given URL).\r\n *\r\n * @param url URL to save `solidDataset` to.\r\n * @param solidDataset The [[SolidDataset]] to save.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n * @returns A Promise resolving to a [[SolidDataset]] containing the stored data, or rejecting if saving it failed.\r\n */\r\nfunction saveSolidDatasetAt(url, solidDataset, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        url = internal_toIriString(url);\r\n        const config = Object.assign(Object.assign({}, internal_defaultFetchOptions), options);\r\n        let requestInit;\r\n        if (isUpdate(solidDataset, url)) {\r\n            const deleteStatement = solidDataset.internal_changeLog.deletions.length > 0\r\n                ? `DELETE DATA {${(yield triplesToTurtle(solidDataset.internal_changeLog.deletions.map(getNamedNodesForLocalNodes))).trim()}};`\r\n                : \"\";\r\n            const insertStatement = solidDataset.internal_changeLog.additions.length > 0\r\n                ? `INSERT DATA {${(yield triplesToTurtle(solidDataset.internal_changeLog.additions.map(getNamedNodesForLocalNodes))).trim()}};`\r\n                : \"\";\r\n            requestInit = {\r\n                method: \"PATCH\",\r\n                body: `${deleteStatement} ${insertStatement}`,\r\n                headers: {\r\n                    \"Content-Type\": \"application/sparql-update\",\r\n                },\r\n            };\r\n        }\r\n        else {\r\n            requestInit = {\r\n                method: \"PUT\",\r\n                body: yield triplesToTurtle(Array.from(solidDataset).map(getNamedNodesForLocalNodes)),\r\n                headers: {\r\n                    \"Content-Type\": \"text/turtle\",\r\n                    \"If-None-Match\": \"*\",\r\n                    Link: '<http://www.w3.org/ns/ldp#Resource>; rel=\"type\"',\r\n                },\r\n            };\r\n        }\r\n        const response = yield config.fetch(url, requestInit);\r\n        if (!response.ok) {\r\n            throw new Error(`Storing the Resource failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const resourceInfo = hasResourceInfo(solidDataset)\r\n            ? Object.assign(Object.assign({}, solidDataset.internal_resourceInfo), { sourceIri: url }) : { sourceIri: url, isRawData: false };\r\n        const storedDataset = Object.assign(solidDataset, {\r\n            internal_changeLog: { additions: [], deletions: [] },\r\n            internal_resourceInfo: resourceInfo,\r\n        });\r\n        const storedDatasetWithResolvedIris = resolveLocalIrisInSolidDataset(storedDataset);\r\n        return storedDatasetWithResolvedIris;\r\n    });\r\n}\r\nfunction isUpdate(solidDataset, url) {\r\n    return (hasChangelog(solidDataset) &&\r\n        hasResourceInfo(solidDataset) &&\r\n        typeof solidDataset.internal_resourceInfo.sourceIri === \"string\" &&\r\n        solidDataset.internal_resourceInfo.sourceIri === url);\r\n}\r\n/**\r\n * Given a SolidDataset, store it in a Solid Pod in a new Resource inside a Container.\r\n *\r\n * @param containerUrl URL of the Container in which to create a new Resource.\r\n * @param solidDataset The [[SolidDataset]] to save to a new Resource in the given Container.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n * @returns A Promise resolving to a [[SolidDataset]] containing the stored data linked to the new Resource, or rejecting if saving it failed.\r\n */\r\nfunction saveSolidDatasetInContainer(containerUrl, solidDataset, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, internal_defaultFetchOptions), options);\r\n        containerUrl = internal_toIriString(containerUrl);\r\n        const rawTurtle = yield triplesToTurtle(Array.from(solidDataset).map(getNamedNodesForLocalNodes));\r\n        const headers = {\r\n            \"Content-Type\": \"text/turtle\",\r\n            Link: '<http://www.w3.org/ns/ldp#Resource>; rel=\"type\"',\r\n        };\r\n        if (options.slugSuggestion) {\r\n            headers.slug = options.slugSuggestion;\r\n        }\r\n        const response = yield config.fetch(containerUrl, {\r\n            method: \"POST\",\r\n            body: rawTurtle,\r\n            headers: headers,\r\n        });\r\n        if (!response.ok) {\r\n            throw new Error(`Storing the Resource in the Container failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const locationHeader = response.headers.get(\"Location\");\r\n        if (locationHeader === null) {\r\n            throw new Error(\"Could not determine the location for the newly saved SolidDataset.\");\r\n        }\r\n        const resourceIri = new URL(locationHeader, new URL(containerUrl).origin)\r\n            .href;\r\n        const resourceInfo = {\r\n            sourceIri: resourceIri,\r\n            isRawData: false,\r\n        };\r\n        const resourceWithResourceInfo = Object.assign(solidDataset, {\r\n            internal_resourceInfo: resourceInfo,\r\n        });\r\n        const resourceWithResolvedIris = resolveLocalIrisInSolidDataset(resourceWithResourceInfo);\r\n        return resourceWithResolvedIris;\r\n    });\r\n}\r\nfunction getNamedNodesForLocalNodes(quad) {\r\n    const subject = isLocalNode(quad.subject)\r\n        ? getNamedNodeFromLocalNode(quad.subject)\r\n        : quad.subject;\r\n    const object = isLocalNode(quad.object)\r\n        ? getNamedNodeFromLocalNode(quad.object)\r\n        : quad.object;\r\n    return Object.assign(Object.assign({}, quad), { subject: subject, object: object });\r\n}\r\nfunction getNamedNodeFromLocalNode(localNode) {\r\n    return DataFactory.namedNode(\"#\" + localNode.internal_name);\r\n}\r\nfunction resolveLocalIrisInSolidDataset(solidDataset) {\r\n    const resourceIri = getSourceUrl(solidDataset);\r\n    const unresolvedQuads = Array.from(solidDataset);\r\n    unresolvedQuads.forEach((unresolvedQuad) => {\r\n        const resolvedQuad = resolveIriForLocalNodes(unresolvedQuad, resourceIri);\r\n        solidDataset.delete(unresolvedQuad);\r\n        solidDataset.add(resolvedQuad);\r\n    });\r\n    return solidDataset;\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Extract Quads with a given Subject from a [[SolidDataset]] into a [[Thing]].\r\n *\r\n * @param solidDataset The [[SolidDataset]] to extract the [[Thing]] from.\r\n * @param thingUrl The URL of the desired [[Thing]].\r\n * @param options Not yet implemented.\r\n */\r\nfunction getThing(solidDataset, thingUrl, options = {}) {\r\n    const subject = isLocalNode(thingUrl) ? thingUrl : asNamedNode(thingUrl);\r\n    const scope = options.scope\r\n        ? asNamedNode(options.scope)\r\n        : null;\r\n    const thingDataset = solidDataset.match(subject, null, null, scope);\r\n    if (isLocalNode(subject)) {\r\n        const thing = Object.assign(thingDataset, {\r\n            internal_localSubject: subject,\r\n        });\r\n        return thing;\r\n    }\r\n    else {\r\n        const thing = Object.assign(thingDataset, {\r\n            internal_url: subject.value,\r\n        });\r\n        return thing;\r\n    }\r\n}\r\n/**\r\n * Get all [[Thing]]s about which a [[SolidDataset]] contains Quads.\r\n *\r\n * @param solidDataset The [[SolidDataset]] to extract the [[Thing]]s from.\r\n * @param options Not yet implemented.\r\n */\r\nfunction getThingAll(solidDataset, options = {}) {\r\n    const subjectNodes = new Array();\r\n    for (const quad of solidDataset) {\r\n        // Because NamedNode objects with the same IRI are actually different\r\n        // object instances, we have to manually check whether `subjectNodes` does\r\n        // not yet include `quadSubject` before adding it.\r\n        const quadSubject = quad.subject;\r\n        if (isNamedNode(quadSubject) &&\r\n            !subjectNodes.some((subjectNode) => isEqual(subjectNode, quadSubject))) {\r\n            subjectNodes.push(quadSubject);\r\n        }\r\n        if (isLocalNode(quadSubject) &&\r\n            !subjectNodes.some((subjectNode) => isEqual(subjectNode, quadSubject))) {\r\n            subjectNodes.push(quadSubject);\r\n        }\r\n    }\r\n    const things = subjectNodes.map((subjectNode) => getThing(solidDataset, subjectNode, options));\r\n    return things;\r\n}\r\n/**\r\n * Insert a [[Thing]] into a [[SolidDataset]], replacing previous instances of that Thing.\r\n *\r\n * @param solidDataset The SolidDataset to insert a Thing into.\r\n * @param thing The Thing to insert into the given SolidDataset.\r\n * @returns A new SolidDataset equal to the given SolidDataset, but with the given Thing.\r\n */\r\nfunction setThing(solidDataset, thing) {\r\n    const newDataset = removeThing(solidDataset, thing);\r\n    for (const quad of thing) {\r\n        newDataset.add(quad);\r\n        if (newDataset.internal_changeLog.deletions.includes(quad)) {\r\n            newDataset.internal_changeLog.deletions = newDataset.internal_changeLog.deletions.filter((deletion) => deletion !== quad);\r\n        }\r\n        else {\r\n            newDataset.internal_changeLog.additions.push(quad);\r\n        }\r\n    }\r\n    return newDataset;\r\n}\r\n/**\r\n * Remove a Thing from a SolidDataset.\r\n *\r\n * @param solidDataset The SolidDataset to remove a Thing from.\r\n * @param thing The Thing to remove from `solidDataset`.\r\n * @returns A new [[SolidDataset]] equal to the input SolidDataset, excluding the given Thing.\r\n */\r\nfunction removeThing(solidDataset, thing) {\r\n    const newSolidDataset = withChangeLog(cloneLitStructs(solidDataset));\r\n    const resourceIri = hasResourceInfo(newSolidDataset)\r\n        ? getSourceUrl(newSolidDataset)\r\n        : undefined;\r\n    const thingSubject = toNode(thing);\r\n    // Copy every Quad from the input dataset into what is to be the output dataset,\r\n    // unless its Subject is the same as that of the Thing that is to be removed:\r\n    for (const quad of solidDataset) {\r\n        if (!isNamedNode(quad.subject) && !isLocalNode(quad.subject)) {\r\n            // This data is unexpected, and hence unlikely to be added by us. Thus, leave it intact:\r\n            newSolidDataset.add(quad);\r\n        }\r\n        else if (!isEqual(thingSubject, quad.subject, { resourceIri: resourceIri })) {\r\n            newSolidDataset.add(quad);\r\n        }\r\n        else if (newSolidDataset.internal_changeLog.additions.includes(quad)) {\r\n            // If this Quad was added to the SolidDataset since it was fetched from the Pod,\r\n            // remove it from the additions rather than adding it to the deletions,\r\n            // to avoid asking the Pod to remove a Quad that does not exist there:\r\n            newSolidDataset.internal_changeLog.additions = newSolidDataset.internal_changeLog.additions.filter((addition) => addition != quad);\r\n        }\r\n        else {\r\n            newSolidDataset.internal_changeLog.deletions.push(quad);\r\n        }\r\n    }\r\n    return newSolidDataset;\r\n}\r\nfunction withChangeLog(solidDataset) {\r\n    const newSolidDataset = hasChangelog(solidDataset)\r\n        ? solidDataset\r\n        : Object.assign(solidDataset, {\r\n            internal_changeLog: { additions: [], deletions: [] },\r\n        });\r\n    return newSolidDataset;\r\n}\r\nfunction cloneLitStructs(solidDataset) {\r\n    const freshDataset = dataset();\r\n    if (hasChangelog(solidDataset)) {\r\n        freshDataset.internal_changeLog = {\r\n            additions: [...solidDataset.internal_changeLog.additions],\r\n            deletions: [...solidDataset.internal_changeLog.deletions],\r\n        };\r\n    }\r\n    if (hasResourceInfo(solidDataset)) {\r\n        freshDataset.internal_resourceInfo = Object.assign({}, solidDataset.internal_resourceInfo);\r\n    }\r\n    if (hasAcl(solidDataset)) {\r\n        freshDataset.internal_acl = Object.assign({}, solidDataset.internal_acl);\r\n    }\r\n    if (internal_isAclDataset(solidDataset)) {\r\n        freshDataset.internal_accessTo =\r\n            solidDataset.internal_accessTo;\r\n    }\r\n    return freshDataset;\r\n}\r\nfunction createThing(options = {}) {\r\n    var _a;\r\n    if (typeof options.url !== \"undefined\") {\r\n        const url = options.url;\r\n        /* istanbul ignore else [URL is defined is the testing environment, so we cannot test this] */\r\n        if (typeof URL !== \"undefined\") {\r\n            // Throws an error if the IRI is invalid:\r\n            new URL(url);\r\n        }\r\n        const thing = Object.assign(dataset(), {\r\n            internal_url: url,\r\n        });\r\n        return thing;\r\n    }\r\n    const name = (_a = options.name) !== null && _a !== void 0 ? _a : generateName();\r\n    const localSubject = getLocalNode(name);\r\n    const thing = Object.assign(dataset(), {\r\n        internal_localSubject: localSubject,\r\n    });\r\n    return thing;\r\n}\r\nfunction asUrl(thing, baseUrl) {\r\n    if (isThingLocal(thing)) {\r\n        if (typeof baseUrl === \"undefined\") {\r\n            throw new Error(\"The URL of a Thing that has not been persisted cannot be determined without a base URL.\");\r\n        }\r\n        return resolveLocalIri(thing.internal_localSubject.internal_name, baseUrl);\r\n    }\r\n    return thing.internal_url;\r\n}\r\n/** @hidden Alias of [[asUrl]] for those who prefer IRI terminology. */\r\nconst asIri = asUrl;\r\n/**\r\n * @param thing The [[Thing]] of which a URL might or might not be known.\r\n * @return Whether `thing` has no known URL yet.\r\n */\r\nfunction isThingLocal(thing) {\r\n    var _a;\r\n    return (typeof ((_a = thing.internal_localSubject) === null || _a === void 0 ? void 0 : _a.internal_name) ===\r\n        \"string\" && typeof thing.internal_url === \"undefined\");\r\n}\r\nfunction toNode(thing) {\r\n    if (isNamedNode(thing) || isLocalNode(thing)) {\r\n        return thing;\r\n    }\r\n    if (typeof thing === \"string\") {\r\n        return asNamedNode(thing);\r\n    }\r\n    if (isThingLocal(thing)) {\r\n        return thing.internal_localSubject;\r\n    }\r\n    return asNamedNode(asUrl(thing));\r\n}\r\nfunction cloneThing(thing) {\r\n    const cloned = clone(thing);\r\n    if (isThingLocal(thing)) {\r\n        cloned.internal_localSubject = thing.internal_localSubject;\r\n        return cloned;\r\n    }\r\n    cloned.internal_url = thing.internal_url;\r\n    return cloned;\r\n}\r\nfunction filterThing(thing, callback) {\r\n    const filtered = filter(thing, callback);\r\n    if (isThingLocal(thing)) {\r\n        filtered.internal_localSubject =\r\n            thing.internal_localSubject;\r\n        return filtered;\r\n    }\r\n    filtered.internal_url = thing.internal_url;\r\n    return filtered;\r\n}\r\n/**\r\n * Generate a string that can be used as the unique identifier for a Thing\r\n *\r\n * This function works by starting with a date string (so that Things can be\r\n * sorted chronologically), followed by a random number generated by taking a\r\n * random number between 0 and 1, and cutting off the `0.`.\r\n *\r\n * @internal\r\n * @returns An string that's likely to be unique\r\n */\r\nconst generateName = () => {\r\n    return (Date.now().toString() + Math.random().toString().substring(\"0.\".length));\r\n};\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * @param thing The [[Thing]] to read a URL value from.\r\n * @param property The given Property for which you want the URL value.\r\n * @returns A URL value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getUrl(thing, property) {\r\n    const namedNodeMatcher = getNamedNodeMatcher(property);\r\n    const matchingQuad = findOne(thing, namedNodeMatcher);\r\n    if (matchingQuad === null) {\r\n        return null;\r\n    }\r\n    return matchingQuad.object.value;\r\n}\r\n/** @hidden Alias of [[getUrl]] for those who prefer IRI terminology. */\r\nconst getIri = getUrl;\r\n/**\r\n * @param thing The [[Thing]] to read the URL values from.\r\n * @param property The given Property for which you want the URL values.\r\n * @returns The URL values for the given Property.\r\n */\r\nfunction getUrlAll(thing, property) {\r\n    const iriMatcher = getNamedNodeMatcher(property);\r\n    const matchingQuads = findAll(thing, iriMatcher);\r\n    return matchingQuads.map((quad) => quad.object.value);\r\n}\r\n/** @hidden Alias of [[getUrlAll]] for those who prefer IRI terminology. */\r\nconst getIriAll = getUrlAll;\r\n/**\r\n * @param thing The [[Thing]] to read a boolean value from.\r\n * @param property The given Property for which you want the boolean value.\r\n * @returns A boolean value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getBoolean(thing, property) {\r\n    const literalString = getLiteralOfType(thing, property, xmlSchemaTypes.boolean);\r\n    if (literalString === null) {\r\n        return null;\r\n    }\r\n    return deserializeBoolean(literalString);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the boolean values from.\r\n * @param property The given Property for which you want the boolean values.\r\n * @returns The boolean values for the given Property.\r\n */\r\nfunction getBooleanAll(thing, property) {\r\n    const literalStrings = getLiteralAllOfType(thing, property, xmlSchemaTypes.boolean);\r\n    return literalStrings\r\n        .map(deserializeBoolean)\r\n        .filter((possibleBoolean) => possibleBoolean !== null);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a datetime value from.\r\n * @param property The given Property for which you want the datetime value.\r\n * @returns A datetime value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getDatetime(thing, property) {\r\n    const literalString = getLiteralOfType(thing, property, xmlSchemaTypes.dateTime);\r\n    if (literalString === null) {\r\n        return null;\r\n    }\r\n    return deserializeDatetime(literalString);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the datetime values from.\r\n * @param property The given Property for which you want the datetime values.\r\n * @returns The datetime values for the given Property.\r\n */\r\nfunction getDatetimeAll(thing, property) {\r\n    const literalStrings = getLiteralAllOfType(thing, property, xmlSchemaTypes.dateTime);\r\n    return literalStrings\r\n        .map(deserializeDatetime)\r\n        .filter((potentialDatetime) => potentialDatetime !== null);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a decimal value from.\r\n * @param property The given Property for which you want the decimal value.\r\n * @returns A decimal value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getDecimal(thing, property) {\r\n    const literalString = getLiteralOfType(thing, property, xmlSchemaTypes.decimal);\r\n    if (literalString === null) {\r\n        return null;\r\n    }\r\n    return deserializeDecimal(literalString);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the decimal values from.\r\n * @param property The given Property for which you want the decimal values.\r\n * @returns The decimal values for the given Property.\r\n */\r\nfunction getDecimalAll(thing, property) {\r\n    const literalStrings = getLiteralAllOfType(thing, property, xmlSchemaTypes.decimal);\r\n    return literalStrings\r\n        .map((literalString) => deserializeDecimal(literalString))\r\n        .filter((potentialDecimal) => potentialDecimal !== null);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read an integer value from.\r\n * @param property The given Property for which you want the integer value.\r\n * @returns An integer value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getInteger(thing, property) {\r\n    const literalString = getLiteralOfType(thing, property, xmlSchemaTypes.integer);\r\n    if (literalString === null) {\r\n        return null;\r\n    }\r\n    return deserializeInteger(literalString);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the integer values from.\r\n * @param property The given Property for which you want the integer values.\r\n * @returns The integer values for the given Property.\r\n */\r\nfunction getIntegerAll(thing, property) {\r\n    const literalStrings = getLiteralAllOfType(thing, property, xmlSchemaTypes.integer);\r\n    return literalStrings\r\n        .map((literalString) => deserializeInteger(literalString))\r\n        .filter((potentialInteger) => potentialInteger !== null);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a localised string value from.\r\n * @param property The given Property for which you want the localised string value.\r\n * @param locale The desired locale for the string value.\r\n * @returns A localised string value for the given Property, if present in `locale`, or null otherwise.\r\n */\r\nfunction getStringWithLocale(thing, property, locale) {\r\n    const localeStringMatcher = getLocaleStringMatcher(property, locale);\r\n    const matchingQuad = findOne(thing, localeStringMatcher);\r\n    if (matchingQuad === null) {\r\n        return null;\r\n    }\r\n    return matchingQuad.object.value;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the localised string values from.\r\n * @param property The given Property for which you want the localised string values.\r\n * @param locale The desired locale for the string values.\r\n * @returns The localised string values for the given Property.\r\n */\r\nfunction getStringWithLocaleAll(thing, property, locale) {\r\n    const localeStringMatcher = getLocaleStringMatcher(property, locale);\r\n    const matchingQuads = findAll(thing, localeStringMatcher);\r\n    return matchingQuads.map((quad) => quad.object.value);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a string value from.\r\n * @param property The given Property for which you want the string value.\r\n * @returns A string value for the given Property, if present, or null otherwise.\r\n */\r\nfunction getStringNoLocale(thing, property) {\r\n    const literalString = getLiteralOfType(thing, property, xmlSchemaTypes.string);\r\n    return literalString;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the string values from.\r\n * @param property The given Property for which you want the string values.\r\n * @returns The string values for the given Property.\r\n */\r\nfunction getStringNoLocaleAll(thing, property) {\r\n    const literalStrings = getLiteralAllOfType(thing, property, xmlSchemaTypes.string);\r\n    return literalStrings;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a NamedNode value from.\r\n * @param property The given Property for which you want the NamedNode value.\r\n * @returns A NamedNode value for the given Property, if present, or null otherwise.\r\n * @ignore This should not be needed due to the other get*() functions. If you do find yourself needing it, please file a feature request for your use case.\r\n */\r\nfunction getNamedNode(thing, property) {\r\n    const namedNodeMatcher = getNamedNodeMatcher(property);\r\n    const matchingQuad = findOne(thing, namedNodeMatcher);\r\n    if (matchingQuad === null) {\r\n        return null;\r\n    }\r\n    return matchingQuad.object;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the NamedNode values from.\r\n * @param property The given Property for which you want the NamedNode values.\r\n * @returns The NamedNode values for the given Property.\r\n * @ignore This should not be needed due to the other get*() functions. If you do find yourself needing it, please file a feature request for your use case.\r\n */\r\nfunction getNamedNodeAll(thing, property) {\r\n    const namedNodeMatcher = getNamedNodeMatcher(property);\r\n    const matchingQuads = findAll(thing, namedNodeMatcher);\r\n    return matchingQuads.map((quad) => quad.object);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read a Literal value from.\r\n * @param property The given Property for which you want the Literal value.\r\n * @returns A Literal value for the given Property, if present, or null otherwise.\r\n * @ignore This should not be needed due to the other get*() functions. If you do find yourself needing it, please file a feature request for your use case.\r\n */\r\nfunction getLiteral(thing, property) {\r\n    const literalMatcher = getLiteralMatcher(property);\r\n    const matchingQuad = findOne(thing, literalMatcher);\r\n    if (matchingQuad === null) {\r\n        return null;\r\n    }\r\n    return matchingQuad.object;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to read the Literal values from.\r\n * @param property The given Property for which you want the Literal values.\r\n * @returns The Literal values for the given Property.\r\n * @ignore This should not be needed due to the other get*All() functions. If you do find yourself needing it, please file a feature request for your use case.\r\n */\r\nfunction getLiteralAll(thing, property) {\r\n    const literalMatcher = getLiteralMatcher(property);\r\n    const matchingQuads = findAll(thing, literalMatcher);\r\n    return matchingQuads.map((quad) => quad.object);\r\n}\r\n/**\r\n * @param thing The [[Thing]] to extract a Quad from.\r\n * @param matcher Callback function that returns a boolean indicating whether a given Quad should be included.\r\n * @returns First Quad in `thing` for which `matcher` returned true.\r\n */\r\nfunction findOne(thing, matcher) {\r\n    for (const quad of thing) {\r\n        if (matcher(quad)) {\r\n            return quad;\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * @param thing The [[Thing]] to extract Quads from.\r\n * @param matcher Callback function that returns a boolean indicating whether a given Quad should be included.\r\n * @returns All Quads in `thing` for which `matcher` returned true.\r\n */\r\nfunction findAll(thing, matcher) {\r\n    const matched = [];\r\n    for (const quad of thing) {\r\n        if (matcher(quad)) {\r\n            matched.push(quad);\r\n        }\r\n    }\r\n    return matched;\r\n}\r\nfunction getNamedNodeMatcher(property) {\r\n    const predicateNode = asNamedNode(property);\r\n    const matcher = function matcher(quad) {\r\n        return predicateNode.equals(quad.predicate) && isNamedNode(quad.object);\r\n    };\r\n    return matcher;\r\n}\r\nfunction getLiteralMatcher(property) {\r\n    const predicateNode = asNamedNode(property);\r\n    const matcher = function matcher(quad) {\r\n        return predicateNode.equals(quad.predicate) && isLiteral(quad.object);\r\n    };\r\n    return matcher;\r\n}\r\nfunction getLiteralOfTypeMatcher(property, datatype) {\r\n    const predicateNode = asNamedNode(property);\r\n    const matcher = function matcher(quad) {\r\n        return (predicateNode.equals(quad.predicate) &&\r\n            isLiteral(quad.object) &&\r\n            quad.object.datatype.value === datatype);\r\n    };\r\n    return matcher;\r\n}\r\nfunction getLocaleStringMatcher(property, locale) {\r\n    const predicateNode = asNamedNode(property);\r\n    const matcher = function matcher(quad) {\r\n        return (predicateNode.equals(quad.predicate) &&\r\n            isLiteral(quad.object) &&\r\n            quad.object.datatype.value === xmlSchemaTypes.langString &&\r\n            quad.object.language.toLowerCase() === locale.toLowerCase());\r\n    };\r\n    return matcher;\r\n}\r\n/**\r\n * @param thing The [Thing]] to read a Literal of the given type from.\r\n * @param property The given Property for which you want the Literal value.\r\n * @param literalType Set type of the Literal data.\r\n * @returns The stringified value for the given Property and type, if present, or null otherwise.\r\n */\r\nfunction getLiteralOfType(thing, property, literalType) {\r\n    const literalOfTypeMatcher = getLiteralOfTypeMatcher(property, literalType);\r\n    const matchingQuad = findOne(thing, literalOfTypeMatcher);\r\n    if (matchingQuad === null) {\r\n        return null;\r\n    }\r\n    return matchingQuad.object.value;\r\n}\r\n/**\r\n * @param thing The [Thing]] to read the Literals of the given type from.\r\n * @param property The given Property for which you want the Literal values.\r\n * @param literalType Set type of the Literal data.\r\n * @returns The stringified values for the given Property and type.\r\n */\r\nfunction getLiteralAllOfType(thing, property, literalType) {\r\n    const literalOfTypeMatcher = getLiteralOfTypeMatcher(property, literalType);\r\n    const matchingQuads = findAll(thing, literalOfTypeMatcher);\r\n    return matchingQuads.map((quad) => quad.object.value);\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nfunction removeAll(thing, property) {\r\n    const predicateNode = asNamedNode(property);\r\n    const updatedThing = filterThing(thing, (quad) => !quad.predicate.equals(predicateNode));\r\n    return updatedThing;\r\n}\r\n/**\r\n * Create a new Thing with the given URL removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove a URL value from.\r\n * @param property Property for which to remove the given URL value.\r\n * @param value URL to remove from `thing` for the given `Property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeUrl = (thing, property, value) => {\r\n    const predicateNode = asNamedNode(property);\r\n    const iriNode = isNamedNode(value)\r\n        ? value\r\n        : typeof value === \"string\"\r\n            ? asNamedNode(value)\r\n            : asNamedNode(asIri(value));\r\n    const updatedThing = filterThing(thing, (quad) => {\r\n        return (!quad.predicate.equals(predicateNode) ||\r\n            !isNamedNode(quad.object) ||\r\n            !quad.object.equals(iriNode));\r\n    });\r\n    return updatedThing;\r\n};\r\n/** @hidden Alias of [[removeUrl]] for those who prefer IRI terminology. */\r\nconst removeIri = removeUrl;\r\n/**\r\n * Create a new Thing with the given boolean removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove a boolean value from.\r\n * @param property Property for which to remove the given boolean value.\r\n * @param value Boolean to remove from `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeBoolean = (thing, property, value) => {\r\n    return removeLiteralOfType(thing, property, serializeBoolean(value), xmlSchemaTypes.boolean);\r\n};\r\n/**\r\n * Create a new Thing with the given datetime removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove a datetime value from.\r\n * @param property Property for which to remove the given datetime value.\r\n * @param value Datetime to remove from `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeDatetime = (thing, property, value) => {\r\n    return removeLiteralOfType(thing, property, serializeDatetime(value), xmlSchemaTypes.dateTime);\r\n};\r\n/**\r\n * Create a new Thing with the given decimal removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove a decimal value from.\r\n * @param property Property for which to remove the given decimal value.\r\n * @param value Decimal to remove from `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeDecimal = (thing, property, value) => {\r\n    return removeLiteralOfType(thing, property, serializeDecimal(value), xmlSchemaTypes.decimal);\r\n};\r\n/**\r\n * Create a new Thing with the given integer removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove an integer value from.\r\n * @param property Property for which to remove the given integer value.\r\n * @param value Integer to remove from `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeInteger = (thing, property, value) => {\r\n    return removeLiteralOfType(thing, property, serializeInteger(value), xmlSchemaTypes.integer);\r\n};\r\nfunction removeStringWithLocale(thing, property, value, locale) {\r\n    // Note: Due to how the `DataFactory.literal` constructor behaves, this function\r\n    // must call directly `removeLiteral` directly, with the locale as the data\r\n    // type of the Literal (which is not a valid NamedNode).\r\n    return removeLiteral(thing, property, DataFactory.literal(value, normalizeLocale(locale)));\r\n}\r\n/**\r\n * Create a new Thing with the given unlocalised string removed for the given Property.\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to remove an unlocalised string value from.\r\n * @param property Property for which to remove the given string value.\r\n * @param value String to remove from `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value removed for the given Property.\r\n */\r\nconst removeStringNoLocale = (thing, property, value) => {\r\n    return removeLiteralOfType(thing, property, value, xmlSchemaTypes.string);\r\n};\r\nfunction removeNamedNode(thing, property, value) {\r\n    const predicateNode = asNamedNode(property);\r\n    const updatedThing = filterThing(thing, (quad) => {\r\n        return (!quad.predicate.equals(predicateNode) ||\r\n            !isNamedNode(quad.object) ||\r\n            !quad.object.equals(value));\r\n    });\r\n    return updatedThing;\r\n}\r\nfunction removeLiteral(thing, property, value) {\r\n    const predicateNode = asNamedNode(property);\r\n    const updatedThing = filterThing(thing, (quad) => {\r\n        return (!quad.predicate.equals(predicateNode) ||\r\n            !isLiteral(quad.object) ||\r\n            !quad.object.equals(value));\r\n    });\r\n    return updatedThing;\r\n}\r\nfunction removeLiteralOfType(thing, property, value, type) {\r\n    const updatedThing = removeLiteral(thing, property, DataFactory.literal(value, DataFactory.namedNode(type)));\r\n    return updatedThing;\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Create a new Thing with existing values replaced by the given URL for the given Property.\r\n *\r\n * To preserve existing values, see [[addUrl]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set a URL value on.\r\n * @param property Property for which to set the given URL value.\r\n * @param url URL to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setUrl = (thing, property, url) => {\r\n    const newThing = removeAll(thing, property);\r\n    const predicateNode = asNamedNode(property);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, toNode(url)));\r\n    return newThing;\r\n};\r\n/** @hidden Alias of [[setUrl]] for those who prefer IRI terminology. */\r\nconst setIri = setUrl;\r\n/**\r\n * Create a new Thing with existing values replaced by the given boolean for the given Property.\r\n *\r\n * To preserve existing values, see [[addBoolean]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set a boolean value on.\r\n * @param property Property for which to set the given boolean value.\r\n * @param value Boolean to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setBoolean = (thing, property, value) => {\r\n    return setLiteralOfType(thing, property, serializeBoolean(value), xmlSchemaTypes.boolean);\r\n};\r\n/**\r\n * Create a new Thing with existing values replaced by the given datetime for the given Property.\r\n *\r\n * To preserve existing values, see [[addDatetime]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set an datetime value on.\r\n * @param property Property for which to set the given datetime value.\r\n * @param value Datetime to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setDatetime = (thing, property, value) => {\r\n    return setLiteralOfType(thing, property, serializeDatetime(value), xmlSchemaTypes.dateTime);\r\n};\r\n/**\r\n * Create a new Thing with existing values replaced by the given decimal for the given Property.\r\n *\r\n * To preserve existing values, see [[addDecimal]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set a decimal value on.\r\n * @param property Property for which to set the given decimal value.\r\n * @param value Decimal to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setDecimal = (thing, property, value) => {\r\n    return setLiteralOfType(thing, property, serializeDecimal(value), xmlSchemaTypes.decimal);\r\n};\r\n/**\r\n * Create a new Thing with existing values replaced by the given integer for the given Property.\r\n *\r\n * To preserve existing values, see [[addInteger]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set an integer value on.\r\n * @param property Property for which to set the given integer value.\r\n * @param value Integer to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setInteger = (thing, property, value) => {\r\n    return setLiteralOfType(thing, property, serializeInteger(value), xmlSchemaTypes.integer);\r\n};\r\nfunction setStringWithLocale(thing, property, value, locale) {\r\n    const literal = DataFactory.literal(value, normalizeLocale(locale));\r\n    return setLiteral(thing, property, literal);\r\n}\r\n/**\r\n * Create a new Thing with existing values replaced by the given unlocalised string for the given Property.\r\n *\r\n * To preserve existing values, see [[addStringNoLocale]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to set an unlocalised string value on.\r\n * @param property Property for which to set the given unlocalised string value.\r\n * @param value Unlocalised string to set on `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with existing values replaced by the given value for the given Property.\r\n */\r\nconst setStringNoLocale = (thing, property, value) => {\r\n    return setLiteralOfType(thing, property, value, xmlSchemaTypes.string);\r\n};\r\nfunction setNamedNode(thing, property, value) {\r\n    const newThing = removeAll(thing, property);\r\n    const predicateNode = asNamedNode(property);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, value));\r\n    return newThing;\r\n}\r\nfunction setLiteral(thing, property, value) {\r\n    const newThing = removeAll(thing, property);\r\n    const predicateNode = asNamedNode(property);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, value));\r\n    return newThing;\r\n}\r\nfunction setLiteralOfType(thing, property, value, type) {\r\n    const literal = DataFactory.literal(value, type);\r\n    return setLiteral(thing, property, literal);\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/** @internal */\r\nfunction internal_fetchResourceAcl(dataset, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!hasAccessibleAcl(dataset)) {\r\n            return null;\r\n        }\r\n        try {\r\n            const aclSolidDataset = yield getSolidDataset(dataset.internal_resourceInfo.aclUrl, options);\r\n            return Object.assign(aclSolidDataset, {\r\n                internal_accessTo: getSourceUrl(dataset),\r\n            });\r\n        }\r\n        catch (e) {\r\n            // Since a Solid server adds a `Link` header to an ACL even if that ACL does not exist,\r\n            // failure to fetch the ACL is expected to happen - we just return `null` and let callers deal\r\n            // with it.\r\n            return null;\r\n        }\r\n    });\r\n}\r\n/** @internal */\r\nfunction internal_fetchFallbackAcl(resource, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const resourceUrl = new URL(getSourceUrl(resource));\r\n        const resourcePath = resourceUrl.pathname;\r\n        // Note: we're currently assuming that the Origin is the root of the Pod. However, it is not yet\r\n        //       set in stone that that will always be the case. We might need to check the Container's\r\n        //       metadata at some point in time to check whether it is actually the root of the Pod.\r\n        //       See: https://github.com/solid/specification/issues/153#issuecomment-624630022\r\n        if (resourcePath === \"/\") {\r\n            // We're already at the root, so there's no Container we can retrieve:\r\n            return null;\r\n        }\r\n        const containerPath = getContainerPath(resourcePath);\r\n        const containerIri = new URL(containerPath, resourceUrl.origin).href;\r\n        const containerInfo = {\r\n            internal_resourceInfo: yield internal_fetchResourceInfo(containerIri, options),\r\n        };\r\n        if (!hasAccessibleAcl(containerInfo)) {\r\n            // If the current user does not have access to this Container's ACL,\r\n            // we cannot determine whether its ACL is the one that applies. Thus, return null:\r\n            return null;\r\n        }\r\n        const containerAcl = yield internal_fetchResourceAcl(containerInfo, options);\r\n        if (containerAcl === null) {\r\n            return internal_fetchFallbackAcl(containerInfo, options);\r\n        }\r\n        return containerAcl;\r\n    });\r\n}\r\nfunction getContainerPath(resourcePath) {\r\n    const resourcePathWithoutTrailingSlash = resourcePath.substring(resourcePath.length - 1) === \"/\"\r\n        ? resourcePath.substring(0, resourcePath.length - 1)\r\n        : resourcePath;\r\n    const containerPath = resourcePath.substring(0, resourcePathWithoutTrailingSlash.lastIndexOf(\"/\")) + \"/\";\r\n    return containerPath;\r\n}\r\n/**\r\n * Verify whether an ACL was found for the given Resource.\r\n *\r\n * A Resource fetched with its ACL (e.g. using [[getSolidDatasetWithAcl]]) _might_ have a resource ACL attached, but\r\n * we cannot be sure: it might be that none exists for this specific Resource (in which case the\r\n * fallback ACL applies), or the currently authenticated user (if any) might not have Control access\r\n * to the fetched Resource.\r\n *\r\n * This function verifies that the Resource's ACL is accessible.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param resource A Resource that might have an ACL attached.\r\n * @returns Whether `dataset` has an ACL attached.\r\n */\r\nfunction hasResourceAcl(resource) {\r\n    return (resource.internal_acl.resourceAcl !== null &&\r\n        getSourceUrl(resource) ===\r\n            resource.internal_acl.resourceAcl.internal_accessTo &&\r\n        resource.internal_resourceInfo.aclUrl ===\r\n            getSourceUrl(resource.internal_acl.resourceAcl));\r\n}\r\nfunction getResourceAcl(resource) {\r\n    if (!hasResourceAcl(resource)) {\r\n        return null;\r\n    }\r\n    return resource.internal_acl.resourceAcl;\r\n}\r\n/**\r\n * Verify whether a fallback ACL was found for the given Resource.\r\n *\r\n * A Resource fetched with its ACL (e.g. using [[getSolidDatasetWithAcl]]) _might_ have a fallback ACL\r\n * attached, but we cannot be sure: the currently authenticated user (if any) might not have Control\r\n * access to one of the fetched Resource's Containers.\r\n *\r\n * This function verifies that the fallback ACL is accessible.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param resource A [[SolidDataset]] that might have a fallback ACL attached.\r\n * @returns Whether `dataset` has a fallback ACL attached.\r\n */\r\nfunction hasFallbackAcl(resource) {\r\n    return resource.internal_acl.fallbackAcl !== null;\r\n}\r\nfunction getFallbackAcl(dataset) {\r\n    if (!hasFallbackAcl(dataset)) {\r\n        return null;\r\n    }\r\n    return dataset.internal_acl.fallbackAcl;\r\n}\r\n/**\r\n * Initialise an empty Resource ACL for a given Resource.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param targetResource A Resource that does not have its own ACL yet (see [[hasResourceAcl]]).\r\n * @returns A Resource ACL for the given Resource, with no ACL Rules defined yet.\r\n */\r\nfunction createAcl(targetResource) {\r\n    const emptyResourceAcl = Object.assign(dataset(), {\r\n        internal_accessTo: getSourceUrl(targetResource),\r\n        internal_resourceInfo: {\r\n            sourceIri: targetResource.internal_resourceInfo.aclUrl,\r\n            isRawData: false,\r\n        },\r\n    });\r\n    return emptyResourceAcl;\r\n}\r\n/**\r\n * Create a Resource ACL for a given Resource, setting the same access permissions that currently apply to it from its Container.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param resource A Resource that does not have its own ACL (see [[hasResourceAcl]]) and a known fallback ACL (see [[hasFallbackAcl]]).\r\n * @returns A Resource ACL for the given Resource, with the default ACL Rules from the fallback ACL applied as Resource Rules.\r\n */\r\nfunction createAclFromFallbackAcl(resource) {\r\n    const emptyResourceAcl = createAcl(resource);\r\n    const fallbackAclRules = internal_getAclRules(resource.internal_acl.fallbackAcl);\r\n    const defaultAclRules = internal_getDefaultAclRulesForResource(fallbackAclRules, resource.internal_acl.fallbackAcl.internal_accessTo);\r\n    const resourceAclRules = defaultAclRules.map((rule) => {\r\n        rule = removeAll(rule, acl.default);\r\n        rule = setIri(rule, acl.accessTo, getSourceUrl(resource));\r\n        return rule;\r\n    });\r\n    // Iterate over every ACL Rule we want to import, inserting them into `emptyResourceAcl` one by one:\r\n    const initialisedResourceAcl = resourceAclRules.reduce(setThing, emptyResourceAcl);\r\n    return initialisedResourceAcl;\r\n}\r\n/** @internal */\r\nfunction internal_isAclDataset(dataset) {\r\n    return typeof dataset.internal_accessTo === \"string\";\r\n}\r\n/** @internal */\r\nfunction internal_getAclRules(aclDataset) {\r\n    const things = getThingAll(aclDataset);\r\n    return things.filter(isAclRule);\r\n}\r\nfunction isAclRule(thing) {\r\n    return getIriAll(thing, rdf.type).includes(acl.Authorization);\r\n}\r\n/** @internal */\r\nfunction internal_getResourceAclRulesForResource(aclRules, resource) {\r\n    return aclRules.filter((rule) => appliesToResource(rule, resource));\r\n}\r\nfunction appliesToResource(aclRule, resource) {\r\n    return getIriAll(aclRule, acl.accessTo).includes(resource);\r\n}\r\n/** @internal */\r\nfunction internal_getDefaultAclRulesForResource(aclRules, resource) {\r\n    return aclRules.filter((rule) => isDefaultForResource(rule, resource));\r\n}\r\nfunction isDefaultForResource(aclRule, resource) {\r\n    return getIriAll(aclRule, acl.default).includes(resource);\r\n}\r\n/** @internal */\r\nfunction internal_getAccess(rule) {\r\n    const ruleAccessModes = getIriAll(rule, acl.mode);\r\n    const writeAccess = ruleAccessModes.includes(internal_accessModeIriStrings.write);\r\n    return writeAccess\r\n        ? {\r\n            read: ruleAccessModes.includes(internal_accessModeIriStrings.read),\r\n            append: true,\r\n            write: true,\r\n            control: ruleAccessModes.includes(internal_accessModeIriStrings.control),\r\n        }\r\n        : {\r\n            read: ruleAccessModes.includes(internal_accessModeIriStrings.read),\r\n            append: ruleAccessModes.includes(internal_accessModeIriStrings.append),\r\n            write: false,\r\n            control: ruleAccessModes.includes(internal_accessModeIriStrings.control),\r\n        };\r\n}\r\n/** @internal */\r\nfunction internal_combineAccessModes(modes) {\r\n    return modes.reduce((accumulator, current) => {\r\n        const writeAccess = accumulator.write || current.write;\r\n        return writeAccess\r\n            ? {\r\n                read: accumulator.read || current.read,\r\n                append: true,\r\n                write: true,\r\n                control: accumulator.control || current.control,\r\n            }\r\n            : {\r\n                read: accumulator.read || current.read,\r\n                append: accumulator.append || current.append,\r\n                write: false,\r\n                control: accumulator.control || current.control,\r\n            };\r\n    }, { read: false, append: false, write: false, control: false });\r\n}\r\n/** @internal */\r\nfunction internal_removeEmptyAclRules(aclDataset) {\r\n    const aclRules = internal_getAclRules(aclDataset);\r\n    const aclRulesToRemove = aclRules.filter(isEmptyAclRule);\r\n    // Is this too clever? It iterates over aclRulesToRemove, one by one removing them from aclDataset.\r\n    const updatedAclDataset = aclRulesToRemove.reduce(removeThing, aclDataset);\r\n    return updatedAclDataset;\r\n}\r\nfunction isEmptyAclRule(aclRule) {\r\n    // If there are Quads in there unrelated to Access Control,\r\n    // this is not an empty ACL rule that can be deleted:\r\n    if (Array.from(aclRule).some((quad) => !isAclQuad(quad))) {\r\n        return false;\r\n    }\r\n    // If the rule does not apply to any Resource, it is no longer working:\r\n    if (getIri(aclRule, acl.accessTo) === null &&\r\n        getIri(aclRule, acl.default) === null) {\r\n        return true;\r\n    }\r\n    // If the rule does not specify Access Modes, it is no longer working:\r\n    if (getIri(aclRule, acl.mode) === null) {\r\n        return true;\r\n    }\r\n    // If the rule does not specify whom it applies to, it is no longer working:\r\n    if (getIri(aclRule, acl.agent) === null &&\r\n        getIri(aclRule, acl.agentGroup) === null &&\r\n        getIri(aclRule, acl.agentClass) === null) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isAclQuad(quad) {\r\n    const predicate = quad.predicate;\r\n    const object = quad.object;\r\n    if (predicate.equals(DataFactory.namedNode(rdf.type)) &&\r\n        object.equals(DataFactory.namedNode(acl.Authorization))) {\r\n        return true;\r\n    }\r\n    if (predicate.equals(DataFactory.namedNode(acl.accessTo)) ||\r\n        predicate.equals(DataFactory.namedNode(acl.default))) {\r\n        return true;\r\n    }\r\n    if (predicate.equals(DataFactory.namedNode(acl.mode)) &&\r\n        Object.values(internal_accessModeIriStrings).some((mode) => object.equals(DataFactory.namedNode(mode)))) {\r\n        return true;\r\n    }\r\n    if (predicate.equals(DataFactory.namedNode(acl.agent)) ||\r\n        predicate.equals(DataFactory.namedNode(acl.agentGroup)) ||\r\n        predicate.equals(DataFactory.namedNode(acl.agentClass))) {\r\n        return true;\r\n    }\r\n    if (predicate.equals(DataFactory.namedNode(acl.origin))) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * IRIs of potential Access Modes\r\n * @internal\r\n */\r\nconst internal_accessModeIriStrings = {\r\n    read: \"http://www.w3.org/ns/auth/acl#Read\",\r\n    append: \"http://www.w3.org/ns/auth/acl#Append\",\r\n    write: \"http://www.w3.org/ns/auth/acl#Write\",\r\n    control: \"http://www.w3.org/ns/auth/acl#Control\",\r\n};\r\n/** @internal\r\n * This function finds, among a set of ACL rules, the ones granting access to a given entity (the target)\r\n * and identifying it with a specific property (`acl:agent` or `acl:agentGroup`).\r\n * @param aclRules The set of rules to filter\r\n * @param targetIri The IRI of the target\r\n * @param targetType The property linking the rule to the target\r\n */\r\nfunction internal_getAclRulesForIri(aclRules, targetIri, targetType) {\r\n    return aclRules.filter((rule) => getIriAll(rule, targetType).includes(targetIri));\r\n}\r\n/** @internal\r\n * This function transforms a given set of rules into a map associating the IRIs\r\n * of the entities to which permissions are granted by these rules, and the permissions\r\n * granted to them. Additionally, it filters these entities based on the predicate\r\n * that refers to them in the rule.\r\n */\r\nfunction internal_getAccessByIri(aclRules, targetType) {\r\n    const targetIriAccess = {};\r\n    aclRules.forEach((rule) => {\r\n        const ruleTargetIri = getIriAll(rule, targetType);\r\n        const access = internal_getAccess(rule);\r\n        // A rule might apply to multiple agents. If multiple rules apply to the same agent, the Access\r\n        // Modes granted by those rules should be combined:\r\n        ruleTargetIri.forEach((targetIri) => {\r\n            targetIriAccess[targetIri] =\r\n                typeof targetIriAccess[targetIri] === \"undefined\"\r\n                    ? access\r\n                    : internal_combineAccessModes([targetIriAccess[targetIri], access]);\r\n        });\r\n    });\r\n    return targetIriAccess;\r\n}\r\n/**\r\n * Save the ACL for a Resource.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param resource The Resource to which the given ACL applies.\r\n * @param resourceAcl An [[AclDataset]] whose ACL Rules will apply to `resource`.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n */\r\nfunction saveAclFor(resource, resourceAcl, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const savedDataset = yield saveSolidDatasetAt(resource.internal_resourceInfo.aclUrl, resourceAcl, options);\r\n        const savedAclDataset = Object.assign(savedDataset, {\r\n            internal_accessTo: getSourceUrl(resource),\r\n        });\r\n        return savedAclDataset;\r\n    });\r\n}\r\n/**\r\n * Remove the ACL of a Resource.\r\n *\r\n * Please note that the Web Access Control specification is not yet finalised, and hence, this\r\n * function is still experimental and can change in a non-major release.\r\n *\r\n * @param resource The Resource for which you want to delete the Access Control List Resource.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n */\r\nfunction deleteAclFor(resource, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, internal_defaultFetchOptions), options);\r\n        const response = yield config.fetch(resource.internal_resourceInfo.aclUrl, {\r\n            method: \"DELETE\",\r\n        });\r\n        if (!response.ok) {\r\n            throw new Error(`Deleting the ACL failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const storedResource = Object.assign(resource, {\r\n            acl: {\r\n                resourceAcl: null,\r\n            },\r\n        });\r\n        return storedResource;\r\n    });\r\n}\r\n/**\r\n * Initialise a new ACL Rule that grants some access - but does not yet specify to whom.\r\n *\r\n * @hidden This is an internal utility function that should not be used directly by downstreams.\r\n * @param access Access mode that this Rule will grant\r\n */\r\nfunction internal_initialiseAclRule(access) {\r\n    let newRule = createThing();\r\n    newRule = setIri(newRule, rdf.type, acl.Authorization);\r\n    if (access.read) {\r\n        newRule = addIri(newRule, acl.mode, internal_accessModeIriStrings.read);\r\n    }\r\n    if (access.append && !access.write) {\r\n        newRule = addIri(newRule, acl.mode, internal_accessModeIriStrings.append);\r\n    }\r\n    if (access.write) {\r\n        newRule = addIri(newRule, acl.mode, internal_accessModeIriStrings.write);\r\n    }\r\n    if (access.control) {\r\n        newRule = addIri(newRule, acl.mode, internal_accessModeIriStrings.control);\r\n    }\r\n    return newRule;\r\n}\r\n/**\r\n * Create a new ACL Rule with the same ACL values as the input ACL Rule, but having a different IRI.\r\n *\r\n * Note that non-ACL values will not be copied over.\r\n *\r\n * @hidden This is an internal utility function that should not be used directly by downstreams.\r\n * @param sourceRule ACL rule to duplicate.\r\n */\r\nfunction internal_duplicateAclRule(sourceRule) {\r\n    let targetRule = createThing();\r\n    targetRule = setIri(targetRule, rdf.type, acl.Authorization);\r\n    function copyIris(inputRule, outputRule, predicate) {\r\n        return getIriAll(inputRule, predicate).reduce((outputRule, iriTarget) => addIri(outputRule, predicate, iriTarget), outputRule);\r\n    }\r\n    targetRule = copyIris(sourceRule, targetRule, acl.accessTo);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.default);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.agent);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.agentGroup);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.agentClass);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.origin);\r\n    targetRule = copyIris(sourceRule, targetRule, acl.mode);\r\n    return targetRule;\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/** @internal */\r\nconst internal_defaultFetchOptions = {\r\n    fetch: fetch,\r\n};\r\n/**\r\n * Retrieve the information about a resource (e.g. access permissions) without\r\n * fetching the resource itself.\r\n *\r\n * @param url URL to fetch Resource metadata from.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters).\r\n * @returns Promise resolving to the metadata describing the given Resource, or rejecting if fetching it failed.\r\n */\r\nfunction internal_fetchResourceInfo(url, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, internal_defaultFetchOptions), options);\r\n        const response = yield config.fetch(url, { method: \"HEAD\" });\r\n        if (!response.ok) {\r\n            throw new Error(`Fetching the Resource metadata failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const resourceInfo = internal_parseResourceInfo(response);\r\n        return resourceInfo;\r\n    });\r\n}\r\n/**\r\n * This (currently internal) function fetches the ACL indicated in the [[WithResourceInfo]]\r\n * attached to a resource.\r\n *\r\n * @internal\r\n * @param resourceInfo The Resource info with the ACL URL\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/fetch#Parameters).\r\n */\r\nfunction internal_fetchAcl(resourceInfo, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!hasAccessibleAcl(resourceInfo)) {\r\n            return {\r\n                resourceAcl: null,\r\n                fallbackAcl: null,\r\n            };\r\n        }\r\n        const [resourceAcl, fallbackAcl] = yield Promise.all([\r\n            internal_fetchResourceAcl(resourceInfo, options),\r\n            internal_fetchFallbackAcl(resourceInfo, options),\r\n        ]);\r\n        return {\r\n            fallbackAcl: fallbackAcl,\r\n            resourceAcl: resourceAcl,\r\n        };\r\n    });\r\n}\r\n/**\r\n * Experimental: fetch a Resource's metadata and its associated Access Control List.\r\n *\r\n * This is an experimental function that fetches both a Resource's metadata, the linked ACL Resource (if\r\n * available), and the ACL that applies to it if the linked ACL Resource is not available (if accessible). This can\r\n * result in many HTTP requests being executed, in lieu of the Solid spec mandating servers to\r\n * provide this info in a single request.\r\n *\r\n * If the Resource's linked ACL Resource could not be fetched (because it does not exist, or because\r\n * the authenticated user does not have access to it), `acl.resourceAcl` will be `null`. If the\r\n * applicable Container's ACL is not accessible to the authenticated user, `acl.fallbackAcl` will be\r\n * `null`.\r\n *\r\n * @param url URL of the SolidDataset to fetch.\r\n * @param options Optional parameter `options.fetch`: An alternative `fetch` function to make the HTTP request, compatible with the browser-native [fetch API](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/fetch#parameters).\r\n * @returns A Resource's metadata and the ACLs that apply to the Resource, if available to the authenticated user.\r\n */\r\nfunction fetchResourceInfoWithAcl(url, options = internal_defaultFetchOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const resourceInfo = yield internal_fetchResourceInfo(url, options);\r\n        const acl = yield internal_fetchAcl({ internal_resourceInfo: resourceInfo }, options);\r\n        return Object.assign({ internal_resourceInfo: resourceInfo }, { internal_acl: acl });\r\n    });\r\n}\r\n/**\r\n * @internal\r\n */\r\nfunction internal_parseResourceInfo(response) {\r\n    var _a, _b, _c;\r\n    const contentTypeParts = (_b = (_a = response.headers.get(\"Content-Type\")) === null || _a === void 0 ? void 0 : _a.split(\";\")) !== null && _b !== void 0 ? _b : [];\r\n    // If the server offers a Turtle or JSON-LD serialisation on its own accord,\r\n    // that tells us whether it is RDF data that the server can understand\r\n    // (and hence can be updated with a PATCH request with SPARQL INSERT and DELETE statements),\r\n    // in which case our SolidDataset-related functions should handle it.\r\n    // For more context, see https://github.com/inrupt/solid-client-js/pull/214.\r\n    const isSolidDataset = contentTypeParts.length > 0 &&\r\n        [\"text/turtle\", \"application/ld+json\"].includes(contentTypeParts[0]);\r\n    const resourceInfo = {\r\n        sourceIri: response.url,\r\n        isRawData: !isSolidDataset,\r\n        contentType: (_c = response.headers.get(\"Content-Type\")) !== null && _c !== void 0 ? _c : undefined,\r\n    };\r\n    const linkHeader = response.headers.get(\"Link\");\r\n    if (linkHeader) {\r\n        const parsedLinks = LinkHeader.parse(linkHeader);\r\n        // Set ACL link\r\n        const aclLinks = parsedLinks.get(\"rel\", \"acl\");\r\n        if (aclLinks.length === 1) {\r\n            resourceInfo.aclUrl = new URL(aclLinks[0].uri, resourceInfo.sourceIri).href;\r\n        }\r\n    }\r\n    const wacAllowHeader = response.headers.get(\"WAC-Allow\");\r\n    if (wacAllowHeader) {\r\n        resourceInfo.permissions = parseWacAllowHeader(wacAllowHeader);\r\n    }\r\n    return resourceInfo;\r\n}\r\n/**\r\n * @param resource Resource for which to check whether it is a Container.\r\n * @returns Whether `resource` is a Container.\r\n */\r\nfunction isContainer(resource) {\r\n    return getSourceUrl(resource).endsWith(\"/\");\r\n}\r\n/**\r\n * This function will tell you whether a given Resource contains raw data, or a SolidDataset.\r\n *\r\n * @param resource Resource for which to check whether it contains raw data.\r\n * @return Whether `resource` contains raw data.\r\n */\r\nfunction isRawData(resource) {\r\n    return resource.internal_resourceInfo.isRawData;\r\n}\r\n/**\r\n * @param resource Resource for which to determine the Content Type.\r\n * @returns The Content Type, if known, or null if not known.\r\n */\r\nfunction getContentType(resource) {\r\n    var _a;\r\n    return (_a = resource.internal_resourceInfo.contentType) !== null && _a !== void 0 ? _a : null;\r\n}\r\n/**\r\n * @param resource\r\n * @returns The URL from which the resource has been fetched\r\n */\r\nfunction getSourceUrl(resource) {\r\n    return resource.internal_resourceInfo.sourceIri;\r\n}\r\n/** @hidden Alias of getSourceUrl for those who prefer to use IRI terminology. */\r\nconst getSourceIri = getSourceUrl;\r\n/**\r\n * Parse a WAC-Allow header into user and public access booleans.\r\n *\r\n * @param wacAllowHeader A WAC-Allow header in the format `user=\"read append write control\",public=\"read\"`\r\n * @see https://github.com/solid/solid-spec/blob/cb1373a369398d561b909009bd0e5a8c3fec953b/api-rest.md#wac-allow-headers\r\n */\r\nfunction parseWacAllowHeader(wacAllowHeader) {\r\n    function parsePermissionStatement(permissionStatement) {\r\n        const permissions = permissionStatement.split(\" \");\r\n        const writePermission = permissions.includes(\"write\");\r\n        return writePermission\r\n            ? {\r\n                read: permissions.includes(\"read\"),\r\n                append: true,\r\n                write: true,\r\n                control: permissions.includes(\"control\"),\r\n            }\r\n            : {\r\n                read: permissions.includes(\"read\"),\r\n                append: permissions.includes(\"append\"),\r\n                write: false,\r\n                control: permissions.includes(\"control\"),\r\n            };\r\n    }\r\n    function getStatementFor(header, scope) {\r\n        const relevantEntries = header\r\n            .split(\",\")\r\n            .map((rawEntry) => rawEntry.split(\"=\"))\r\n            .filter((parts) => parts.length === 2 && parts[0].trim() === scope);\r\n        // There should only be one statement with the given scope:\r\n        if (relevantEntries.length !== 1) {\r\n            return \"\";\r\n        }\r\n        const relevantStatement = relevantEntries[0][1].trim();\r\n        // The given statement should be wrapped in double quotes to be valid:\r\n        if (relevantStatement.charAt(0) !== '\"' ||\r\n            relevantStatement.charAt(relevantStatement.length - 1) !== '\"') {\r\n            return \"\";\r\n        }\r\n        // Return the statment without the wrapping quotes, e.g.: read append write control\r\n        return relevantStatement.substring(1, relevantStatement.length - 1);\r\n    }\r\n    return {\r\n        user: parsePermissionStatement(getStatementFor(wacAllowHeader, \"user\")),\r\n        public: parsePermissionStatement(getStatementFor(wacAllowHeader, \"public\")),\r\n    };\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\nconst defaultGetFileOptions = {\r\n    fetch: fetch,\r\n};\r\nconst RESERVED_HEADERS = [\"Slug\", \"If-None-Match\", \"Content-Type\"];\r\n/**\r\n * Some of the headers must be set by the library, rather than directly.\r\n */\r\nfunction containsReserved(header) {\r\n    return RESERVED_HEADERS.some((reserved) => header.has(reserved));\r\n}\r\n/**\r\n * Gets a file at a given URL, and returns it as a blob of data.\r\n *\r\n * Please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param url The URL of the fetched file\r\n * @param options Fetching options: a custom fetcher and/or headers.\r\n */\r\nfunction getFile(input, options = defaultGetFileOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, defaultGetFileOptions), options);\r\n        const url = internal_toIriString(input);\r\n        const response = yield config.fetch(url, config.init);\r\n        if (!response.ok) {\r\n            throw new Error(`Fetching the File failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const resourceInfo = internal_parseResourceInfo(response);\r\n        const data = yield response.blob();\r\n        const fileWithResourceInfo = Object.assign(data, {\r\n            internal_resourceInfo: resourceInfo,\r\n        });\r\n        return fileWithResourceInfo;\r\n    });\r\n}\r\n/**\r\n * Deletes a file at a given URL\r\n *\r\n * Please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param input The URL of the file to delete\r\n */\r\nfunction deleteFile(input, options = defaultGetFileOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, defaultGetFileOptions), options);\r\n        const url = internal_toIriString(input);\r\n        const response = yield config.fetch(url, Object.assign(Object.assign({}, config.init), { method: \"DELETE\" }));\r\n        if (!response.ok) {\r\n            throw new Error(`Deleting the file failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n    });\r\n}\r\n/**\r\n * Saves a file in a folder at a given URL. The server will return the final\r\n * filename (which may or may not be the given `slug`), it will return it in\r\n * the response's Location header.\r\n *\r\n * If something went wrong saving the file, the returned Promise will be rejected with an Error.\r\n *\r\n * Please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param folderUrl The URL of the folder where the new file is saved\r\n * @param file The file to be written\r\n * @param options Additional parameters for file creation (e.g. a slug)\r\n */\r\nfunction saveFileInContainer(folderUrl, file, options = defaultGetFileOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const folderUrlString = internal_toIriString(folderUrl);\r\n        const response = yield writeFile(folderUrlString, file, \"POST\", options);\r\n        if (!response.ok) {\r\n            throw new Error(`Saving the file failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const locationHeader = response.headers.get(\"Location\");\r\n        if (locationHeader === null) {\r\n            throw new Error(\"Could not determine the location for the newly saved file.\");\r\n        }\r\n        const fileIri = new URL(locationHeader, new URL(folderUrlString).origin).href;\r\n        const blobClone = new Blob([file]);\r\n        return Object.assign(blobClone, {\r\n            internal_resourceInfo: {\r\n                sourceIri: fileIri,\r\n                isRawData: true,\r\n            },\r\n        });\r\n    });\r\n}\r\n/**\r\n * Saves a file at a given URL, erasing any previous content.\r\n *\r\n * If something went wrong saving the file, the returned Promise will be rejected with an Error.\r\n *\r\n * Please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param fileUrl The URL where the file is saved\r\n * @param file The file to be written\r\n * @param options Additional parameters for file creation (e.g. a slug)\r\n */\r\nfunction overwriteFile(fileUrl, file, options = defaultGetFileOptions) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const fileUrlString = internal_toIriString(fileUrl);\r\n        const response = yield writeFile(fileUrlString, file, \"PUT\", options);\r\n        if (!response.ok) {\r\n            throw new Error(`Saving the file failed: ${response.status} ${response.statusText}.`);\r\n        }\r\n        const blobClone = new Blob([file]);\r\n        return Object.assign(blobClone, {\r\n            internal_resourceInfo: {\r\n                sourceIri: fileUrlString,\r\n                isRawData: true,\r\n            },\r\n        });\r\n    });\r\n}\r\n/**\r\n * Internal function that performs the actual write HTTP query, either POST\r\n * or PUT depending on the use case.\r\n *\r\n * @param fileUrl The URL where the file is saved\r\n * @param file The file to be written\r\n * @param method The HTTP method\r\n * @param options Additional parameters for file creation (e.g. a slug)\r\n */\r\nfunction writeFile(targetUrl, file, method, options) {\r\n    var _a, _b;\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        const config = Object.assign(Object.assign({}, defaultGetFileOptions), options);\r\n        const headers = new Headers((_b = (_a = config.init) === null || _a === void 0 ? void 0 : _a.headers) !== null && _b !== void 0 ? _b : {});\r\n        if (containsReserved(headers)) {\r\n            throw new Error(`No reserved header (${RESERVED_HEADERS.join(\", \")}) should be set in the optional RequestInit.`);\r\n        }\r\n        // If a slug is in the parameters, set the request headers accordingly\r\n        if (config.slug !== undefined) {\r\n            headers.append(\"Slug\", config.slug);\r\n        }\r\n        headers.append(\"Content-Type\", file.type);\r\n        const targetUrlString = internal_toIriString(targetUrl);\r\n        return yield config.fetch(targetUrlString, Object.assign(Object.assign({}, config.init), { headers,\r\n            method, body: file }));\r\n    });\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Create a new Thing with a URL added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setUrl]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add a URL value to.\r\n * @param property Property for which to add the given URL value.\r\n * @param url URL to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addUrl = (thing, property, url) => {\r\n    const predicateNode = asNamedNode(property);\r\n    const newThing = cloneThing(thing);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, toNode(url)));\r\n    return newThing;\r\n};\r\n/** @hidden Alias for [[addUrl]] for those who prefer IRI terminology. */\r\nconst addIri = addUrl;\r\n/**\r\n * Create a new Thing with a boolean added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setBoolean]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add a boolean value to.\r\n * @param property Property for which to add the given boolean value.\r\n * @param value Boolean to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addBoolean = (thing, property, value) => {\r\n    return addLiteralOfType(thing, property, serializeBoolean(value), xmlSchemaTypes.boolean);\r\n};\r\n/**\r\n * Create a new Thing with a datetime added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setDatetime]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add a datetime value to.\r\n * @param property Property for which to add the given datetime value.\r\n * @param value Datetime to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addDatetime = (thing, property, value) => {\r\n    return addLiteralOfType(thing, property, serializeDatetime(value), xmlSchemaTypes.dateTime);\r\n};\r\n/**\r\n * Create a new Thing with a decimal added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setDecimal]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add a decimal value to.\r\n * @param property Property for which to add the given decimal value.\r\n * @param value Decimal to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addDecimal = (thing, property, value) => {\r\n    return addLiteralOfType(thing, property, serializeDecimal(value), xmlSchemaTypes.decimal);\r\n};\r\n/**\r\n * Create a new Thing with an integer added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setInteger]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add an integer value to.\r\n * @param property Property for which to add the given integer value.\r\n * @param value Integer to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addInteger = (thing, property, value) => {\r\n    return addLiteralOfType(thing, property, serializeInteger(value), xmlSchemaTypes.integer);\r\n};\r\nfunction addStringWithLocale(thing, property, value, locale) {\r\n    const literal = DataFactory.literal(value, normalizeLocale(locale));\r\n    return addLiteral(thing, property, literal);\r\n}\r\n/**\r\n * Create a new Thing with an unlocalised string added for a Property.\r\n *\r\n * This preserves existing values for the given Property. To replace them, see [[setStringNoLocale]].\r\n *\r\n * The original `thing` is not modified; this function returns a cloned Thing with updated values.\r\n *\r\n * @param thing Thing to add an unlocalised string value to.\r\n * @param property Property for which to add the given string value.\r\n * @param value String to add to `thing` for the given `property`.\r\n * @returns A new Thing equal to the input Thing with the given value added for the given Property.\r\n */\r\nconst addStringNoLocale = (thing, property, value) => {\r\n    return addLiteralOfType(thing, property, value, xmlSchemaTypes.string);\r\n};\r\nfunction addNamedNode(thing, property, value) {\r\n    const predicateNode = asNamedNode(property);\r\n    const newThing = cloneThing(thing);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, value));\r\n    return newThing;\r\n}\r\nfunction addLiteral(thing, property, value) {\r\n    const predicateNode = asNamedNode(property);\r\n    const newThing = cloneThing(thing);\r\n    newThing.add(DataFactory.quad(toNode(newThing), predicateNode, value));\r\n    return newThing;\r\n}\r\nfunction addLiteralOfType(thing, property, value, type) {\r\n    const literal = DataFactory.literal(value, type);\r\n    return addLiteral(thing, property, literal);\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Find out what Access Modes have been granted to a given Agent specifically for a given Resource.\r\n *\r\n * Keep in mind that this function will not tell you what access the given Agent has through other ACL rules, e.g. public or group-specific permissions.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param resourceInfo Information about the Resource to which the given Agent may have been granted access.\r\n * @param agent WebID of the Agent for which to retrieve what access it has to the Resource.\r\n * @returns Which Access Modes have been granted to the Agent specifically for the given SolidDataset, or `null` if it could not be determined (e.g. because the current user does not have Control Access to a given Resource or its Container).\r\n */\r\nfunction getAgentAccess(resourceInfo, agent) {\r\n    if (hasResourceAcl(resourceInfo)) {\r\n        return getAgentResourceAccess(resourceInfo.internal_acl.resourceAcl, agent);\r\n    }\r\n    if (hasFallbackAcl(resourceInfo)) {\r\n        return getAgentDefaultAccess(resourceInfo.internal_acl.fallbackAcl, agent);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Find out what Access Modes have been granted to specific Agents for a given Resource.\r\n *\r\n * Keep in mind that this function will not tell you what access arbitrary Agents might have through other ACL rules, e.g. public or group-specific permissions.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param resourceInfo Information about the Resource to which Agents may have been granted access.\r\n * @returns Which Access Modes have been granted to which Agents specifically for the given SolidDataset, or `null` if it could not be determined (e.g. because the current user does not have Control Access to a given Resource or its Container).\r\n */\r\nfunction getAgentAccessAll(resourceInfo) {\r\n    if (hasResourceAcl(resourceInfo)) {\r\n        const resourceAcl = getResourceAcl(resourceInfo);\r\n        return getAgentResourceAccessAll(resourceAcl);\r\n    }\r\n    if (hasFallbackAcl(resourceInfo)) {\r\n        const fallbackAcl = getFallbackAcl(resourceInfo);\r\n        return getAgentDefaultAccessAll(fallbackAcl);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to an Agent for its associated Resource.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access the given Agent has through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access the given Agent has to child Resources, in case the associated Resource is a Container (see [[getAgentDefaultAccessModes]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param agent WebID of the Agent for which to retrieve what access it has to the Resource.\r\n * @returns Which Access Modes have been granted to the Agent specifically for the Resource the given ACL SolidDataset is associated with.\r\n */\r\nfunction getAgentResourceAccess(aclDataset, agent) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getResourceAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const agentResourceRules = getAgentAclRulesForAgent(resourceRules, agent);\r\n    const agentAccessModes = agentResourceRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(agentAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to specific Agents for the associated Resource.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access arbitrary Agents might have been given through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access arbitrary Agents have to child Resources, in case the associated Resource is a Container.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @returns Which Access Modes have been granted to which Agents specifically for the Resource the given ACL SolidDataset is associated with.\r\n */\r\nfunction getAgentResourceAccessAll(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getResourceAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const agentResourceRules = getAgentAclRules(resourceRules);\r\n    return getAccessByAgent(agentResourceRules);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, modify the ACL Rules to set specific Access Modes for a given Agent.\r\n *\r\n * If the given ACL SolidDataset already includes ACL Rules that grant a certain set of Access Modes\r\n * to the given Agent, those will be overridden by the given Access Modes.\r\n *\r\n * Keep in mind that this function will not modify:\r\n * - access arbitrary Agents might have been given through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access arbitrary Agents have to child Resources.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param agent The Agent to grant specific Access Modes.\r\n * @param access The Access Modes to grant to the Agent.\r\n */\r\nfunction setAgentResourceAccess(aclDataset, agent, access) {\r\n    // First make sure that none of the pre-existing rules in the given ACL SolidDataset\r\n    // give the Agent access to the Resource:\r\n    let filteredAcl = aclDataset;\r\n    getThingAll(aclDataset).forEach((aclRule) => {\r\n        // Obtain both the Rule that no longer includes the given Agent,\r\n        // and a new Rule that includes all ACL Quads\r\n        // that do not pertain to the given Agent-Resource combination.\r\n        // Note that usually, the latter will no longer include any meaningful statements;\r\n        // we'll clean them up afterwards.\r\n        const [filteredRule, remainingRule] = removeAgentFromRule(aclRule, agent, aclDataset.internal_accessTo, \"resource\");\r\n        filteredAcl = setThing(filteredAcl, filteredRule);\r\n        filteredAcl = setThing(filteredAcl, remainingRule);\r\n    });\r\n    // Create a new Rule that only grants the given Agent the given Access Modes:\r\n    let newRule = internal_initialiseAclRule(access);\r\n    newRule = setIri(newRule, acl.accessTo, aclDataset.internal_accessTo);\r\n    newRule = setIri(newRule, acl.agent, agent);\r\n    const updatedAcl = setThing(filteredAcl, newRule);\r\n    // Remove any remaining Rules that do not contain any meaningful statements:\r\n    const cleanedAcl = internal_removeEmptyAclRules(updatedAcl);\r\n    return cleanedAcl;\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to an Agent for the associated Container Resource's child Resources.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access the given Agent has through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access the given Agent has to the Container Resource itself (see [[getAgentResourceAccess]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules for a certain Container.\r\n * @param agent WebID of the Agent for which to retrieve what access it has to the Container's children.\r\n * @returns Which Access Modes have been granted to the Agent specifically for the children of the Container associated with the given ACL SolidDataset.\r\n */\r\nfunction getAgentDefaultAccess(aclDataset, agent) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getDefaultAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const agentResourceRules = getAgentAclRulesForAgent(resourceRules, agent);\r\n    const agentAccessModes = agentResourceRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(agentAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to specific Agents for the associated Container Resource's child Resources.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access arbitrary Agents might have been given through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access arbitrary Agents have to the Container Resource itself (see [[getAgentResourceAccessAll]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @returns Which Access Modes have been granted to which Agents specifically for the children of the Container associated with the given ACL SolidDataset.\r\n */\r\nfunction getAgentDefaultAccessAll(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getDefaultAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const agentResourceRules = getAgentAclRules(resourceRules);\r\n    return getAccessByAgent(agentResourceRules);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, modify the ACL Rules to set specific default Access Modes for a given Agent.\r\n *\r\n * If the given ACL SolidDataset already includes ACL Rules that grant a certain set of default Access Modes\r\n * to the given Agent, those will be overridden by the given Access Modes.\r\n *\r\n * Keep in mind that this function will not modify:\r\n * - access arbitrary Agents might have been given through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access arbitrary Agents have to the Container itself.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param agent The Agent to grant specific Access Modes.\r\n * @param access The Access Modes to grant to the Agent.\r\n */\r\nfunction setAgentDefaultAccess(aclDataset, agent, access) {\r\n    // First make sure that none of the pre-existing rules in the given ACL SolidDataset\r\n    // give the Agent default access to the Resource:\r\n    let filteredAcl = aclDataset;\r\n    getThingAll(aclDataset).forEach((aclRule) => {\r\n        // Obtain both the Rule that no longer includes the given Agent,\r\n        // and a new Rule that includes all ACL Quads\r\n        // that do not pertain to the given Agent-Resource default combination.\r\n        // Note that usually, the latter will no longer include any meaningful statements;\r\n        // we'll clean them up afterwards.\r\n        const [filteredRule, remainingRule] = removeAgentFromRule(aclRule, agent, aclDataset.internal_accessTo, \"default\");\r\n        filteredAcl = setThing(filteredAcl, filteredRule);\r\n        filteredAcl = setThing(filteredAcl, remainingRule);\r\n    });\r\n    // Create a new Rule that only grants the given Agent the given default Access Modes:\r\n    let newRule = internal_initialiseAclRule(access);\r\n    newRule = setIri(newRule, acl.default, aclDataset.internal_accessTo);\r\n    newRule = setIri(newRule, acl.agent, agent);\r\n    const updatedAcl = setThing(filteredAcl, newRule);\r\n    // Remove any remaining Rules that do not contain any meaningful statements:\r\n    const cleanedAcl = internal_removeEmptyAclRules(updatedAcl);\r\n    return cleanedAcl;\r\n}\r\nfunction getAgentAclRulesForAgent(aclRules, agent) {\r\n    return internal_getAclRulesForIri(aclRules, agent, acl.agent);\r\n}\r\nfunction getAgentAclRules(aclRules) {\r\n    return aclRules.filter(isAgentAclRule);\r\n}\r\nfunction isAgentAclRule(aclRule) {\r\n    return getIri(aclRule, acl.agent) !== null;\r\n}\r\n/**\r\n * Given an ACL Rule, return two new ACL Rules that cover all the input Rule's use cases,\r\n * except for giving the given Agent access to the given Resource.\r\n *\r\n * @param rule The ACL Rule that should no longer apply for a given Agent to a given Resource.\r\n * @param agent The Agent that should be removed from the Rule for the given Resource.\r\n * @param resourceIri The Resource to which the Rule should no longer apply for the given Agent.\r\n * @returns A tuple with the original ACL Rule sans the given Agent, and a new ACL Rule for the given Agent for the remaining Resources, respectively.\r\n */\r\nfunction removeAgentFromRule(rule, agent, resourceIri, ruleType) {\r\n    // If the existing Rule does not apply to the given Agent, we don't need to split up.\r\n    // Without this check, we'd be creating a new rule for the given Agent (ruleForOtherTargets)\r\n    // that would give it access it does not currently have:\r\n    if (!getIriAll(rule, acl.agent).includes(agent)) {\r\n        const emptyRule = internal_initialiseAclRule({\r\n            read: false,\r\n            append: false,\r\n            write: false,\r\n            control: false,\r\n        });\r\n        return [rule, emptyRule];\r\n    }\r\n    // The existing rule will keep applying to Agents other than the given one:\r\n    const ruleWithoutAgent = removeIri(rule, acl.agent, agent);\r\n    // The agent already had some access in the rule, so duplicate it...\r\n    let ruleForOtherTargets = internal_duplicateAclRule(rule);\r\n    // ...but remove access to the original Resource:\r\n    ruleForOtherTargets = removeIri(ruleForOtherTargets, ruleType === \"resource\" ? acl.accessTo : acl.default, resourceIri);\r\n    // Only apply the new Rule to the given Agent (because the existing Rule covers the others)\r\n    ruleForOtherTargets = setIri(ruleForOtherTargets, acl.agent, agent);\r\n    ruleForOtherTargets = removeAll(ruleForOtherTargets, acl.agentClass);\r\n    ruleForOtherTargets = removeAll(ruleForOtherTargets, acl.agentGroup);\r\n    return [ruleWithoutAgent, ruleForOtherTargets];\r\n}\r\nfunction getAccessByAgent(aclRules) {\r\n    return internal_getAccessByIri(aclRules, acl.agent);\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Find out what Access Modes have been granted to a given Group of agents specifically for a given Resource.\r\n *\r\n * Keep in mind that this function will not tell you what access members of the given Group have through other ACL rules, e.g. public permissions.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param resourceInfo Information about the Resource to which the given Group may have been granted access.\r\n * @param group URL of the Group for which to retrieve what access it has to the Resource.\r\n * @returns Which Access Modes have been granted to the Group specifically for the given Resource, or `null` if it could not be determined (e.g. because the current user does not have Control Access to a given Resource or its Container).\r\n */\r\nfunction getGroupAccess(resourceInfo, group) {\r\n    if (hasResourceAcl(resourceInfo)) {\r\n        return getGroupResourceAccess(resourceInfo.internal_acl.resourceAcl, group);\r\n    }\r\n    if (hasFallbackAcl(resourceInfo)) {\r\n        return getGroupDefaultAccess(resourceInfo.internal_acl.fallbackAcl, group);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Find out what Access Modes have been granted to specific Groups of agents for a given Resource.\r\n *\r\n * Keep in mind that this function will not tell you what access members of each Group have through other ACL rules, e.g. public permissions.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param resourceInfo Information about the Resource to which the given Group may have been granted access.\r\n * @returns Which Access Modes have been granted to which Groups specifically for the given Resource, or `null` if it could not be determined (e.g. because the current user does not have Control Access to a given Resource or its Container).\r\n */\r\nfunction getGroupAccessAll(resourceInfo) {\r\n    if (hasResourceAcl(resourceInfo)) {\r\n        const resourceAcl = getResourceAcl(resourceInfo);\r\n        return getGroupResourceAccessAll(resourceAcl);\r\n    }\r\n    if (hasFallbackAcl(resourceInfo)) {\r\n        const fallbackAcl = getFallbackAcl(resourceInfo);\r\n        return getGroupDefaultAccessAll(fallbackAcl);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to a Group for its associated Resource.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access members of the given Group have through other ACL rules, e.g. public permissions.\r\n * - what access members of the given Group have to child Resources, in case the associated Resource is a Container (see [[getGroupDefaultAccessModes]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param group URL of the Group for which to retrieve what access it has to the Resource.\r\n * @returns Which Access Modes have been granted to the Group specifically for the Resource the given ACL SolidDataset is associated with.\r\n */\r\nfunction getGroupResourceAccess(aclDataset, group) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getResourceAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const groupResourceRules = getGroupAclRuleForGroup(resourceRules, group);\r\n    const groupAccessModes = groupResourceRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(groupAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to specific Groups for the associated Resource.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access arbitrary members of these Groups might have been given through other ACL rules, e.g. public permissions.\r\n * - what access arbitrary members of these Groups have to child Resources, in case the associated Resource is a Container.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @returns Which Access Modes have been granted to which Groups specifically for the Resource the given ACL SolidDataset is associated with.\r\n */\r\nfunction getGroupResourceAccessAll(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getResourceAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    return getAccessByGroup(resourceRules);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to a given Group for the associated Container Resource's child Resources.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access members of the given Group have through other ACL rules, e.g. public permissions.\r\n * - what access members of the given Group have to the Container Resource itself (see [[getGroupResourceAccess]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules for a certain Container.\r\n * @param group URL of the Group for which to retrieve what access it has to the child Resources of the given Container.\r\n * @returns Which Access Modes have been granted to the Group specifically for the children of the Container associated with the given ACL SolidDataset.\r\n */\r\nfunction getGroupDefaultAccess(aclDataset, group) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const defaultRules = internal_getDefaultAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const groupDefaultRules = getGroupAclRuleForGroup(defaultRules, group);\r\n    const groupAccessModes = groupDefaultRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(groupAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to specific Groups for the associated Container Resource's child Resources.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access arbitrary members of these Groups have through other ACL rules, e.g. public permissions.\r\n * - what access arbitrary members of these Groups have to the Container Resource itself (see [[getGroupResourceAccessAll]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules for a certain Container.\r\n * @returns Which Access Modes have been granted to which Groups specifically for the children of the Container associated with the given ACL SolidDataset.\r\n */\r\nfunction getGroupDefaultAccessAll(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const defaultRules = internal_getDefaultAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    return getAccessByGroup(defaultRules);\r\n}\r\nfunction getGroupAclRuleForGroup(rules, group) {\r\n    return internal_getAclRulesForIri(rules, group, acl.agentGroup);\r\n}\r\nfunction getAccessByGroup(aclRules) {\r\n    return internal_getAccessByIri(aclRules, acl.agentGroup);\r\n}\n\n/**\r\n * Copyright 2020 Inrupt Inc.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal in\r\n * the Software without restriction, including without limitation the rights to use,\r\n * copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the\r\n * Software, and to permit persons to whom the Software is furnished to do so,\r\n * subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,\r\n * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A\r\n * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\r\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n/**\r\n * Find out what Access Modes have been granted to everyone for a given Resource.\r\n *\r\n * Keep in mind that this function will not tell you what access specific Agents have through other ACL rules, e.g. agent- or group-specific permissions.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param resourceInfo Information about the Resource to which the given Agent may have been granted access.\r\n * @returns Which Access Modes have been granted to everyone for the given SolidDataset, or `null` if it could not be determined (e.g. because the current user does not have Control Access to a given Resource or its Container).\r\n */\r\nfunction getPublicAccess(resourceInfo) {\r\n    if (hasResourceAcl(resourceInfo)) {\r\n        return getPublicResourceAccess(resourceInfo.internal_acl.resourceAcl);\r\n    }\r\n    if (hasFallbackAcl(resourceInfo)) {\r\n        return getPublicDefaultAccess(resourceInfo.internal_acl.fallbackAcl);\r\n    }\r\n    return null;\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to everyone for its associated Resource.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access specific Agents have through other ACL rules, e.g. agent- or group-specific permissions.\r\n * - what access anyone has to child Resources, in case the associated Resource is a Container (see [[getDefaultResourceAccess]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @returns Which Access Modes have been granted to everyone for the Resource the given ACL SolidDataset is associated with.\r\n */\r\nfunction getPublicResourceAccess(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getResourceAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const publicResourceRules = getClassAclRulesForClass(resourceRules, foaf.Agent);\r\n    const publicAccessModes = publicResourceRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(publicAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, find out which access modes it provides to everyone for the associated Container Resource's child Resources.\r\n *\r\n * Keep in mind that this function will not tell you:\r\n * - what access specific Agents have through other ACL rules, e.g. agent- or group-specific permissions.\r\n * - what access anyone has to the Container Resource itself (see [[getPublicResourceAccess]] for that).\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules for a certain Container.\r\n * @returns Which Access Modes have been granted to everyone for the children of the Container associated with the given ACL SolidDataset.\r\n */\r\nfunction getPublicDefaultAccess(aclDataset) {\r\n    const allRules = internal_getAclRules(aclDataset);\r\n    const resourceRules = internal_getDefaultAclRulesForResource(allRules, aclDataset.internal_accessTo);\r\n    const publicResourceRules = getClassAclRulesForClass(resourceRules, foaf.Agent);\r\n    const publicAccessModes = publicResourceRules.map(internal_getAccess);\r\n    return internal_combineAccessModes(publicAccessModes);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, modify the ACL Rules to set specific Access Modes for the public.\r\n *\r\n * If the given ACL SolidDataset already includes ACL Rules that grant a certain set of Access Modes\r\n * to the public, those will be overridden by the given Access Modes.\r\n *\r\n * Keep in mind that this function will not modify:\r\n * - access arbitrary Agents might have been given through other ACL rules, e.g. agent- or group-specific permissions.\r\n * - what access arbitrary Agents have to child Resources.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param access The Access Modes to grant to the public.\r\n */\r\nfunction setPublicResourceAccess(aclDataset, access) {\r\n    // First make sure that none of the pre-existing rules in the given ACL SolidDataset\r\n    // give the public access to the Resource:\r\n    let filteredAcl = aclDataset;\r\n    getThingAll(aclDataset).forEach((aclRule) => {\r\n        // Obtain both the Rule that no longer includes the public,\r\n        // and a new Rule that includes all ACL Quads\r\n        // that do not pertain to the given Public-Resource combination.\r\n        // Note that usually, the latter will no longer include any meaningful statements;\r\n        // we'll clean them up afterwards.\r\n        const [filteredRule, remainingRule] = removePublicFromRule(aclRule, aclDataset.internal_accessTo, \"resource\");\r\n        filteredAcl = setThing(filteredAcl, filteredRule);\r\n        filteredAcl = setThing(filteredAcl, remainingRule);\r\n    });\r\n    // Create a new Rule that only grants the public the given Access Modes:\r\n    let newRule = internal_initialiseAclRule(access);\r\n    newRule = setIri(newRule, acl.accessTo, aclDataset.internal_accessTo);\r\n    newRule = setIri(newRule, acl.agentClass, foaf.Agent);\r\n    const updatedAcl = setThing(filteredAcl, newRule);\r\n    // Remove any remaining Rules that do not contain any meaningful statements:\r\n    return internal_removeEmptyAclRules(updatedAcl);\r\n}\r\n/**\r\n * Given an ACL SolidDataset, modify the ACL Rules to set specific default Access Modes for the public.\r\n *\r\n * If the given ACL SolidDataset already includes ACL Rules that grant a certain set of default Access Modes\r\n * to the public, those will be overridden by the given Access Modes.\r\n *\r\n * Keep in mind that this function will not modify:\r\n * - access arbitrary Agents might have been given through other ACL rules, e.g. public or group-specific permissions.\r\n * - what access arbitrary Agents have to the Container itself.\r\n *\r\n * Also, please note that this function is still experimental: its API can change in non-major releases.\r\n *\r\n * @param aclDataset The SolidDataset that contains Access-Control List rules.\r\n * @param access The Access Modes to grant to the public.\r\n */\r\nfunction setPublicDefaultAccess(aclDataset, access) {\r\n    // First make sure that none of the pre-existing rules in the given ACL SolidDataset\r\n    // give the public default access to the Resource:\r\n    let filteredAcl = aclDataset;\r\n    getThingAll(aclDataset).forEach((aclRule) => {\r\n        // Obtain both the Rule that no longer includes the public,\r\n        // and a new Rule that includes all ACL Quads\r\n        // that do not pertain to the given Public-Resource default combination.\r\n        // Note that usually, the latter will no longer include any meaningful statements;\r\n        // we'll clean them up afterwards.\r\n        const [filteredRule, remainingRule] = removePublicFromRule(aclRule, aclDataset.internal_accessTo, \"default\");\r\n        filteredAcl = setThing(filteredAcl, filteredRule);\r\n        filteredAcl = setThing(filteredAcl, remainingRule);\r\n    });\r\n    // Create a new Rule that only grants the public the given default Access Modes:\r\n    let newRule = internal_initialiseAclRule(access);\r\n    newRule = setIri(newRule, acl.default, aclDataset.internal_accessTo);\r\n    newRule = setIri(newRule, acl.agentClass, foaf.Agent);\r\n    const updatedAcl = setThing(filteredAcl, newRule);\r\n    // Remove any remaining Rules that do not contain any meaningful statements:\r\n    const cleanedAcl = internal_removeEmptyAclRules(updatedAcl);\r\n    return cleanedAcl;\r\n}\r\n/**\r\n * Given an ACL Rule, return two new ACL Rules that cover all the input Rule's use cases,\r\n * except for giving the public access to the given Resource.\r\n *\r\n * @param rule The ACL Rule that should no longer apply for the public to a given Resource.\r\n * @param resourceIri The Resource to which the Rule should no longer apply for the public.\r\n * @returns A tuple with the original ACL Rule sans the public, and a new ACL Rule for the public for the remaining Resources, respectively.\r\n */\r\nfunction removePublicFromRule(rule, resourceIri, ruleType) {\r\n    // If the existing Rule does not apply to the given Agent, we don't need to split up.\r\n    // Without this check, we'd be creating a new rule for the given Agent (ruleForOtherTargets)\r\n    // that would give it access it does not currently have:\r\n    if (!getIriAll(rule, acl.agentClass).includes(foaf.Agent)) {\r\n        const emptyRule = internal_initialiseAclRule({\r\n            read: false,\r\n            append: false,\r\n            write: false,\r\n            control: false,\r\n        });\r\n        return [rule, emptyRule];\r\n    }\r\n    // The existing rule will keep applying to the public:\r\n    const ruleWithoutPublic = removeIri(rule, acl.agentClass, foaf.Agent);\r\n    // The new rule will...\r\n    let ruleForOtherTargets = internal_duplicateAclRule(rule);\r\n    // ...*only* apply to the public (because the existing Rule covers the others)...\r\n    ruleForOtherTargets = setIri(ruleForOtherTargets, acl.agentClass, foaf.Agent);\r\n    ruleForOtherTargets = removeAll(ruleForOtherTargets, acl.agent);\r\n    ruleForOtherTargets = removeAll(ruleForOtherTargets, acl.agentGroup);\r\n    // ...but not to the given Resource:\r\n    ruleForOtherTargets = removeIri(ruleForOtherTargets, ruleType === \"resource\" ? acl.accessTo : acl.default, resourceIri);\r\n    return [ruleWithoutPublic, ruleForOtherTargets];\r\n}\r\nfunction getClassAclRulesForClass(aclRules, agentClass) {\r\n    return aclRules.filter((rule) => appliesToClass(rule, agentClass));\r\n}\r\nfunction appliesToClass(aclRule, agentClass) {\r\n    return getIriAll(aclRule, acl.agentClass).includes(agentClass);\r\n}\n\nexport { addBoolean, addDatetime, addDecimal, addInteger, addIri, addLiteral, addNamedNode, addStringWithLocale as addStringInLocale, addStringNoLocale, addStringNoLocale as addStringUnlocalized, addStringWithLocale, addUrl, asIri, asUrl, createAcl, createAclFromFallbackAcl, createSolidDataset as createLitDataset, createSolidDataset, createThing, deleteAclFor, deleteFile, getSolidDataset as fetchLitDataset, getSolidDatasetWithAcl as fetchLitDatasetWithAcl, fetchResourceInfoWithAcl, getAgentAccess, getAgentAccessAll, getAgentDefaultAccess, getAgentDefaultAccessAll, getAgentResourceAccess, getAgentResourceAccessAll, getBoolean, getBooleanAll, getContentType, getDatetime, getDatetimeAll, getDecimal, getDecimalAll, getFallbackAcl, getSourceUrl as getFetchedFrom, getFile, getGroupAccess, getGroupAccessAll, getGroupDefaultAccess, getGroupDefaultAccessAll, getGroupResourceAccess, getGroupResourceAccessAll, getInteger, getIntegerAll, getIri, getIriAll, getLiteral, getLiteralAll, getNamedNode, getNamedNodeAll, getPublicAccess, getPublicDefaultAccess, getPublicResourceAccess, getResourceAcl, getSolidDataset, getSolidDatasetWithAcl, getSourceIri, getSourceUrl, getStringWithLocaleAll as getStringInLocaleAll, getStringWithLocale as getStringInLocaleOne, getStringNoLocale, getStringNoLocaleAll, getStringNoLocaleAll as getStringUnlocalizedAll, getStringNoLocale as getStringUnlocalizedOne, getStringWithLocale, getStringWithLocaleAll, getThing, getThingAll, getUrl, getUrlAll, hasAccessibleAcl, hasFallbackAcl, hasResourceAcl, isContainer, isRawData as isLitDataset, isRawData, overwriteFile, removeAll, removeBoolean, removeDatetime, removeDecimal, removeInteger, removeIri, removeLiteral, removeNamedNode, removeStringWithLocale as removeStringInLocale, removeStringNoLocale, removeStringNoLocale as removeStringUnlocalized, removeStringWithLocale, removeThing, removeUrl, saveAclFor, saveFileInContainer, saveSolidDatasetAt as saveLitDatasetAt, saveSolidDatasetInContainer as saveLitDatasetInContainer, saveSolidDatasetAt, saveSolidDatasetInContainer, setAgentDefaultAccess, setAgentResourceAccess, setBoolean, setDatetime, setDecimal, setInteger, setIri, setLiteral, setNamedNode, setPublicDefaultAccess, setPublicResourceAccess, setStringWithLocale as setStringInLocale, setStringNoLocale, setStringNoLocale as setStringUnlocalized, setStringWithLocale, setThing, setUrl, createAcl as unstable_createAcl, createAclFromFallbackAcl as unstable_createAclFromFallbackAcl, deleteAclFor as unstable_deleteAclFor, deleteFile as unstable_deleteFile, getFile as unstable_fetchFile, getSolidDatasetWithAcl as unstable_fetchLitDatasetWithAcl, fetchResourceInfoWithAcl as unstable_fetchResourceInfoWithAcl, getAgentAccessAll as unstable_getAgentAccessAll, getAgentAccess as unstable_getAgentAccessOne, getAgentDefaultAccessAll as unstable_getAgentDefaultAccessAll, getAgentDefaultAccess as unstable_getAgentDefaultAccessOne, getAgentResourceAccessAll as unstable_getAgentResourceAccessAll, getAgentResourceAccess as unstable_getAgentResourceAccessOne, getFallbackAcl as unstable_getFallbackAcl, getGroupAccessAll as unstable_getGroupAccessAll, getGroupAccess as unstable_getGroupAccessOne, getGroupDefaultAccessAll as unstable_getGroupDefaultAccessAll, getGroupDefaultAccess as unstable_getGroupDefaultAccessOne, getGroupResourceAccessAll as unstable_getGroupResourceAccessAll, getGroupResourceAccess as unstable_getGroupResourceAccessOne, getPublicAccess as unstable_getPublicAccess, getPublicDefaultAccess as unstable_getPublicDefaultAccess, getPublicResourceAccess as unstable_getPublicResourceAccess, getResourceAcl as unstable_getResourceAcl, hasAccessibleAcl as unstable_hasAccessibleAcl, hasFallbackAcl as unstable_hasFallbackAcl, hasResourceAcl as unstable_hasResourceAcl, overwriteFile as unstable_overwriteFile, saveAclFor as unstable_saveAclFor, saveFileInContainer as unstable_saveFileInContainer, setAgentDefaultAccess as unstable_setAgentDefaultAccess, setAgentResourceAccess as unstable_setAgentResourceAccess, setPublicDefaultAccess as unstable_setPublicDefaultAccess, setPublicResourceAccess as unstable_setPublicResourceAccess };\n","var DataFactory = require('./lib/data-factory')\n\nmodule.exports = DataFactory\n","function Variable (name) {\n  this.value = name\n}\n\nVariable.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nVariable.prototype.termType = 'Variable'\n\nmodule.exports = Variable\n","const rdf = require('@rdfjs/data-model')\nconst DatasetCore = require('./DatasetCore')\n\nfunction dataset (quads) {\n  return new DatasetCore(quads)\n}\n\nmodule.exports = Object.assign({ dataset }, rdf)\n","function DefaultGraph () {\n  this.value = ''\n}\n\nDefaultGraph.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType\n}\n\nDefaultGraph.prototype.termType = 'DefaultGraph'\n\nmodule.exports = DefaultGraph\n","var DefaultGraph = require('./default-graph')\n\nfunction Quad (subject, predicate, object, graph) {\n  this.subject = subject\n  this.predicate = predicate\n  this.object = object\n\n  if (graph) {\n    this.graph = graph\n  } else {\n    this.graph = new DefaultGraph()\n  }\n}\n\nQuad.prototype.equals = function (other) {\n  return !!other && other.subject.equals(this.subject) && other.predicate.equals(this.predicate) &&\n    other.object.equals(this.object) && other.graph.equals(this.graph)\n}\n\nmodule.exports = Quad\n","const isMatch = require('./isMatch')\n\nclass DatasetCore {\n  constructor (quads) {\n    this.quads = new Set()\n\n    if (quads) {\n      for (const quad of quads) {\n        this.quads.add(quad)\n      }\n    }\n  }\n\n  get size () {\n    return this.quads.size\n  }\n\n  add (quad) {\n    if (!this.has(quad)) {\n      this.quads.add(quad)\n    }\n\n    return this\n  }\n\n  delete (quad) {\n    for (const localQuad of this) {\n      if (isMatch(quad, localQuad.subject, localQuad.predicate, localQuad.object, localQuad.graph)) {\n        this.quads.delete(localQuad)\n\n        return this\n      }\n    }\n\n    return this\n  }\n\n  has (quad) {\n    for (const other of this) {\n      if (isMatch(other, quad.subject, quad.predicate, quad.object, quad.graph)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  match (subject, predicate, object, graph) {\n    const matches = new Set()\n\n    for (const quad of this) {\n      if (isMatch(quad, subject, predicate, object, graph)) {\n        matches.add(quad)\n      }\n    }\n\n    return new this.constructor(matches)\n  }\n\n  [Symbol.iterator] () {\n    return this.quads[Symbol.iterator]()\n  }\n}\n\nmodule.exports = DatasetCore\n","function isMatch (quad, subject, predicate, object, graph) {\n  if (subject && !quad.subject.equals(subject)) {\n    return false\n  }\n\n  if (predicate && !quad.predicate.equals(predicate)) {\n    return false\n  }\n\n  if (object && !quad.object.equals(object)) {\n    return false\n  }\n\n  if (graph && !quad.graph.equals(graph)) {\n    return false\n  }\n\n  return true\n}\n\nmodule.exports = isMatch\n"],"sourceRoot":""}