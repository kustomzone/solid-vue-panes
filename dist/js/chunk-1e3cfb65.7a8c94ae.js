(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e3cfb65"],{1404:function(e,t,n){"use strict";n("a15b"),n("fb6a"),n("b0c0"),n("96cf");var a=n("1da1"),r=n("4d8d"),i=n("6dc1");t["a"]={created:function(){this.webId=this.$store.state.solid.webId,this.config(this.webId);var e=new Date;this.date=this.formatDate(e)},methods:{sendActivity:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,a,s,o,c,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.activity),n=new Date,a="Activity_"+n.getTime(),s=n.toISOString(),o=e.formatDate(n),console.log(e.activity.actor.name,e.activity.type,e.activity.summary,o),c=e.pubPod+o+".ttl",l={},t.prev=8,t.next=11,Object(r["b"])(c);case 11:l=t.sent,t.next=19;break;case 14:return t.prev=14,t.t0=t["catch"](8),t.next=18,Object(r["a"])(c);case 18:l=t.sent;case 19:return console.log("webId",e.webId),e.activity.summary.length<1&&(e.activity.summary=[e.activity.actor.name,e.activity.type,"a",e.activity.object.type,"with name",e.activity.object.name].join(" ")),u=l.addSubject({identifier:a}),u.addLiteral(i["e"].label,e.activity.object.name),u.addLiteral(i["a"].created,s),u.addRef(i["b"].maker,e.webId),u.addRef("https://www.w3.org/ns/activitystreams#actor",e.webId),u.addRef(i["d"].type,"https://www.w3.org/ns/activitystreams#"+e.activity.type),u.addLiteral("https://www.w3.org/ns/activitystreams#summary",e.activity.summary),u.addRef("https://www.w3.org/ns/activitystreams#object",e.activity.object.url),void 0!=e.currentWorkspace?u.addRef(i["d"].type,e.currentWorkspace.path+e.activity.object.type):u.addRef(i["d"].type,e.activity.object.url+"#"+e.activity.object.type),t.next=32,l.save();case 32:case"end":return t.stop()}}),t,null,[[8,14]])})))()},send:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,a,s,o,c,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.activity),n=e.pubPod+e.date+".ttl",a=new Date,s="Activity_"+a.getTime(),o=a.toISOString(),c={},t.prev=6,t.next=9,Object(r["b"])(n);case 9:c=t.sent,t.next=17;break;case 12:return t.prev=12,t.t0=t["catch"](6),t.next=16,Object(r["a"])(n);case 16:c=t.sent;case 17:return l=[e.activity.actor.name,e.activity.type,"a",e.activity.object.type,"with name",e.activity.object.name].join(" "),u=c.addSubject({identifier:s}),u.addLiteral(i["e"].label,l),u.addLiteral(i["a"].created,o),u.addRef(i["b"].maker,e.webId),u.addRef("https://www.w3.org/ns/activitystreams#actor",e.webId),u.addRef(i["d"].type,"https://www.w3.org/ns/activitystreams#"+e.activity.type),u.addLiteral("https://www.w3.org/ns/activitystreams#summary",e.activity.summary),u.addRef("https://www.w3.org/ns/activitystreams#object",e.activity.object.url),t.next=28,c.save();case 28:case"end":return t.stop()}}),t,null,[[6,12]])})))()},formatDate:function(e){return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")},postActivity:function(){},config:function(e){this.config={},this.config.webId=e}},webId:{webId:function(e){this.config(e)}},computed:{webId:{get:function(){return this.$store.state.solid.webId},set:function(){}},activities:{get:function(){return this.$store.state.agora.activities},set:function(){}}},data:function(){return{as:{core:["Object","Link","Activity","IntransitiveActivity","Collection","OrderedCollection","CollectionPage","OrderedCollectionPage"],activity:["Accept","Add","Announce","Arrive","Block","Create","Delete","Dislike","Flag","Follow","Ignore","Invite","Join","Leave","Like","Listen","Move","Offer","Question","Reject","Read","Remove","TentativeReject","TentativeAccept","Travel","Undo","Update","View"],actor:["Application","Group","Organization","Person","Service"],object:["Article","Audio","Document","Event","Image","Note","Page","Place","Profile","Relationship","Tombstone","Video","Mention"]},pubPod:"https://agora.solid.community/public/popock/inbox/"}}}},2945:function(e,t,n){"use strict";var a=n("b954"),r=n.n(a);r.a},"4de4":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").filter,i=n("1dde"),s=n("ae40"),o=i("filter"),c=s("filter");a({target:"Array",proto:!0,forced:!o||!c},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"8a7a":function(e,t,n){"use strict";n("4de4"),n("4160"),n("c975"),n("a15b"),n("baa5"),n("fb6a"),n("159b"),n("96cf");var a=n("1da1"),r=n("00e8"),i=n.n(r),s=n("4d8d"),o=n("6dc1");t["a"]={created:function(){this.fc=new SolidFileClient(i.a)},methods:{prepareToday:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new Date,e.$store.commit("parle/setDataDate",n),a=[n.getFullYear(),("0"+(n.getMonth()+1)).slice(-2),("0"+n.getDate()).slice(-2)].join("-")+".ttl",r=e.$store.state.parle.root+a,console.log(r),t.next=7,e.create(r);case 7:e.$store.commit("parle/setFileUrl",r);case 8:case"end":return t.stop()}}),t)})))()},create:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.fc.itemExists(e);case 2:if(n.sent){n.next=7;break}return n.next=5,t.fc.postFile(e,"","text/turtle").then((function(e){console.log("File Created",e)})).catch((function(e){return console.error("Error: ".concat(e))}));case 5:n.next=8;break;case 7:console.log("File exist",e);case 8:case"end":return n.stop()}}),n)})))()},bascule:function(e){console.log("BASCULE",e),this.$store.commit("parle/setFileUrl",e),this.path=e.substr(0,e.lastIndexOf("/")+1),console.log(this.path),void 0!=this.$store.state.websocket.socket&&console.log("subscribe"),console.log("mt"),this.makeToast("We have switched to",e,"info"),console.log("mt 2"),this.getMessages(e),console.log("getmess")},getMessages:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return console.log("URI",e),a=[],n.next=4,t.fc.itemExists(e);case 4:if(n.sent){n.next=9;break}return n.next=7,t.fc.postFile(e,"","text/turtle").then((function(e){console.log("File Created",e)})).catch((function(e){return console.error("Error: ".concat(e))}));case 7:n.next=10;break;case 9:console.log("File exist",e);case 10:return void 0!=t.$store.state.websocket.socket&&t.$store.state.websocket.socket.send("sub "+e),n.next=13,Object(s["b"])(e);case 13:r=n.sent,i=r.findSubjects(),i=i.filter(t.onlyUnique),c=[],i.forEach((function(e){var t=e.getString(o["a"].created),n=e.getLiteral(o["g"].content),a=e.getNodeRef(o["b"].maker),r=e.getAllNodeRefs(o["f"].hasPart),i=e.getNodeRef(o["f"].isPartOf),s={id:e.asRef(),created:new Date(t).toLocaleTimeString(),content:n,maker:a,parts:r,parent:i};c.push(s)})),a=c.reverse(),console.log("Messages",a),t.$store.commit("parle/setMessages",a);case 21:case"end":return n.stop()}}),n)})))()},onlyUnique:function(e,t,n){return n.indexOf(e)===t}}}},b954:function(e,t,n){},baa5:function(e,t,n){var a=n("23e7"),r=n("e58c");a({target:"Array",proto:!0,forced:r!==[].lastIndexOf},{lastIndexOf:r})},c975:function(e,t,n){"use strict";var a=n("23e7"),r=n("4d64").indexOf,i=n("a640"),s=n("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,l=i("indexOf"),u=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(e){return c?o.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}})},e58c:function(e,t,n){"use strict";var a=n("fc6a"),r=n("a691"),i=n("50c4"),s=n("a640"),o=n("ae40"),c=Math.min,l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0,d=s("lastIndexOf"),f=o("indexOf",{ACCESSORS:!0,1:0}),h=u||!d||!f;e.exports=h?function(e){if(u)return l.apply(this,arguments)||0;var t=a(this),n=i(t.length),s=n-1;for(arguments.length>1&&(s=c(s,r(arguments[1]))),s<0&&(s=n+s);s>=0;s--)if(s in t&&t[s]===e)return s||0;return-1}:l},eeb9:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"solid-chat-send"},[null!=e.webId?n("b-input-group",{staticClass:"mt-3 input"},[n("b-form-input",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"warning"},on:{click:e.send}},[e._v("Send")])],1)],1):n("SolidLoginButton",{staticClass:"mt-3 input"})],1)},r=[],i=(n("baa5"),n("d3b7"),n("96cf"),n("1da1")),s=n("4d8d"),o=n("6dc1"),c=n("fd2a"),l=n("1404"),u=n("8a7a"),d={name:"ParleSend",components:{SolidLoginButton:function(){return n.e("chunk-034e0f2f").then(n.bind(null,"e9a1"))}},mixins:[c["a"],l["a"],u["a"]],data:function(){return{message:""}},created:function(){if(this.fileUrl=this.$store.state.parle.fileUrl,this.root=this.$store.state.parle.root,this.url=this.$store.state.parle.url,void 0!=this.url&&this.url.length>0){var e=this.url.substring(this.url.lastIndexOf("/")+1);console.log(e),this.message="New chat started from "+this.url+" at "+this.root+e,this.$store.commit("parle/setFileUrl",this.root+e),console.log("FILEURL : ",this.root+e),this.bascule(this.root+e)}},methods:{createActivity:function(){this.activity={actor:{name:this.$store.state.solid.webId},type:"Create",summary:"",object:{name:this.message,url:this.fileUrl,type:"Parle"}},this.sendActivity()},send:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.$store.state.solid.webId,console.log(e.fileUrl),!(e.message.length>0&&null!=n)){t.next=29;break}return console.log(e.message),a=new Date,r="Msg"+a.getTime(),i=a.toISOString(),console.log("WEBID",e.$store.state.solid.webId),c={},t.prev=9,t.next=12,Object(s["b"])(e.fileUrl);case 12:c=t.sent,t.next=20;break;case 15:return t.prev=15,t.t0=t["catch"](9),t.next=19,Object(s["a"])(e.fileUrl);case 19:c=t.sent;case 20:return l=c.addSubject({identifier:r}),l.addLiteral(o["g"].content,e.message),l.addLiteral(o["a"].created,i),l.addNodeRef(o["b"].maker,n),t.next=26,c.save();case 26:e.message="",t.next=30;break;case 29:alert("You must login before posting ;-)");case 30:e.createActivity();case 31:case"end":return t.stop()}}),t,null,[[9,15]])})))()}},watch:{url:function(e){console.log("url changed",e);var t=e.substring(e.lastIndexOf("/")+1);console.log(t),this.$store.commit("parle/setFileUrl",this.path+t),this.bascule(this.path+t)}},computed:{webId:{get:function(){return this.$store.state.solid.webId},set:function(){}},url:{get:function(){return this.$store.state.parle.url},set:function(){}}}},f=d,h=(n("2945"),n("2877")),g=Object(h["a"])(f,a,r,!1,null,"0e23d46b",null);t["default"]=g.exports},fd2a:function(e,t,n){"use strict";t["a"]={methods:{makeToast:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.$bvToast.toast(t,{title:e,variant:n,solid:!0})}}}}}]);
//# sourceMappingURL=chunk-1e3cfb65.7a8c94ae.js.map