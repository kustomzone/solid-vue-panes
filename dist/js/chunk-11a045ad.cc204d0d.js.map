{"version":3,"sources":["webpack:///./node_modules/@rdfjs/data-model/lib/named-node.js","webpack:///./node_modules/@rdfjs/data-model/lib/data-factory.js","webpack:///./node_modules/@rdfjs/data-model/lib/blank-node.js","webpack:///./node_modules/@rdfjs/data-model/lib/literal.js","webpack:///./node_modules/@rdfjs/data-model/index.js","webpack:///./node_modules/@rdfjs/data-model/lib/variable.js","webpack:///./src/components/chat/SolidChatSend.vue?ee50","webpack:///./node_modules/@rdfjs/data-model/lib/default-graph.js","webpack:///./node_modules/@rdfjs/data-model/lib/quad.js","webpack:///./src/components/chat/SolidChatSend.vue?1db1","webpack:///src/components/chat/SolidChatSend.vue","webpack:///./src/components/chat/SolidChatSend.vue?2826","webpack:///./src/components/chat/SolidChatSend.vue"],"names":["NamedNode","iri","this","value","prototype","equals","other","termType","module","exports","BlankNode","DefaultGraph","Literal","Quad","Variable","DataFactory","namedNode","blankNode","literal","languageOrDatatype","indexOf","defaultGraph","defaultGraphInstance","variable","triple","subject","predicate","object","quad","graph","id","nextId","language","datatype","stringDatatype","langStringDatatype","name","render","_vm","_h","$createElement","_c","_self","staticClass","webId","attrs","on","$event","type","_k","keyCode","key","send","model","callback","$$v","message","expression","_v","staticRenderFns","console","log","SolidFileClient","fc","components","data","computed","fileUrl","$store","state","solid","watch","methods","component"],"mappings":"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","file":"js/chunk-11a045ad.cc204d0d.js","sourcesContent":["function NamedNode (iri) {\n  this.value = iri\n}\n\nNamedNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nNamedNode.prototype.termType = 'NamedNode'\n\nmodule.exports = NamedNode\n","var BlankNode = require('./blank-node')\nvar DefaultGraph = require('./default-graph')\nvar Literal = require('./literal')\nvar NamedNode = require('./named-node')\nvar Quad = require('./quad')\nvar Variable = require('./variable')\n\nfunction DataFactory () {}\n\nDataFactory.namedNode = function (value) {\n  return new NamedNode(value)\n}\n\nDataFactory.blankNode = function (value) {\n  return new BlankNode(value)\n}\n\nDataFactory.literal = function (value, languageOrDatatype) {\n  if (typeof languageOrDatatype === 'string') {\n    if (languageOrDatatype.indexOf(':') === -1) {\n      return new Literal(value, languageOrDatatype)\n    }\n\n    return new Literal(value, null, DataFactory.namedNode(languageOrDatatype))\n  }\n\n  return new Literal(value, null, languageOrDatatype)\n}\n\nDataFactory.defaultGraph = function () {\n  return DataFactory.defaultGraphInstance\n}\n\nDataFactory.variable = function (value) {\n  return new Variable(value)\n}\n\nDataFactory.triple = function (subject, predicate, object) {\n  return DataFactory.quad(subject, predicate, object)\n}\n\nDataFactory.quad = function (subject, predicate, object, graph) {\n  return new Quad(subject, predicate, object, graph || DataFactory.defaultGraphInstance)\n}\n\nDataFactory.defaultGraphInstance = new DefaultGraph()\n\nmodule.exports = DataFactory\n","function BlankNode (id) {\n  this.value = id || ('b' + (++BlankNode.nextId))\n}\n\nBlankNode.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nBlankNode.prototype.termType = 'BlankNode'\n\nBlankNode.nextId = 0\n\nmodule.exports = BlankNode\n","var NamedNode = require('./named-node')\n\nfunction Literal (value, language, datatype) {\n  this.value = value\n  this.datatype = Literal.stringDatatype\n  this.language = ''\n\n  if (language) {\n    this.language = language\n    this.datatype = Literal.langStringDatatype\n  } else if (datatype) {\n    this.datatype = datatype\n  }\n}\n\nLiteral.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value &&\n    other.language === this.language && other.datatype.equals(this.datatype)\n}\n\nLiteral.prototype.termType = 'Literal'\nLiteral.langStringDatatype = new NamedNode('http://www.w3.org/1999/02/22-rdf-syntax-ns#langString')\nLiteral.stringDatatype = new NamedNode('http://www.w3.org/2001/XMLSchema#string')\n\nmodule.exports = Literal\n","var DataFactory = require('./lib/data-factory')\n\nmodule.exports = DataFactory\n","function Variable (name) {\n  this.value = name\n}\n\nVariable.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType && other.value === this.value\n}\n\nVariable.prototype.termType = 'Variable'\n\nmodule.exports = Variable\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=style&index=0&id=66dadf90&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=style&index=0&id=66dadf90&scoped=true&lang=css&\"","function DefaultGraph () {\n  this.value = ''\n}\n\nDefaultGraph.prototype.equals = function (other) {\n  return !!other && other.termType === this.termType\n}\n\nDefaultGraph.prototype.termType = 'DefaultGraph'\n\nmodule.exports = DefaultGraph\n","var DefaultGraph = require('./default-graph')\n\nfunction Quad (subject, predicate, object, graph) {\n  this.subject = subject\n  this.predicate = predicate\n  this.object = object\n\n  if (graph) {\n    this.graph = graph\n  } else {\n    this.graph = new DefaultGraph()\n  }\n}\n\nQuad.prototype.equals = function (other) {\n  return !!other && other.subject.equals(this.subject) && other.predicate.equals(this.predicate) &&\n    other.object.equals(this.object) && other.graph.equals(this.graph)\n}\n\nmodule.exports = Quad\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"solid-chat-send\"},[(_vm.webId != null)?_c('b-input-group',{staticClass:\" input\",attrs:{\"size\":\"lg\"}},[_c('b-form-input',{on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.send($event)}},model:{value:(_vm.message),callback:function ($$v) {_vm.message=$$v},expression:\"message\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.send}},[_vm._v(\"Send\")])],1)],1):_c('SolidLoginButton',{staticClass:\"mt-3 input\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"solid-chat-send\">\n    <!--<h1>Room name</h1> -->\n\n\n    <b-input-group class=\" input\" v-if=\"webId != null\" size=\"lg\" >\n      <b-form-input v-model=\"message\" v-on:keyup.enter=\"send\"></b-form-input>\n      <b-input-group-append>\n        <!--  <b-button variant=\"outline-success\">Button</b-button>-->\n        <b-button variant=\"warning\" @click=\"send\" >Send</b-button>\n      </b-input-group-append>\n    </b-input-group>\n    <SolidLoginButton class=\"mt-3 input\" v-else />\n\n\n\n  </div>\n</template>\n\n<script>\nimport { fetchDocument } from 'tripledoc';\nimport { sioc, dct, foaf } from 'rdf-namespaces' //\nconst { namedNode } = require('@rdfjs/data-model');\nimport auth from 'solid-auth-client';\nlet SolidFileClient = window.SolidFileClient\nconsole.log(\"SFC\", SolidFileClient)\nlet fc = new SolidFileClient(auth)\nconsole.log(fc)\nlet solid = window.solid\nconsole.log(\"SOLID\",solid)\n\n\nexport default {\n  name: 'SolidChatSend',\n  components:{\n    'SolidLoginButton': () => import('@/components/solid/SolidLoginButton')\n\n  },\n  data: function () {\n    return {\n      message: \"\",\n    }\n  },\n  /*async created(){\n\n    if( !await fc.itemExists( this.fileUrl )) {\n      await fc.postFile(this.fileUrl, \"\", \"text/turtle\")\n      .then((content) => {\n        console.log(\"File Created\",content)\n      })\n      .catch(err => console.error(`Error: ${err}`))\n    }else{\n      console.log(\"File exist\",this.fileUrl)\n    }\n  },*/\n\n  computed:{\n    fileUrl: function(){\n      return  this.$store.state.chat.fileUrl\n    },\n    webId(){\n      return this.$store.state.solid.webId\n    }\n  },\n  watch:{\n    webId(webId){\n      console.log(\"Webid\",webId)\n    },\n    async  fileUrl(){\n      if( !await fc.itemExists( this.fileUrl )) {\n        await fc.postFile(this.fileUrl, \"\", \"text/turtle\")\n        .then((content) => {\n          console.log(\"File Created\",content)\n        })\n        .catch(err => console.error(`Error: ${err}`))\n      }else{\n        console.log(\"File exist\",this.fileUrl)\n      }\n    }\n\n  },\n  methods: {\n    async send(){\n      // please refer to https://github.com/scenaristeur/shighl/blob/9b4b61d06d8a20f55de3f2aa580cbc5fb840d584/src/Shighl-chat.js#L214\n      // and https://github.com/LDflex/LDflex/issues/53\n      let webId= this.$store.state.solid.webId\n      let root= this.$store.state.chat.root\n\n      console.log(this.fileUrl)\n      if (this.message.length > 0 && webId != null)    {\n        console.log(this.message)\n        var dateObj = new Date();\n        var messageId = \"Msg\"+dateObj.getTime()\n        var date = dateObj.toISOString()\n        //    let msgUrl = this.fileUrl+messageId\n        /*  console.log(msgUrl)\n        await solid.data[msgUrl].dct$created.add(date)\n        await solid.data[msgUrl].sioc$content.add(this.message)*/\n        console.log(\"WEBID\",this.$store.state.solid.webId, this.fileUrl)\n\n        //let index = \"this\"\n        //  let ind_prefix = \"../../../index.ttl#\" //\" root+\"/index.ttl#\"\n        let index = root+\"/index.ttl#this\"\n        console.log(\"TODO : must integrate \"+index+\" in tripledoc or batch ldflex\")\n        let messUri = this.fileUrl+\"#\"+messageId\n        console.log(messUri)\n\n\n        await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(messUri))\n\n        const chatDoc = await fetchDocument(this.fileUrl);\n        let subj =   chatDoc.addSubject({identifier:messageId})\n        subj.addLiteral(sioc.content, this.message)\n        subj.addLiteral(dct.created, date)\n        subj.addNodeRef(foaf.maker, webId)\n\n        /*  let indexSubj = chatDoc.addSubject({identifier: index, identifierPrefix: ind_prefix})\n        indexSubj.addNodeRef('http://www.w3.org/2005/01/wf/flow#message',subj.asNodeRef())*/\n\n        await chatDoc.save();\n\n\n        //  await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(messUri))\n        //    console.log(namedNode)\n        //          await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].set(namedNode(subj.asRef()))\n\n        /*\n        const chatDoc2 = await fetchDocument(this.fileUrl);\n        let index =   chatDoc2.addSubject({identifier:this.root+\"/index.ttl\"})\n        console.log(await index.getTriples())\n        console.log(await index.getRef())\n        index.addNodeRef('http://www.w3.org/2005/01/wf/flow#message', subj)\n        //https://solidarity.inrupt.net/public/ChatTest/index.ttl#this\n        await chatDoc2.save();*/\n\n        this.message=\"\"\n      }else{\n        alert ( \"Oh Oh, if yu wanna post yu gotta log in ;-)\")\n      }\n      //  await solid.data[msgUrl].foaf$maker.add(namedNode('https://www.test.com')) // namedNode(`${webid}`)\n      //  await solid.data.from(this.url)[messageId]['http://www.w3.org/2005/01/wf/flow#message'].add(this.url)\n      //this.message = \"\"\n      //  await solid.data.from(this.url)[this.subject]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(this.url))\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\n.input {\n  position: fixed;\n  bottom:0;\n  z-index: 999;\n  width: 100%;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SolidChatSend.vue?vue&type=template&id=66dadf90&scoped=true&\"\nimport script from \"./SolidChatSend.vue?vue&type=script&lang=js&\"\nexport * from \"./SolidChatSend.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SolidChatSend.vue?vue&type=style&index=0&id=66dadf90&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"66dadf90\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}